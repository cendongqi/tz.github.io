<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å°æ­ªçš„åšå®¢</title>
  <subtitle>äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘å­¦Python</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://zhangslob.github.io/"/>
  <updated>2018-11-13T14:25:46.472Z</updated>
  <id>https://zhangslob.github.io/</id>
  
  <author>
    <name>å°æ­ª</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Pythonå®ç°å¸¸è§çš„å›æ–‡å­—ç¬¦ä¸²ç®—æ³•</title>
    <link href="https://zhangslob.github.io/2018/11/13/Python%E5%AE%9E%E7%8E%B0%E5%B8%B8%E8%A7%81%E7%9A%84%E5%9B%9E%E6%96%87%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%AE%97%E6%B3%95/"/>
    <id>https://zhangslob.github.io/2018/11/13/Pythonå®ç°å¸¸è§çš„å›æ–‡å­—ç¬¦ä¸²ç®—æ³•/</id>
    <published>2018-11-13T14:09:41.000Z</published>
    <updated>2018-11-13T14:25:46.472Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fx6sk819rfj31as0sakjl.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬ä¸ƒåç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<hr>
<a id="more"></a>
<h1 id="å›æ–‡"><a href="#å›æ–‡" class="headerlink" title="å›æ–‡"></a>å›æ–‡</h1><p>åˆ©ç”¨python è‡ªå¸¦çš„ç¿»è½¬ å‡½æ•°<code>reversed()</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`<span class="function"><span class="keyword">def</span> <span class="title">is_plalindrome</span><span class="params">(string)</span>:</span>    <span class="keyword">return</span> string == <span class="string">''</span>.join(list(reversed(string)))`</div></pre></td></tr></table></figure>
<p>è‡ªå·±å®ç°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_plalindrome</span><span class="params">(string)</span>:</span></div><div class="line">    string = list(string)</div><div class="line">    length = len(string)</div><div class="line">    left = <span class="number">0</span></div><div class="line">    right = length - <span class="number">1</span></div><div class="line">    <span class="keyword">while</span> left &lt; right:</div><div class="line">        <span class="keyword">if</span> string[left] != string[right]:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        left += <span class="number">1</span></div><div class="line">        right -= <span class="number">1</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">True</span></div></pre></td></tr></table></figure>
<h1 id="æœ€é•¿çš„å›æ–‡å­ä¸²"><a href="#æœ€é•¿çš„å›æ–‡å­ä¸²" class="headerlink" title="æœ€é•¿çš„å›æ–‡å­ä¸²"></a>æœ€é•¿çš„å›æ–‡å­ä¸²</h1><h3 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h3><p>æš´åŠ›ç ´è§£ï¼Œæšä¸¾æ‰€æœ‰çš„å­ä¸²ï¼Œå¯¹æ¯ä¸ªå­ä¸²åˆ¤æ–­æ˜¯å¦ä¸ºå›æ–‡ï¼Œ æ—¶é—´å¤æ‚åº¦ä¸º O(n^3)</p>
<h3 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution</span><span class="params">(s)</span>:</span></div><div class="line">    s = list(s)</div><div class="line">    l = len(s)</div><div class="line">    dp = [[<span class="number">0</span>] * l <span class="keyword">for</span> i <span class="keyword">in</span> range(l)]</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(l):</div><div class="line">        dp[i][i] = <span class="keyword">True</span></div><div class="line">        <span class="comment"># å½“ k = 2æ—¶è¦ç”¨åˆ°</span></div><div class="line">        dp[i][i - <span class="number">1</span>] = <span class="keyword">True</span></div><div class="line">    resLeft = <span class="number">0</span></div><div class="line">    resRight = <span class="number">0</span></div><div class="line">    <span class="comment"># æšä¸¾å­ä¸²çš„é•¿åº¦</span></div><div class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">2</span>, l+<span class="number">1</span>):</div><div class="line">        <span class="comment"># å­ä¸²çš„èµ·å§‹ä½ç½®</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, l-k+<span class="number">1</span>):</div><div class="line">            j = i + k - <span class="number">1</span></div><div class="line">            <span class="keyword">if</span> s[i] == s[j] <span class="keyword">and</span> dp[i + <span class="number">1</span>][j - <span class="number">1</span>]:</div><div class="line">                dp[i][j] = <span class="keyword">True</span></div><div class="line">                <span class="comment"># ä¿å­˜æœ€é•¿çš„å›æ–‡èµ·ç‚¹å’Œç»ˆç‚¹</span></div><div class="line">                <span class="keyword">if</span> resRight - resLeft + <span class="number">1</span> &lt; k:</div><div class="line">                    resLeft = i</div><div class="line">                    resRight = j</div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(s[resLeft:resRight+<span class="number">1</span>])</div></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦ä¸º O(n^2), ç©ºé—´å¤æ‚åº¦ä¸º O(n^2)</p>
<h3 id="Manacher-ç®—æ³•"><a href="#Manacher-ç®—æ³•" class="headerlink" title="Manacher ç®—æ³•"></a>Manacher ç®—æ³•</h3><p>Manacher ç®—æ³•é¦–å…ˆå¯¹å­—ç¬¦ä¸²åšä¸€ä¸ªé¢„å¤„ç†,ä½¿å¾—æ‰€æœ‰çš„ä¸²éƒ½æ˜¯å¥‡æ•°é•¿åº¦, æ’å…¥çš„æ˜¯åŒæ ·çš„ç¬¦å·ä¸”ç¬¦å·ä¸å­˜åœ¨ä¸åŸä¸²ä¸­ï¼Œä¸²çš„å›æ–‡æ€§ä¸å—å½±å“</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`aba =&gt; <span class="comment">#a#b#a#abab =&gt; #a#b#a#b#`</span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æŠŠå›æ–‡ä¸²ä¸­æœ€å³ä½ç½®ä¸å…¶å¯¹ç§°è½´çš„è·ç¦»ç§°ä¸ºå›æ–‡åŠå¾„ï¼ŒManacher ç®—æ³•å®šä¹‰äº†ä¸€ä¸ªå›æ–‡åŠå¾„æ•°ç»„ RLï¼ŒRL[i]è¡¨ç¤ºä»¥ç¬¬ i ä¸ªå­—ç¬¦ä¸ºå¯¹ç§°è½´çš„å›æ–‡åŠå¾„ï¼Œå¯¹äºä¸Šé¢å¾—åˆ°çš„æ’å…¥åˆ†éš”ç¬¦çš„ä¸²æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° RLæ•°ç»„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">char:  <span class="comment"># a # b # a #</span></div><div class="line">RL:    1 2 1 4 1 2 1</div><div class="line">RL-1:  0 1 0 3 0 1 0</div><div class="line">i:     0 1 2 3 4 5 6</div><div class="line">char: <span class="comment"># a # b # a # b #</span></div><div class="line">RL:   1 2 1 4 1 4 1 2 1</div><div class="line">RL-1: 0 1 0 3 0 3 0 1 0</div><div class="line">i:    0 1 2 3 4 5 6 7 8</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿˜æ±‚äº† RL[i] - 1: æˆ‘ä»¬å‘ç°<strong>RL[i] -1 æ­£å¥½æ˜¯åˆå§‹å­—ç¬¦ä¸²ä¸­ä»¥ä½ç½®i ä¸ºå¯¹ç§°è½´çš„æœ€é•¿å›æ–‡é•¿åº¦</strong></p>
<p>æ‰€ä»¥ä¸‹é¢å°±æ˜¯é‡ç‚¹å¦‚ä½•æ±‚å¾— RL æ•°ç»„äº†ï¼Œ å¯ä»¥å‚è€ƒè¿™ç¯‡<a href="https://segmentfault.com/a/1190000003914228#articleHeader5" target="_blank" rel="external">æ–‡ç« </a> (è®²å¾—æ¯”è¾ƒæ¸…æ™°)</p>
<p>ä¸‹é¢æ˜¯ç®—æ³•å®ç°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">manacher</span><span class="params">(preS)</span>:</span></div><div class="line">    s = <span class="string">'#'</span> + <span class="string">'#'</span>.join(preS) + <span class="string">'#'</span></div><div class="line">    l = len(s)</div><div class="line">    RL = [<span class="number">0</span>] * l</div><div class="line">    maxRight = pos = maxLen = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(l):</div><div class="line">        <span class="keyword">if</span> i &lt; maxRight:</div><div class="line">            RL[i] = min(RL[<span class="number">2</span>*pos - i], maxRight-i)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            RL[i] = <span class="number">1</span></div><div class="line">        <span class="keyword">while</span> i - RL[i] &gt;= <span class="number">0</span> <span class="keyword">and</span> i + RL[i] &lt; l <span class="keyword">and</span> s[i - RL[i]] == s[i + RL[i]]:</div><div class="line">            RL[i] += <span class="number">1</span></div><div class="line">        <span class="keyword">if</span> i + RL[i] - <span class="number">1</span> &gt; maxRight:</div><div class="line">            maxRight = i + RL[i] - <span class="number">1</span></div><div class="line">            pos = i</div><div class="line">    maxLen = max(RL)</div><div class="line">    idx = RL.index(maxLen)</div><div class="line">    sub = s[idx - maxLen + <span class="number">1</span>: idx + maxLen]</div><div class="line">    <span class="keyword">return</span> sub.replace(<span class="string">'#'</span>, <span class="string">''</span>)</div></pre></td></tr></table></figure>
<p>ç©ºé—´å¤æ‚åº¦ï¼šå€ŸåŠ©äº†ä¸€ä¸ªè¾…åŠ©æ•°ç»„ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(n)<br>æ—¶é—´å¤æ‚åº¦ï¼šå°½ç®¡å†…å±‚å­˜åœ¨å¾ªç¯ï¼Œä½†æ˜¯å†…å±‚å¾ªç¯åªå¯¹å°šæœªåŒ¹é…çš„éƒ¨åˆ†è¿›è¡Œï¼Œå¯¹äºæ¯ä¸€ä¸ªå­—ç¬¦æ¥è¯´ï¼Œåªä¼šè¿›è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)</p>
<h1 id="æœ€é•¿å›æ–‡å‰ç¼€"><a href="#æœ€é•¿å›æ–‡å‰ç¼€" class="headerlink" title="æœ€é•¿å›æ–‡å‰ç¼€"></a>æœ€é•¿å›æ–‡å‰ç¼€</h1><p>æ‰€è°“å‰ç¼€ï¼Œå°±æ˜¯ä»¥ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹</p>
<p>ä¸‹é¢çš„æœ€é•¿å›æ–‡å‰ç¼€</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">abbabbc =&gt; abbc</div><div class="line">abababb =&gt; ababa</div><div class="line">sogou =&gt; s</div></pre></td></tr></table></figure>
<p>å°†åŸä¸²é€†è½¬ï¼Œé‚£ä¹ˆé—®é¢˜å°±è½¬å˜ä¸ºæ±‚åŸä¸²çš„å‰ç¼€å’Œé€†ä¸²åç¼€<strong>ç›¸ç­‰ä¸”é•¿åº¦æœ€å¤§çš„å€¼</strong>, è¿™ä¸ªé—®é¢˜å…¶å®å°±æ˜¯ <a href="http://youbookee.com/2016/09/18/kmp-python/" target="_blank" rel="external">KMP ç®—æ³•</a>ä¸­çš„ next æ•°ç»„çš„æ±‚è§£äº†</p>
<p>å…·ä½“æ±‚è§£ï¼š å°†åŸä¸²é€†è½¬å¹¶æ‹¼æ¥åˆ°åŸä¸²ä¸­ï¼Œ ä»¥â€™#â€™ åˆ†éš”åŸä¸²å’Œé€†è½¬é¿å…å†…éƒ¨å­—ç¬¦ä¸²å¹²æ‰°ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">longest_palindrome_prefix</span><span class="params">(s)</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s:</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span></div><div class="line">    s = s + <span class="string">'#'</span> + s[::<span class="number">-1</span>] + <span class="string">'$'</span></div><div class="line">    i = <span class="number">0</span></div><div class="line">    j = <span class="number">-1</span></div><div class="line">    nt = [<span class="number">0</span>] * len(s)</div><div class="line">    nt[<span class="number">0</span>] = <span class="number">-1</span></div><div class="line">    <span class="keyword">while</span> i &lt; len(s) - <span class="number">1</span>:</div><div class="line">        <span class="keyword">if</span> j == <span class="number">-1</span> <span class="keyword">or</span> s[i] == s[j]:</div><div class="line">            i += <span class="number">1</span></div><div class="line">            j += <span class="number">1</span></div><div class="line">            nt[i] = j</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            j = nt[j]</div><div class="line">    <span class="keyword">return</span> nt[len(s) - <span class="number">1</span>]</div></pre></td></tr></table></figure>
<h1 id="æ·»åŠ å­—ç¬¦ç”Ÿæˆæœ€çŸ­å›æ–‡å­—ç¬¦ä¸²"><a href="#æ·»åŠ å­—ç¬¦ç”Ÿæˆæœ€çŸ­å›æ–‡å­—ç¬¦ä¸²" class="headerlink" title="æ·»åŠ å­—ç¬¦ç”Ÿæˆæœ€çŸ­å›æ–‡å­—ç¬¦ä¸²"></a>æ·»åŠ å­—ç¬¦ç”Ÿæˆæœ€çŸ­å›æ–‡å­—ç¬¦ä¸²</h1><p>è¿™é“é¢˜å…¶å®è·Ÿä¸Šé¢åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œ<br>å®ä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">aacecaaa -&gt; aaacecaaa <span class="comment"># æ·»åŠ  a</span></div><div class="line">abcd -&gt; dcbabcd <span class="comment"># æ·»åŠ  dcb</span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å…ˆæ±‚å­—ç¬¦ä¸²çš„æœ€é•¿å›æ–‡å‰ç¼€, ç„¶åå‰©ä½™çš„å­—ç¬¦ä¸²é€†è½¬å¹¶æ‹¼æ¥åˆ°å­—ç¬¦ä¸²çš„å¤´éƒ¨å³æ˜¯é—®é¢˜æ‰€æ±‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution</span><span class="params">(s)</span>:</span></div><div class="line">    length = longest_palindrome_prefix(s)</div><div class="line">    <span class="keyword">return</span> s[length:][::<span class="number">-1</span>] + s</div></pre></td></tr></table></figure>
<h1 id="æœ€é•¿å›æ–‡å­åºåˆ—"><a href="#æœ€é•¿å›æ–‡å­åºåˆ—" class="headerlink" title="æœ€é•¿å›æ–‡å­åºåˆ—"></a>æœ€é•¿å›æ–‡å­åºåˆ—</h1><h4 id="åŠ¨æ€è§„åˆ’æ³•"><a href="#åŠ¨æ€è§„åˆ’æ³•" class="headerlink" title="åŠ¨æ€è§„åˆ’æ³•"></a>åŠ¨æ€è§„åˆ’æ³•</h4><ul>
<li>dp[i][j] è¡¨ç¤ºå­åºåˆ— s[i..j] ä¸­å­˜åœ¨çš„æœ€é•¿å›æ–‡å­åºåˆ—é•¿åº¦</li>
<li>åˆå§‹åŒ–dp[i][i] = 1</li>
<li>å½“ s[i] == s[j] ä¸º true æ—¶ï¼Œdp[i][j] = dp[i+1][j - 1] + 2</li>
<li>å½“ s[i] == s[j] ä¸º false æ—¶ï¼Œdp[i][j] = max(dp[i+1][j], dp[i][j - 1])</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># æ±‚å¾—æœ€é•¿å›æ–‡å­åºåˆ—çš„é•¿åº¦</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution</span><span class="params">(s)</span>:</span></div><div class="line">    l = len(s)</div><div class="line">    dp = [[<span class="number">0</span>] * l <span class="keyword">for</span> i <span class="keyword">in</span> range(l)]</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(l):</div><div class="line">        dp[i][i] = <span class="number">1</span></div><div class="line">    <span class="comment"># æšä¸¾å­ä¸²çš„é•¿åº¦</span></div><div class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">2</span>, l+<span class="number">1</span>):</div><div class="line">        <span class="comment"># æšä¸¾å­ä¸²çš„èµ·å§‹ä½ç½®</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, l-k+<span class="number">1</span>):</div><div class="line">            j = i + k - <span class="number">1</span></div><div class="line">            <span class="keyword">if</span> s[i] == s[j]:</div><div class="line">                dp[i][j] = dp[i + <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">2</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                dp[i][j] = max(dp[i][j - <span class="number">1</span>], dp[i + <span class="number">1</span>][j])</div><div class="line">    <span class="keyword">return</span> dp[<span class="number">0</span>][l<span class="number">-1</span>]</div></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦ä¸º O(n^2), ç©ºé—´å¤æ‚åº¦ä¸º O(n^2)</p>
<p>è½¬è‡ªï¼š<a href="http://youbookee.com/2016/09/06/plalindrome-substring/" target="_blank" rel="external">http://youbookee.com/2016/09/06/plalindrome-substring/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws4.sinaimg.cn/large/006tNbRwly1fx6sk819rfj31as0sakjl.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬ä¸ƒåç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="ç®—æ³•" scheme="https://zhangslob.github.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="ç®—æ³•" scheme="https://zhangslob.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>çˆ¬è™«ä¹‹å…¨ç«™çˆ¬å–æ–¹æ³•</title>
    <link href="https://zhangslob.github.io/2018/11/07/%E7%88%AC%E8%99%AB%E4%B9%8B%E5%85%A8%E7%AB%99%E7%88%AC%E5%8F%96%E6%96%B9%E6%B3%95/"/>
    <id>https://zhangslob.github.io/2018/11/07/çˆ¬è™«ä¹‹å…¨ç«™çˆ¬å–æ–¹æ³•/</id>
    <published>2018-11-07T11:23:43.000Z</published>
    <updated>2018-11-08T07:39:05.445Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fx0nl2hsyjj30sb0ihjtw.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åä¹ç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<hr>
<a id="more"></a>
<h1 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h1><p>åšè¿‡å¥½å‡ ä¸ªå…³äºç½‘ç«™å…¨ç«™çš„é¡¹ç›®ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ã€‚</p>
<p>å…ˆæŠŠä¸Šé¢é‚£å¼ å›¾å†™ä¸‹æ¥ï¼Œå…¨ç«™çˆ¬å–çš„ä¸¤ç§æ–¹æ³•ï¼š</p>
<ol>
<li>å…³ç³»ç½‘ç»œï¼š<ol>
<li>ä¼˜ç‚¹ï¼šç®€å•ï¼›å¯ä»¥æŠ“å–â€œçƒ­é—¨â€æ•°æ®</li>
<li>ç¼ºç‚¹ï¼šæ— æ³•æŠ“å–å…¨é‡æ•°æ®ï¼›é€Ÿåº¦æ…¢ï¼›éœ€è¦è§£å†³å»é‡é—®é¢˜</li>
<li>å¯è¡Œæ€§ï¼šæ¯”è¾ƒé«˜</li>
</ol>
</li>
<li>éå†ID<ol>
<li>ä¼˜ç‚¹ï¼šå¯ä»¥æŠ“å–æ‰€æœ‰æ•°æ®ï¼›ä¸ç”¨æ•°æ®å»é‡</li>
<li>ç¼ºç‚¹ï¼šèµ„æºæ¶ˆè€—å¤§ï¼›é€Ÿåº¦æ…¢ï¼›å¯èƒ½è¢«å‘ç°</li>
<li>å¯è¡Œæ€§ï¼šä»…å¯ç”¨äºIDè‡ªå¢</li>
</ol>
</li>
</ol>
<h1 id="å…³äºå…³ç³»ç½‘ç»œ"><a href="#å…³äºå…³ç³»ç½‘ç»œ" class="headerlink" title="å…³äºå…³ç³»ç½‘ç»œ"></a>å…³äºå…³ç³»ç½‘ç»œ</h1><p>å…¶å®è¿™ä¸ªå¾ˆå¥½ç†è§£ã€‚æ¯”å¦‚è¯´çŸ¥ä¹ï¼Œä¸€ä¸ªå¤§Væœ‰100Wç²‰ä¸ï¼Œä»è¿™ä¸ªå¤§Vå‡ºå‘ï¼ŒæŠ“å–ç²‰ä¸çš„ç²‰ä¸ï¼Œä¸€ç›´å¾ªç¯ä¸‹å»ã€‚ï¼ˆå¯èƒ½æ˜¯ä¸ªæ­»å¾ªç¯ï¼‰</p>
<p>è¿™ä¸ªæ–¹æ³•å°±æ¯”è¾ƒç®€å•ï¼Œ<code>Scrapy</code>ä¸­å°±æ˜¯ç»§æ‰¿<code>CrawlSpider</code>ï¼Œå†ç¼–å†™åŒ¹é…è§„åˆ™å°±å¥½ã€‚</p>
<p>Example</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> scrapy</div><div class="line"><span class="keyword">from</span> scrapy.spiders <span class="keyword">import</span> CrawlSpider, Rule</div><div class="line"><span class="keyword">from</span> scrapy.linkextractors <span class="keyword">import</span> LinkExtractor</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySpider</span><span class="params">(CrawlSpider)</span>:</span></div><div class="line">    name = <span class="string">'example.com'</span></div><div class="line">    allowed_domains = [<span class="string">'example.com'</span>]</div><div class="line">    start_urls = [<span class="string">'http://www.example.com'</span>]</div><div class="line"></div><div class="line">    rules = (</div><div class="line">        <span class="comment"># Extract links matching 'category.php' (but not matching 'subsection.php')</span></div><div class="line">        <span class="comment"># and follow links from them (since no callback means follow=True by default).</span></div><div class="line">        Rule(LinkExtractor(allow=(<span class="string">'category\.php'</span>, ), deny=(<span class="string">'subsection\.php'</span>, ))),</div><div class="line"></div><div class="line">        <span class="comment"># Extract links matching 'item.php' and parse them with the spider's method parse_item</span></div><div class="line">        Rule(LinkExtractor(allow=(<span class="string">'item\.php'</span>, )), callback=<span class="string">'parse_item'</span>),</div><div class="line">    )</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse_item</span><span class="params">(self, response)</span>:</span></div><div class="line">        self.logger.info(<span class="string">'Hi, this is an item page! %s'</span>, response.url)</div><div class="line">        item = scrapy.Item()</div><div class="line">        item[<span class="string">'id'</span>] = response.xpath(<span class="string">'//td[@id="item_id"]/text()'</span>).re(<span class="string">r'ID: (\d+)'</span>)</div><div class="line">        item[<span class="string">'name'</span>] = response.xpath(<span class="string">'//td[@id="item_name"]/text()'</span>).extract()</div><div class="line">        item[<span class="string">'description'</span>] = response.xpath(<span class="string">'//td[@id="item_description"]/text()'</span>).extract()</div><div class="line">        <span class="keyword">return</span> item</div></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹æ³•ä¸€èˆ¬æ˜¯æœç´¢å¼•æ“ä¼šåšçš„ã€‚è€Œä¸”æŠ“å–çš„å†…å®¹åŸºæœ¬æ˜¯æœ€å¤šäººçœ‹åˆ°çš„ï¼Œæ‰€ä»¥æœˆæ’åœ¨å‰é¢ï¼Œå’ŒSEOæœ‰å…³ã€‚</p>
<p>ä½†æ˜¯è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾çš„ï¼Œæœ€æ˜æ˜¾çš„å°±æ˜¯æ²¡æ³•æŠ“å…¨æ•°æ®ï¼Œåƒé‚£ç§å†·é—¨çš„æ•°æ®å°±æ²¡æ³•æŠ“å–åˆ°ï¼Œé€Ÿåº¦ä¹Ÿæ˜¯æ¯”è¾ƒæ…¢çš„ï¼Œå¿…é¡»ä¿å­˜å»é‡é˜Ÿåˆ—ï¼Œä»¥é˜²æ­¢é‡å¤æŠ“å–é¡µé¢ã€‚ï¼ˆäº†è§£ä¸‹<a href="https://github.com/kongtianyi/BloomFilterRedis" target="_blank" rel="external">å¸ƒéš†è¿‡æ»¤å™¨</a>ï¼‰</p>
<p>å¦‚æœå¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚æ²¡é‚£ä¹ˆé«˜å¯ä»¥è€ƒè™‘è¿™ç§æ–¹æ³•ã€‚</p>
<h1 id="éå†ID"><a href="#éå†ID" class="headerlink" title="éå†ID"></a>éå†ID</h1><p>æ‰¾å„ç§æ–¹æ³•å°±æ¯”è¾ƒæ— è„‘äº†ï¼Œå•¥ä¹Ÿä¸ç”¨æƒ³ï¼Œä»0å¼€å§‹éå†è·‘å§ã€‚</p>
<p>æ¯«æ— ç–‘é—®ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥æŠ“å–ç½‘ç«™æ‰€æœ‰çš„æ•°æ®ï¼Œå› ä¸ºåœ¨å¼€å§‹æŠ“å–å‰å°±å·²ç»å®Œæˆçš„å»é‡ï¼Œæ‰€ä»¥è¿™æ–¹é¢å°±ä¸ç”¨ç®¡äº†ã€‚</p>
<p>ä½†æ˜¯ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå› ä¸ºæ˜¯éå†IDï¼Œæ‰€ä»¥éœ€è¦å¾ˆå¤šæœåŠ¡å™¨èµ„æºå’Œä»£ç†èµ„æºï¼Œæœ‰å¯èƒ½æŸä¸ªIDå·²ç»ä¸‹æ¶æˆ–å¤±æ•ˆã€‚æ‰€ä»¥æ•´ä¸ªå·¥ç¨‹è¯·æ±‚é‡ä¼šéå¸¸å¤§ã€‚è€Œä¸”å¯èƒ½è¢«åˆ«äººå‘ç°ï¼Œä¸€èˆ¬äººéƒ½å»çœ‹é‚£äº›çƒ­é—¨å¸–å­ï¼Œç»“æœä½ æŠŠé‚£ä¹ˆé‡æ¥æ²¡äººçœ‹çš„ç¿»äº†ä¸€éï¼Œåˆ«äººä¹Ÿä¼šå‘ç°æ•°æ®å¼‚å¸¸çš„ï¼ˆä¹Ÿä¼šå­˜åœ¨å‡æ•°æ®çš„æƒ…å†µğŸ˜­ï¼‰ã€‚</p>
<p>è€Œä¸”è¿™ç§æ–¹æ³•ä¹‹é€‚ç”¨äºIDè‡ªå¢çš„ï¼Œå¤§å¤šæ•°æ˜¯æ•°å­—IDé€’å¢ï¼Œæ¯”å¦‚è¯´å¤©çœ¼æŸ¥çš„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">https://www.tianyancha.com/company/24762997</div><div class="line">https://www.tianyancha.com/company/150041670</div><div class="line">https://www.tianyancha.com/company/1073358312</div></pre></td></tr></table></figure>
<p>çŸ¥ä¹ä¹Ÿæ˜¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">https://zhuanlan.zhihu.com/p/47969297</div><div class="line">https://zhuanlan.zhihu.com/p/48652497</div><div class="line">https://zhuanlan.zhihu.com/p/47805332</div></pre></td></tr></table></figure>
<p>åº”è¯¥æ˜¯å’Œæ•°å­—æœ‰å…³ç³»ï¼Œå¯ä»¥å…ˆé‡‡æ ·è¿›è¡ŒæŠ“å–ï¼Œç ”ç©¶æ•°æ®åˆ†å¸ƒæƒ…å†µã€‚</p>
<p>å½“æä¾›ä¸æ­£ç¡®IDæ—¶ï¼Œä¹Ÿä¼šè¿”å›æ•°æ®ä¸å­˜åœ¨çš„æƒ…å†µ</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fx0oscxi0cj30z90kfgqa.jpg" alt=""></p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fx0ovjg53wj30pn0fkwf3.jpg" alt=""></p>
<p>åœ¨è¿™é‡Œæä¾›ä¸€ä¸ªç”ŸæˆIDçš„æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_uid</span><span class="params">(num)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    ä½¿ç”¨ç”Ÿæˆå™¨ç”ŸæˆID</div><div class="line">    :param num: èµ·å§‹ID</div><div class="line">    :return: ç”Ÿæˆå™¨</div><div class="line">    """</div><div class="line">    js = <span class="number">0</span></div><div class="line">    result = list()</div><div class="line">    <span class="keyword">while</span> js &lt; <span class="number">20000</span>:</div><div class="line">        num += <span class="number">1</span></div><div class="line">        js += <span class="number">1</span></div><div class="line">        result.append(num)</div><div class="line"></div><div class="line">    <span class="keyword">yield</span> result</div></pre></td></tr></table></figure>
<p>æœ€åå†çœ‹çœ‹è¿™å¼ å›¾ã€‚ä¸¤ç§æ–¹æ³•éƒ½æœ‰ä¼˜ç¼ºç‚¹ï¼Œæ ¹æ®å®é™…éœ€æ±‚é€‰å–ï¼Œå¦‚æœä½ è¿˜çŸ¥é“åˆ«çš„æŠ“å–æ–¹æ³•ï¼Œæ¬¢è¿æŒ‡å‡ºã€‚</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fx0nl2hsyjj30sb0ihjtw.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws4.sinaimg.cn/large/006tNbRwly1fx0nl2hsyjj30sb0ihjtw.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åä¹ç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>Scalaå­¦ä¹ ä¹‹ç›¸åŒçš„å‡½æ•°å</title>
    <link href="https://zhangslob.github.io/2018/11/05/Scala%E5%AD%A6%E4%B9%A0%E4%B9%8B%E7%9B%B8%E5%90%8C%E7%9A%84%E5%87%BD%E6%95%B0%E5%90%8D/"/>
    <id>https://zhangslob.github.io/2018/11/05/Scalaå­¦ä¹ ä¹‹ç›¸åŒçš„å‡½æ•°å/</id>
    <published>2018-11-05T14:29:02.000Z</published>
    <updated>2018-11-05T15:00:16.661Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fwxk5mgus2j30kk064t9d.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åå…«ç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<hr>
<a id="more"></a>
<p>æœ€è¿‘åœ¨æ…¢æ…¢çš„å¼€å§‹ç”¨Scalaå†™Sparkï¼Œåˆšå¼€å§‹ä¹Ÿæ˜¯åœ¨èœé¸Ÿæ•™ç¨‹ä¸Šç®€å•è¿‡äº†ä¸€éScalaï¼Œç°åœ¨è¿˜è®°å¾—ä¸€äº›åŸºæœ¬è¯­æ³•ï¼Œè¿˜æœ‰å„ç§å¥‡æ€ªçš„è¯­æ³•ç³–ã€‚æƒ³è¦æ›´å¿«çš„å­¦ä¹ è¿™é—¨è¯­è¨€ï¼Œè¿˜æ˜¯éœ€è¦è‡ªå·±å¤šè°¢è°¢ã€‚</p>
<p>ä»Šå¤©åœ¨çœ‹åˆ«äººä»£ç æ—¶ï¼Œå‘ç°ä»–åœ¨ç±»ä¸­å®šä¹‰äº†ä¸¤ä¸ªåå­—ä¸€æ¨¡ä¸€æ ·çš„å‡½æ•°ï¼Œä½†æ˜¯æˆ‘è¿˜ä»¥ä¸ºä»–å†™é”™äº†ã€‚å½“æˆ‘ä»¥Pythonçš„æ€ç»´å»çœ‹å¾…è¿™ä»¬è¯­è¨€æ—¶ï¼Œå½“ç„¶æ˜¯åœ¨ä½œæ­»çš„è¾¹ç¼˜äº†ã€‚</p>
<p>ä¸¾ä¸€ä¸ªç®€å•çš„æ —å­ï¼Œä»MongoDBè¯»å–æ•°æ®æ—¶ä½¿ç”¨çš„é…ç½®æ‰€å®šä¹‰çš„ä¸¤ä¸ªå‡½æ•°</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">readConfig</span></span>(context: <span class="type">SparkContext</span>, database: <span class="type">String</span>, collection: <span class="type">String</span>): <span class="type">ReadConfig</span> = &#123;</div><div class="line">  <span class="type">ReadConfig</span>(<span class="type">Map</span>(<span class="string">"database"</span> -&gt; database, <span class="string">"collection"</span> -&gt; collection),</div><div class="line">    <span class="type">Some</span>(<span class="type">ReadConfig</span>(context)))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">readConfig</span></span>(session: <span class="type">SparkSession</span>, database: <span class="type">String</span>, collection: <span class="type">String</span>): <span class="type">ReadConfig</span> = &#123;</div><div class="line">  <span class="type">ReadConfig</span>(<span class="type">Map</span>(<span class="string">"database"</span> -&gt; database, <span class="string">"collection"</span> -&gt; collection),</div><div class="line">    <span class="type">Some</span>(<span class="type">ReadConfig</span>(session)))</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå‡½æ•°åä¸€æ ·çš„ï¼Œåˆšå¼€å§‹æˆ‘ä¹Ÿå¾ˆæ‡µé€¼ï¼Œä½†æ˜¯ä»”ç»†ä¸€çœ‹ï¼Œä»–çš„å‚æ•°æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸€ä¸ªæ˜¯<code>context: SparkContext</code>ï¼Œä¸€ä¸ªæ˜¯<code>session: SparkSession</code>ã€‚è¿™ä¸¤ä¸ªå‡½æ•°çš„åŠŸèƒ½ä¸€æ ·ï¼Œä½†æ˜¯æ¥å—çš„å‚æ•°ä¸ä¸€æ ·ï¼Œæ‰€ä»¥è¿™æ‰éœ€è¦å»å®šä¹‰ä¸¤ä¸ªå‡½æ•°ã€‚ï¼ˆè¯•æƒ³ä¸€ä¸‹ï¼Œåœ¨Pythonä¸­å¦‚ä½•å»å®ç°ï¼‰</p>
<p>å¯èƒ½ä½ ä¸æ‡‚Scalaï¼Œè®©æˆ‘ç®€å•è·Ÿä½ è®²ä¸€ä¸‹ã€‚é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨<code>def</code>å…³é”®å­—å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>readConfig</code>çš„å‡½æ•°ï¼Œå’ŒPythonä¸€æ¨¡ä¸€æ ·ï¼›ç„¶åå°±æ˜¯å‡½æ•°æ¥å—çš„å‚æ•°äº†ï¼Œå¯ä»¥çœ‹åˆ°åœ¨æ¯ä¸ªå‚æ•°åé¢æœ‰å†’å·ï¼Œè¿™ä¸ªå†’å·å°±è¡¨ç¤ºå‰é¢çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ªç›¸åŠ å‡½æ•°</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">add</span></span>&#123;</div><div class="line">   <span class="function"><span class="keyword">def</span> <span class="title">addInt</span></span>(a:<span class="type">Int</span>, b:<span class="type">Int</span>) : <span class="type">Int</span> = &#123;</div><div class="line">      <span class="keyword">var</span> sum:<span class="type">Int</span> = <span class="number">0</span></div><div class="line">      sum = a + b</div><div class="line">      <span class="keyword">return</span> sum</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Scalaä¼šåœ¨å˜é‡åå®šä¹‰ç±»å‹ï¼Œè¿™æ ·å°±å¯ä»¥åŒºåˆ«ä¸åŒçš„å‡½æ•°äº†ã€‚</p>
<p>å›åˆ°ä¸Šé¢çš„æ —å­ï¼Œä¸€ä¸ªç±»å‹æ˜¯<code>SparkContext</code>ï¼Œä¸€ä¸ªæ˜¯<code>SparkSession</code>ï¼Œè¿™æ˜¯Sparkçš„æ•°æ®ç±»å‹ï¼›ç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨å‡½æ•°æœ«å°¾æ˜¯å†’å·åŠ <code>ReadConfig</code>ï¼Œè¿™é‡Œè¯´çš„è¿”å›çš„æ•°æ®ç±»å‹æ˜¯<code>ReadConfig</code>ï¼Œä¹Ÿå°±æ˜¯ä»MongoDBè¯»å–æ•°æ®æ—¶ä½¿ç”¨çš„é…ç½®ç±»å‹ã€‚ï¼ˆå¦‚æœæ˜¯Unitåˆ™ä¸ç”¨è¿”å›ä»»ä½•æ•°æ®ï¼Œå’ŒJavaç±»ä¼¼ï¼‰</p>
<p>æ˜¯ä¸æ˜¯å¾ˆå¥½ç†è§£ï¼Œåœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œåªè¦æˆ‘ä»¬ä¼ é€’çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸åŒç±»å‹ï¼Œå°±ä¼šä½¿ç”¨ç›¸åº”çš„å‡½æ•°ã€‚</p>
<p>éƒ½è¯´Scalaæ˜¯ä¸€ç§å‡½æ•°å¼è¯­è¨€ï¼Œå‡½æ•°æ˜¯ Scala è¯­è¨€çš„æ ¸å¿ƒï¼Œçœ‹çœ‹Scalaå‡½æ•°çš„ç‰¹æ€§ï¼Œä¸è¯´äº†ï¼Œç»§ç»­æ’¸Scalaäº†ã€‚</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fwxknqcwf5j31cw0e0myu.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws2.sinaimg.cn/large/006tNbRwly1fwxk5mgus2j30kk064t9d.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åå…«ç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="scala" scheme="https://zhangslob.github.io/categories/scala/"/>
    
    
      <category term="scala" scheme="https://zhangslob.github.io/tags/scala/"/>
    
  </entry>
  
  <entry>
    <title>Sparkå®æˆ˜ï¼ˆäºŒï¼‰å­¦ä¹ UDF</title>
    <link href="https://zhangslob.github.io/2018/10/29/Spark%E5%AE%9E%E6%88%98%EF%BC%88%E4%BA%8C%EF%BC%89%E5%AD%A6%E4%B9%A0UDF/"/>
    <id>https://zhangslob.github.io/2018/10/29/Sparkå®æˆ˜ï¼ˆäºŒï¼‰å­¦ä¹ UDF/</id>
    <published>2018-10-29T03:15:55.000Z</published>
    <updated>2018-10-29T06:22:57.947Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fwj6agtwwoj30ag05k3zb.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åä¸ƒç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<hr>
<a id="more"></a>
<p>åœ¨å¼€å§‹æ­£å¼æ•°æ®å¤„ç†ä¹‹å‰ï¼Œæˆ‘è§‰å¾—æœ‰å¿…è¦å»å­¦ä¹ ç†è§£ä¸‹UDFã€‚</p>
<h1 id="UDF"><a href="#UDF" class="headerlink" title="UDF"></a>UDF</h1><p>UDFå…¨ç§°<code>User-Defined Functions</code>ï¼Œç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œæ˜¯Spark SQLçš„ä¸€é¡¹åŠŸèƒ½ï¼Œç”¨äºå®šä¹‰æ–°çš„åŸºäºåˆ—çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°æ‰©å±•äº†Spark SQLçš„DSLç”¨äºè½¬æ¢æ•°æ®é›†çš„è¯æ±‡è¡¨ã€‚</p>
<p>æˆ‘åœ¨databricksä¸Šæ‰¾åˆ°ä¸€ä¸ªæ¯”è¾ƒç®€å•ç†è§£çš„å…¥é—¨æ —å­ï¼š</p>
<h2 id="Register-the-function-as-a-UDF"><a href="#Register-the-function-as-a-UDF" class="headerlink" title="Register the function as a UDF"></a>Register the function as a UDF</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> squared = (s: <span class="type">Int</span>) =&gt; &#123;</div><div class="line">  s * s</div><div class="line">&#125;</div><div class="line">spark.udf.register(<span class="string">"square"</span>, squared)</div></pre></td></tr></table></figure>
<h2 id="Call-the-UDF-in-Spark-SQL"><a href="#Call-the-UDF-in-Spark-SQL" class="headerlink" title="Call the UDF in Spark SQL"></a>Call the UDF in Spark SQL</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">spark.range(<span class="number">1</span>, <span class="number">20</span>).registerTempTable(<span class="string">"test"</span>)</div></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">%sql select id, square(id) as id_squared from test</div></pre></td></tr></table></figure>
<p>æˆ‘ç†è§£å°±æ˜¯å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°<code>squared</code>ï¼Œè¿”å›è¾“å…¥æ•°å­—çš„å¹³æ–¹ï¼Œç„¶åregisterï¼Œå¹¶ç»‘å®š<code>square</code>æ–¹æ³•åä¸º<code>square</code>ï¼Œç„¶åå°±åœ¨Spark SQLä¸­ç›´æ¥ä½¿ç”¨<code>square</code>æ–¹æ³•ã€‚</p>
<h1 id="å®ä¾‹ä¸€ï¼šæ¸©åº¦è½¬åŒ–"><a href="#å®ä¾‹ä¸€ï¼šæ¸©åº¦è½¬åŒ–" class="headerlink" title="å®ä¾‹ä¸€ï¼šæ¸©åº¦è½¬åŒ–"></a>å®ä¾‹ä¸€ï¼šæ¸©åº¦è½¬åŒ–</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></div><div class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">object</span> <span class="title">ScalaUDFExample</span> </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</div><div class="line">    <span class="keyword">val</span> conf       = <span class="keyword">new</span> <span class="type">SparkConf</span>().setAppName(<span class="string">"Scala UDF Example"</span>)</div><div class="line">    <span class="keyword">val</span> spark      = <span class="type">SparkSession</span>.builder().enableHiveSupport().config(conf).getOrCreate() </div><div class="line"></div><div class="line">    <span class="keyword">val</span> ds = spark.read.json(<span class="string">"temperatures.json"</span>)</div><div class="line">    ds.createOrReplaceTempView(<span class="string">"citytemps"</span>)</div><div class="line"></div><div class="line">    <span class="comment">// Register the UDF with our SparkSession </span></div><div class="line">    spark.udf.register(<span class="string">"CTOF"</span>, (degreesCelcius: <span class="type">Double</span>) =&gt; ((degreesCelcius * <span class="number">9.0</span> / <span class="number">5.0</span>) + <span class="number">32.0</span>))</div><div class="line"></div><div class="line">    spark.sql(<span class="string">"SELECT city, CTOF(avgLow) AS avgLowF, CTOF(avgHigh) AS avgHighF FROM citytemps"</span>).show()</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ª UDF æ¥å°†ä»¥ä¸‹ JSON æ•°æ®ä¸­çš„æ¸©åº¦ä»æ‘„æ°åº¦ï¼ˆdegrees Celsiusï¼‰è½¬æ¢ä¸ºåæ°åº¦ï¼ˆdegrees Fahrenheitï¼‰ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;<span class="string">"city"</span>:<span class="string">"St. John's"</span>,<span class="string">"avgHigh"</span>:8.7,<span class="string">"avgLow"</span>:0.6&#125;</div><div class="line">&#123;<span class="string">"city"</span>:<span class="string">"Charlottetown"</span>,<span class="string">"avgHigh"</span>:9.7,<span class="string">"avgLow"</span>:0.9&#125;</div><div class="line">&#123;<span class="string">"city"</span>:<span class="string">"Halifax"</span>,<span class="string">"avgHigh"</span>:11.0,<span class="string">"avgLow"</span>:1.6&#125;</div><div class="line">&#123;<span class="string">"city"</span>:<span class="string">"Fredericton"</span>,<span class="string">"avgHigh"</span>:11.2,<span class="string">"avgLow"</span>:-0.5&#125;</div><div class="line">&#123;<span class="string">"city"</span>:<span class="string">"Quebec"</span>,<span class="string">"avgHigh"</span>:9.0,<span class="string">"avgLow"</span>:-1.0&#125;</div><div class="line">&#123;<span class="string">"city"</span>:<span class="string">"Montreal"</span>,<span class="string">"avgHigh"</span>:11.1,<span class="string">"avgLow"</span>:1.4&#125;</div><div class="line">...</div></pre></td></tr></table></figure>
<h1 id="å®ä¾‹äºŒï¼šæ—¶é—´è½¬åŒ–"><a href="#å®ä¾‹äºŒï¼šæ—¶é—´è½¬åŒ–" class="headerlink" title="å®ä¾‹äºŒï¼šæ—¶é—´è½¬åŒ–"></a>å®ä¾‹äºŒï¼šæ—¶é—´è½¬åŒ–</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Purchase</span>(<span class="params">customer_id: <span class="type">Int</span>, purchase_id: <span class="type">Int</span>, date: <span class="type">String</span>, time: <span class="type">String</span>, tz: <span class="type">String</span>, amount:<span class="type">Double</span></span>)</span></div><div class="line"></div><div class="line"><span class="keyword">val</span> x = sc.parallelize(<span class="type">Array</span>(</div><div class="line">  <span class="type">Purchase</span>(<span class="number">123</span>, <span class="number">234</span>, <span class="string">"2007-12-12"</span>, <span class="string">"20:50"</span>, <span class="string">"UTC"</span>, <span class="number">500.99</span>),</div><div class="line">  <span class="type">Purchase</span>(<span class="number">123</span>, <span class="number">247</span>, <span class="string">"2007-12-12"</span>, <span class="string">"15:30"</span>, <span class="string">"PST"</span>, <span class="number">300.22</span>),</div><div class="line">  <span class="type">Purchase</span>(<span class="number">189</span>, <span class="number">254</span>, <span class="string">"2007-12-13"</span>, <span class="string">"00:50"</span>, <span class="string">"EST"</span>, <span class="number">122.19</span>),</div><div class="line">  <span class="type">Purchase</span>(<span class="number">187</span>, <span class="number">299</span>, <span class="string">"2007-12-12"</span>, <span class="string">"07:30"</span>, <span class="string">"UTC"</span>, <span class="number">524.37</span>)</div><div class="line">))</div><div class="line"></div><div class="line"><span class="keyword">val</span> df = sqlContext.createDataFrame(x)</div><div class="line">df.registerTempTable(<span class="string">"df"</span>)</div></pre></td></tr></table></figure>
<p>è‡ªå®šä¹‰å‡½æ•°</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeDT</span></span>(date: <span class="type">String</span>, time: <span class="type">String</span>, tz: <span class="type">String</span>) = <span class="string">s"<span class="subst">$date</span> <span class="subst">$time</span> <span class="subst">$tz</span>"</span></div><div class="line">sqlContext.udf.register(<span class="string">"makeDt"</span>, makeDT(_:<span class="type">String</span>,_:<span class="type">String</span>,_:<span class="type">String</span>))</div><div class="line"></div><div class="line"><span class="comment">// Now we can use our function directly in SparkSQL.</span></div><div class="line">sqlContext.sql(<span class="string">"SELECT amount, makeDt(date, time, tz) from df"</span>).take(<span class="number">2</span>)</div><div class="line"><span class="comment">// but not outside</span></div><div class="line">df.select($<span class="string">"customer_id"</span>, makeDt($<span class="string">"date"</span>, $<span class="string">"time"</span>, $<span class="string">"tz"</span>), $<span class="string">"amount"</span>).take(<span class="number">2</span>) <span class="comment">// fails</span></div></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³è¦åœ¨SQLå¤–é¢ä½¿ç”¨ï¼Œå¿…é¡»é€šè¿‡<code>spark.sql.function.udf</code>æ¥åˆ›å»ºUDF</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> org.apache.spark.sql.functions.udf</div><div class="line"><span class="keyword">val</span> makeDt = udf(makeDT(_:<span class="type">String</span>,_:<span class="type">String</span>,_:<span class="type">String</span>))</div><div class="line"><span class="comment">// now this works</span></div><div class="line">df.select($<span class="string">"customer_id"</span>, makeDt($<span class="string">"date"</span>, $<span class="string">"time"</span>, $<span class="string">"tz"</span>), $<span class="string">"amount"</span>).take(<span class="number">2</span>)</div></pre></td></tr></table></figure>
<h1 id="å®è·µæ“ä½œ"><a href="#å®è·µæ“ä½œ" class="headerlink" title="å®è·µæ“ä½œ"></a>å®è·µæ“ä½œ</h1><p>å†™ä¸€ä¸ªUDFæ¥å°†ä¸€äº›Intæ•°å­—åˆ†ç±»</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">val</span> formatDistribution = (view: <span class="type">Int</span>) =&gt; &#123;</div><div class="line">  <span class="keyword">if</span> (view &lt; <span class="number">10</span>) &#123;</div><div class="line">    <span class="string">"&lt;10"</span></div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (view &lt;= <span class="number">100</span>) &#123;</div><div class="line">    <span class="string">"10~100"</span></div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (view &lt;= <span class="number">1000</span>) &#123;</div><div class="line">    <span class="string">"100~1K"</span></div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (view &lt;= <span class="number">10000</span>) &#123;</div><div class="line">    <span class="string">"1K~10K"</span></div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (view &lt;= <span class="number">100000</span>) &#123;</div><div class="line">    <span class="string">"10K~100K"</span></div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="string">"&gt;100K"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨å†Œï¼š</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">session.udf.register(<span class="string">"formatDistribution"</span>, <span class="type">UDF</span>.formatDistribution)</div></pre></td></tr></table></figure>
<p>SQLï¼š</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">session.sql(<span class="string">"select user_id, formatDistribution(variance_digg_count) as variance from video"</span>)</div></pre></td></tr></table></figure>
<p>å†™åˆ°è¿™é‡Œï¼Œå†å›é¡¾UDFï¼Œæˆ‘æ„Ÿè§‰è¿™å°±åƒæ˜¯å»ä¸ºäº†æ–¹ä¾¿åšä¸€ä¸ªåˆ†ç±»è½¬åŒ–ç­‰æ“ä½œï¼Œå’ŒPythoné‡Œé¢çš„å‡½æ•°ä¸€æ ·ï¼Œåªä¸è¿‡è¿™é‡Œçš„UDFä¸€èˆ¬ç‰¹æŒ‡Spark SQLé‡Œé¢ä½¿ç”¨çš„å‡½æ•°ã€‚ç„¶åå‘ç°è¿™é‡Œå’ŒSQLä¸­çš„è‡ªå®šä¹‰å‡½æ•°æŒºåƒçš„:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> [å‡½æ•°æ‰€æœ‰è€….]&lt;å‡½æ•°åç§°&gt; </div><div class="line">(   </div><div class="line">    <span class="comment">-- æ·»åŠ å‡½æ•°æ‰€éœ€çš„å‚æ•°ï¼Œå¯ä»¥æ²¡æœ‰å‚æ•°</span></div><div class="line">    [&lt;@param1&gt; &lt;å‚æ•°ç±»å‹&gt;]</div><div class="line">    [,&lt;@param1&gt; &lt;å‚æ•°ç±»å‹&gt;]â€¦</div><div class="line">)</div><div class="line"><span class="keyword">RETURNS</span> <span class="keyword">TABLE</span> </div><div class="line"><span class="keyword">AS</span></div><div class="line"><span class="keyword">RETURN</span> </div><div class="line">(</div><div class="line">    <span class="comment">-- æŸ¥è¯¢è¿”å›çš„SQLè¯­å¥</span></div><div class="line">    <span class="keyword">SELECT</span>æŸ¥è¯¢è¯­å¥</div><div class="line">)</div></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">* åˆ›å»ºå†…è”è¡¨å€¼å‡½æ•°ï¼ŒæŸ¥è¯¢äº¤æ˜“æ€»é¢å¤§äº1Wçš„å¼€æˆ·äººä¸ªäººä¿¡æ¯</div><div class="line">*/</div><div class="line"><span class="keyword">create</span> <span class="keyword">function</span> getCustInfo()</div><div class="line"><span class="keyword">returns</span> @CustInfo <span class="keyword">table</span>  <span class="comment">--è¿”å›tableç±»å‹</span></div><div class="line">(</div><div class="line">    <span class="comment">--è´¦æˆ·ID</span></div><div class="line">    CustID <span class="built_in">int</span>,</div><div class="line">    <span class="comment">--å¸æˆ·åç§°</span></div><div class="line">    CustName <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,</div><div class="line">    <span class="comment">--èº«ä»½è¯å·</span></div><div class="line">    IDCard <span class="built_in">varchar</span>(<span class="number">18</span>),</div><div class="line">    <span class="comment">--ç”µè¯</span></div><div class="line">    TelePhone <span class="built_in">varchar</span>(<span class="number">13</span>) <span class="keyword">not</span> <span class="literal">null</span>,</div><div class="line">    <span class="comment">--åœ°å€</span></div><div class="line">    Address <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">default</span>(<span class="string">'åœ°å€ä¸è¯¦'</span>)</div><div class="line">)</div><div class="line"><span class="keyword">as</span></div><div class="line"><span class="keyword">begin</span></div><div class="line">    <span class="comment">--ä¸ºtableè¡¨èµ‹å€¼</span></div><div class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> @CustInfo</div><div class="line">    <span class="keyword">select</span> CustID,CustName,IDCard,TelePhone,Address <span class="keyword">from</span> AccountInfo </div><div class="line">    <span class="keyword">where</span> CustID <span class="keyword">in</span> (<span class="keyword">select</span> CustID <span class="keyword">from</span> CardInfo </div><div class="line">    <span class="keyword">where</span> CardID <span class="keyword">in</span> (<span class="keyword">select</span> CardID <span class="keyword">from</span> TransInfo <span class="keyword">group</span> <span class="keyword">by</span> CardID,transID,TransType,TransMoney,TransDate <span class="keyword">having</span> <span class="keyword">sum</span>(TransMoney)&gt;<span class="number">10000</span>))</div><div class="line">    <span class="keyword">return</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">go</span></div><div class="line"><span class="comment">-- è°ƒç”¨å†…è”è¡¨å€¼å‡½æ•°</span></div><div class="line"><span class="keyword">select</span> * <span class="keyword">from</span> getCustInfo()</div><div class="line"><span class="keyword">go</span></div></pre></td></tr></table></figure>
<p>å¥½åƒæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws3.sinaimg.cn/large/006tNbRwly1fwj6agtwwoj30ag05k3zb.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åä¸ƒç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="spark" scheme="https://zhangslob.github.io/categories/spark/"/>
    
    
      <category term="spark" scheme="https://zhangslob.github.io/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>sparkå®æˆ˜ï¼ˆä¸€ï¼‰ï¼šå¯¹æ•°æ®å¤„ç†çš„ç†è§£</title>
    <link href="https://zhangslob.github.io/2018/10/24/spark%E5%AE%9E%E6%88%98%E4%B8%80%EF%BC%9A%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E7%9A%84%E7%90%86%E8%A7%A3/"/>
    <id>https://zhangslob.github.io/2018/10/24/sparkå®æˆ˜ä¸€ï¼šå¯¹æ•°æ®å¤„ç†çš„ç†è§£/</id>
    <published>2018-10-24T03:05:16.000Z</published>
    <updated>2018-10-24T09:13:17.261Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fwj6agtwwoj30ag05k3zb.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åå…­ç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<hr>
<a id="more"></a>
<h1 id="å¤§æ•°æ®çš„å­¦ä¹ ç»å†"><a href="#å¤§æ•°æ®çš„å­¦ä¹ ç»å†" class="headerlink" title="å¤§æ•°æ®çš„å­¦ä¹ ç»å†"></a>å¤§æ•°æ®çš„å­¦ä¹ ç»å†</h1><p>å¤§æ•°æ®æ˜¯ä»€ä¹ˆï¼Œæˆ‘è§‰å¾—åº”è¯¥æœ‰è¿™ä¹ˆå‡ æ­¥ï¼š</p>
<ol>
<li>æ•°æ®é‡‡é›†ï¼ˆPython&amp;&amp;Scrapyï¼‰</li>
<li>æ•°æ®æ¸…æ´—ï¼ˆScala&amp;&amp;Sparkï¼‰</li>
<li>æŒ‡æ ‡è®¡ç®—ï¼ˆScala&amp;&amp;Sparkï¼‰</li>
<li>æ•°æ®å±•ç¤ºï¼ˆPostgreï¼‰</li>
</ol>
<p>åšäº†ä¸€æ®µæ—¶é—´çš„çˆ¬è™«ï¼Œæˆ–è€…è¯´å«æ•°æ®é‡‡é›†ï¼Œä½†æ˜¯ä»æ¥æ²¡æœ‰æ¥è§¦åˆ°å¤§æ•°æ®çš„ä¸‹ä¸€æ­¥ã€‚æœ€è¿‘å’Œæ…¢æ…¢èŠäº†ä¸‹ï¼Œå¯¹æ•°æ®å¤„ç†ä¹Ÿå¾ˆæ„Ÿå…´è¶£ï¼Œä¾¿æƒ³å»æ¥è§¦ã€å°è¯•ã€‚</p>
<p>åœ¨æ…¢æ…¢ã€ç™»ç™»ç­‰äººçš„å¸®åŠ©ä¸‹ï¼Œå¼€å§‹å­¦ä¹ äº†ä¸€æ®µæ—¶é—´çš„Sparkã€‚åˆšå¼€å§‹å­¦ä¹ SQLè¯­å¥ï¼Œç°åœ¨å°±è®°å¾—ç®€å•çš„é‚£äº›äº†ã€‚ç„¶åå»çœ‹Sparkæ–‡æ¡£ï¼Œè‡ªå·±åŠ¨æ‰‹å¼€å§‹å†™ã€‚</p>
<p>å› ä¸ºå›¢é˜Ÿä¸»è¦ç”¨Scalaå¼€å‘ï¼Œæ‰€ä»¥ä¸­é€”åˆèŠ±äº†ä¸€äº›æ—¶é—´æ¥å­¦ä¹ Scalaè¯­è¨€ï¼Œæ„Ÿè§‰å’ŒPythonæœ‰è®¸å¤šç±»ä¼¼çš„åœ°æ–¹ï¼Œå¹¶ä¸æ˜¯å¤ªéš¾ï¼Œä½†æ˜¯Scalaæœ‰ä¸€äº›ç‰¹æ€§ï¼Œä¸æ˜¯å¤ªæ˜ç™½ï¼Œä¸»è¦æ˜¯è‡ªå·±å†™å¤ªå°‘äº†ã€‚çˆ¬è™«ä»€ä¹ˆçš„è¿˜æ˜¯ç”¨Pythonã€‚</p>
<p>ç„¶åå†å»çœ‹å…·ä½“çš„Spark é¡¹ç›®ï¼Œæ¨¡ä»¿ï¼ˆæŠ„è¢­ï¼‰åˆ«äººçš„ä»£ç ï¼Œå¤§æ¦‚ä¹Ÿçœ‹æ‡‚äº†ä¸€äº›ï¼Œç”±äºå§‹ç»ˆæ²¡æœ‰è‡ªå·±å®è·µæ¥æ“ä½œï¼Œæ‰€ä»¥ç¼ºä¹å®é™…æ“ä½œèƒ½åŠ›ã€‚æœ€å¥½çš„åŠæ³•å°±æ˜¯è‡ªå·±å»å†™ï¼Œæ‰€ä»¥è®¡åˆ’è‡ªå·±å»å•ç‹¬åšä¸€ä¸ªé¡¹ç›®è¯•è¯•çœ‹ï¼Œæ‰‹å¤´ä¸Šè¿˜æœ‰å¥½å¤šå·²å¼€å‘ä½†æ˜¯è¿˜æ²¡å¼€å§‹è®¡ç®—çš„é¡¹ç›®ï¼Œæˆ‘è‡ªå·±å¯ä»¥å…ˆè¯•è¯•çœ‹ã€‚</p>
<h1 id="å¤§æ•°æ®å¤„ç†æ­¥éª¤"><a href="#å¤§æ•°æ®å¤„ç†æ­¥éª¤" class="headerlink" title="å¤§æ•°æ®å¤„ç†æ­¥éª¤"></a>å¤§æ•°æ®å¤„ç†æ­¥éª¤</h1><p>åœ¨ä¸Šé¢æ‰€è¯´çš„åŸºç¡€ä¸Šå†è¯´ç»†ä¸€äº›ã€‚</p>
<ul>
<li>æ•°æ®é‡‡é›†å°±åˆ«è¯´äº†ï¼Œå°±æ˜¯é‡‡é›†æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼ˆäº§å“ç»ç†è¦æ±‚çš„ï¼‰æ•°æ®</li>
<li>æ•°æ®æ¸…æ´—è¿™é‡Œï¼Œæ˜¯å’Œæ•°æ®é‡‡é›†æœ‰å¾ˆå¤§å…³ç³»çš„ã€‚åˆ†ä¸ºè¿™ä¹ˆä¸¤æ­¥ï¼š<ul>
<li>æå–æŒ‡å®šæ•°æ®ã€‚å› ä¸ºæˆ‘ä»¬åœ¨åšæ•°æ®é‡‡é›†çš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œæ˜¯å°½å¯èƒ½å¤šçš„ä¿å­˜åŸå§‹æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åˆ«äººç»™å¤šå°‘ï¼Œæˆ‘å°±å–å¤šå°‘ï¼Œä½†æ˜¯è¿™äº›æ•°æ®å¹¶ééƒ½æ˜¯æœ‰ç”¨çš„æ•°æ®ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥æ˜¯éœ€è¦å»æå–åŸå§‹æ•°æ®è¡¨ä¸­æˆ‘ä»¬æ‰€éœ€è¦çš„æŒ‡å®šæ•°æ®ã€‚è¿™é‡Œæ–¹æ³•æœ‰å¾ˆå¤šï¼Œç”¨SQLï¼Œæˆ–è€…åœ¨é“è·¯æ•°æ®çš„æ—¶å€™ç›´æ¥é€‰å–é‚£äº›å­—æ®µå³å¯ã€‚æœ€åæˆ‘ä»¬æŠŠè¿™äº›æå–çš„æ•°æ®é‡æ–°ä¿å­˜åœ¨æ–°çš„è¡¨ä¸­ï¼Œè¿™æ ·åé¢è®¡ç®—ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚ï¼ˆå…¶å®è¿™ä¸€æ­¥åœ¨æ•°æ®é‡‡é›†å°±å¯ä»¥å®Œæˆï¼Œä½†æ˜¯è°ä¹Ÿè¯´ä¸æ¸…åˆ°åº•ä»¥åä¼šä¸ä¼šéœ€è¦æ›´å¤šçš„æ•°æ®ï¼‰</li>
<li>æ¸…æ´—æ•°æ®ã€‚æ¯”å¦‚æ—¶é—´ç»´åº¦ã€ä¸ºç©ºå­—æ®µç­‰ç­‰ï¼Œè¿™äº›ç°åœ¨é‡åˆ°çš„è¿˜ä¸å¤šï¼Œä»¥åå†è¡¥ä¸Šã€‚</li>
</ul>
</li>
<li>æŒ‡æ ‡è®¡ç®—ã€‚è¿™ä¸€æ­¥å°±éœ€è¦æ ¹æ®å…·ä½“çš„éœ€æ±‚æ¥è®¡ç®—å„ç§ç»´åº¦ï¼Œå¹¶æŠŠè®¡ç®—å¥½çš„æ•°æ®ä¿å­˜æ–°è¡¨ã€‚</li>
<li>æ•°æ®å±•ç¤ºã€‚è¿™éƒ¨åˆ†å¥½åƒæ˜¯åç«¯åšçš„ï¼Œå¾…äº†è§£ã€‚</li>
</ul>
<h1 id="éœ€è¦äº†è§£çš„çŸ¥è¯†"><a href="#éœ€è¦äº†è§£çš„çŸ¥è¯†" class="headerlink" title="éœ€è¦äº†è§£çš„çŸ¥è¯†"></a>éœ€è¦äº†è§£çš„çŸ¥è¯†</h1><ol>
<li><p>å¼€å‘å·¥å…·å’Œç¯å¢ƒ </p>
<ol>
<li>MongoDB </li>
<li>Postgre </li>
<li>SQLï¼ŒJOIN </li>
<li>Docker </li>
<li>IDEAã€SBT </li>
<li>Scalaï¼ˆ2.10+ï¼‰ </li>
</ol>
</li>
<li><p>Spark </p>
<ol>
<li>å®˜æ–¹æ–‡æ¡£ </li>
<li>UDF </li>
</ol>
</li>
</ol>
<p>ç›®å‰æ„Ÿè§‰ä»¥ä¸Šéƒ¨åˆ†éƒ½æœ‰ä¸€çŸ¥åŠè§£ï¼Œå¿…é¡»è¦å®é™…å»åšæ‰èƒ½çŸ¥é“åˆ°åº•é‚£éƒ¨åˆ†æŒæ¡ï¼Œé‚£éƒ¨åˆ†è¿˜ä¸æ‡‚ã€‚</p>
<h1 id="æˆ‘çš„è®¡åˆ’"><a href="#æˆ‘çš„è®¡åˆ’" class="headerlink" title="æˆ‘çš„è®¡åˆ’"></a>æˆ‘çš„è®¡åˆ’</h1><ol>
<li>æ‰¾PMè¦DMæ–‡æ¡£ï¼Œç†è§£å…·ä½“ä¸šåŠ¡éœ€æ±‚</li>
<li>æ ¹æ®éœ€æ±‚æ¥é€‰æ‹©æ•°æ®åº“ä¸­çš„æ•°æ®ç»´åº¦</li>
<li>åœ¨æœ¬åœ°å°è¯•æ•°æ®æ¸…æ´—å¹¶è®¡ç®—æŒ‡æ ‡</li>
<li>æœ‰é—®é¢˜è¯·æ•™æ…¢æ…¢ï¼†ç™»ç™»</li>
</ol>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwly1fwjf538h8bj30f50awgm6.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws3.sinaimg.cn/large/006tNbRwly1fwj6agtwwoj30ag05k3zb.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åå…­ç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;hr&gt;
    
    </summary>
    
      <category term="spark" scheme="https://zhangslob.github.io/categories/spark/"/>
    
    
      <category term="spark" scheme="https://zhangslob.github.io/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>Sparkæ•™ç¨‹ï¼ˆäºŒï¼‰Sparkè¿æ¥MongoDB</title>
    <link href="https://zhangslob.github.io/2018/09/03/Spark%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89Spark%E8%BF%9E%E6%8E%A5MongoDB/"/>
    <id>https://zhangslob.github.io/2018/09/03/Sparkæ•™ç¨‹ï¼ˆäºŒï¼‰Sparkè¿æ¥MongoDB/</id>
    <published>2018-09-03T14:00:59.000Z</published>
    <updated>2018-09-03T14:07:13.658Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://pic4.zhimg.com/v2-4d4095947c89bd7dc59b691aec7fb0ed_1200x500.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åäº”ç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<p>å­¦ä¹ Spark  (à¹‘â€¢ . â€¢à¹‘)</p>
<a id="more"></a>
<h1 id="å¦‚ä½•å¯¼å…¥æ•°æ®"><a href="#å¦‚ä½•å¯¼å…¥æ•°æ®" class="headerlink" title="å¦‚ä½•å¯¼å…¥æ•°æ®"></a>å¦‚ä½•å¯¼å…¥æ•°æ®</h1><p>æ•°æ®å¯èƒ½æœ‰å„ç§æ ¼å¼ï¼Œè™½ç„¶å¸¸è§çš„æ˜¯<code>HDFS</code>ï¼Œä½†æ˜¯å› ä¸ºåœ¨Pythonçˆ¬è™«ä¸­æ•°æ®åº“ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯<code>MongoDB</code>ï¼Œæ‰€ä»¥è¿™é‡Œä¼šé‡ç‚¹è¯´è¯´å¦‚ä½•ç”¨sparkå¯¼å…¥<code>MongoDB</code>ä¸­çš„æ•°æ®ã€‚</p>
<p>å½“ç„¶ï¼Œé¦–å…ˆä½ éœ€è¦åœ¨è‡ªå·±ç”µè„‘ä¸Šå®‰è£…sparkç¯å¢ƒï¼Œç®€å•è¯´ä¸‹ï¼Œåœ¨è¿™é‡Œ<a href="http://spark.apache.org/downloads.html" target="_blank" rel="external">ä¸‹è½½spark</a>ï¼ŒåŒæ—¶éœ€è¦é…ç½®å¥½<code>JAVA</code>ï¼Œ<code>Scala</code>ç¯å¢ƒã€‚</p>
<p>è¿™é‡Œå»ºè®®ä½¿ç”¨<code>Jupyter notebook</code>ï¼Œä¼šæ¯”è¾ƒæ–¹ä¾¿ï¼Œåœ¨ç¯å¢ƒå˜é‡ä¸­è¿™æ ·è®¾ç½®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">PYSPARK_DRIVER_PYTHON=jupyter </div><div class="line">PYSPARK_DRIVER_PYTHON_OPTS=notebook ./bin/pyspark</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ çš„ç¯å¢ƒä¸­æœ‰å¤šä¸ªPythonç‰ˆæœ¬ï¼ŒåŒæ ·å¯ä»¥åˆ¶å®šä½ æƒ³è¦ä½¿ç”¨çš„è§£é‡Šå™¨ï¼Œæˆ‘è¿™é‡Œæ˜¯<code>python36</code>ï¼Œæ ¹æ®éœ€æ±‚ä¿®æ”¹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PYSPARK_PYTHON=/usr/bin/python36</div></pre></td></tr></table></figure>
<h1 id="å¯åŠ¨å‘½ä»¤"><a href="#å¯åŠ¨å‘½ä»¤" class="headerlink" title="å¯åŠ¨å‘½ä»¤"></a>å¯åŠ¨å‘½ä»¤</h1><p>è¿›å…¥sparkæ ¹ç›®å½•ï¼Œ<code>./bin/pyspark</code>è¿™æ˜¯æœ€ç®€å•çš„å¯åŠ¨å‘½ä»¤ï¼Œé»˜è®¤ä¼šæ‰“å¼€Pythonçš„äº¤äº’å¼è§£é‡Šå™¨ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬ä¸Šé¢æœ‰è®¾ç½®è¿‡ï¼Œä¼šæ‰“å¼€<code>Jupyter notebook</code>ï¼Œæ¥ä¸‹æ¥å˜æˆä¼šæ–¹ä¾¿å¾ˆå¤šã€‚</p>
<p>å…ˆæ¥çœ‹çœ‹æœ€ç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; textFile = spark.read.text(<span class="string">"README.md"</span>)</div><div class="line"></div><div class="line">&gt;&gt;&gt; textFile.count()  <span class="comment"># Number of rows in this DataFrame</span></div><div class="line">126</div><div class="line"></div><div class="line">&gt;&gt;&gt; textFile.first()  <span class="comment"># First row in this DataFrame</span></div><div class="line">Row(value=u<span class="string">'# Apache Spark'</span>)</div><div class="line"></div><div class="line">&gt;&gt;&gt; linesWithSpark = textFile.filter(textFile.value.contains(<span class="string">"Spark"</span>))</div><div class="line"></div><div class="line"></div><div class="line">&gt;&gt;&gt; textFile.filter(textFile.value.contains(<span class="string">"Spark"</span>)).count()  <span class="comment"># How many lines contain "Spark"?</span></div><div class="line">15</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰æˆ‘ä¹‹å‰å†™è¿‡çš„ä¾‹å­ï¼Œå¯ä»¥ç…§ç€å†™ä¸€é <a href="https://github.com/zhangslob/learning-spark/blob/master/code/Python/basic_exercise.ipynb" target="_blank" rel="external">basic_exercise</a></p>
<p>æˆ‘ä»¬çš„å¯åŠ¨æ–¹å¼æ˜¯<code>./bin/pyspark</code>ï¼Œæˆ‘ä»¬å¯ä»¥å®¶åé¢åŠ å¾ˆå¤šå‚æ•°ï¼Œæ¯”å¦‚è¯´å¦‚è‹¥æˆ‘ä»¬è¦è¿æ¥MongoDBï¼Œå°±éœ€è¦è¿™æ ·</p>
<p>å®Œæ•´çš„å¯ä»¥å‚è€ƒ<a href="https://docs.mongodb.com/spark-connector/master/python-api/" target="_blank" rel="external">Spark Connector Python Guide</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">./bin/pyspark --conf <span class="string">"spark.mongodb.input.uri=mongodb://127.0.0.1/test.myCollection?readPreference=primaryPreferred"</span> \</div><div class="line">              --conf <span class="string">"spark.mongodb.output.uri=mongodb://127.0.0.1/test.myCollection"</span> \</div><div class="line">              --packages org.mongodb.spark:mongo-spark-connector_2.11:2.3.0</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ª<code>uri</code>ï¼Œåˆ†åˆ«æ˜¯<code>input</code>å’Œ<code>output</code>ï¼Œå¯¹åº”è¯»å–çš„æ•°æ®åº“å’Œå†™å…¥çš„æ•°æ®åº“ï¼Œæœ€åé¢çš„<code>packages</code>ç›¸å½“äºå¼•å…¥çš„åŒ…çš„åå­—ï¼Œæˆ‘ä¸€èˆ¬å–œæ¬¢åœ¨ä»£ç ä¸­å®šä¹‰ã€‚</p>
<h1 id="è¯»å–-ä¿å­˜æ•°æ®"><a href="#è¯»å–-ä¿å­˜æ•°æ®" class="headerlink" title="è¯»å–/ä¿å­˜æ•°æ®"></a>è¯»å–/ä¿å­˜æ•°æ®</h1><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¢åŠ å‚æ•°<code>option</code>ï¼Œåœ¨è¿™é‡Œè®¾ç½®æƒ³è¦è¯»å–çš„æ•°æ®åº“åœ°å€ï¼Œæ³¨æ„æ ¼å¼ã€‚</p>
<p>è¯»å–æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">df = spark.read.format(<span class="string">"com.mongodb.spark.sql.DefaultSource"</span>).option(<span class="string">"uri"</span>,</div><div class="line"><span class="string">"mongodb://127.0.0.1/people.contacts"</span>).load()</div></pre></td></tr></table></figure>
<p>ä¿å­˜æ•°æ®</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">people.write.format(<span class="string">"com.mongodb.spark.sql.DefaultSource"</span>).mode(<span class="string">"append"</span>).option(<span class="string">"uri"</span>,</div><div class="line"><span class="string">"mongodb://127.0.0.1/people.contacts"</span>).option(<span class="string">"database"</span>,</div><div class="line"><span class="string">"people"</span>).option(<span class="string">"collection"</span>, <span class="string">"contacts"</span>).save()</div></pre></td></tr></table></figure>
<p>ç®€å•å¯¹æ¯”ä¸‹ï¼Œ<code>option</code>è¿˜å¯ä»¥å®šä¹‰<code>database</code>å’Œ<code>collection</code>ï¼Œè¿™æ ·å°±ä¸éœ€è¦åœ¨å¯åŠ¨Sparkæ—¶å®šä¹‰ã€‚</p>
<p>ä»¥ä¸Šæ˜¯å®˜ç½‘æ¨èçš„è¿æ¥æ–¹å¼ï¼Œè¿™é‡Œéœ€è¦è¯´çš„æ˜¯å¦ä¸€ç§ï¼Œå¦‚æœæˆ‘æ²¡æœ‰ä»å‘½ä»¤è¡Œä¸­å¯åŠ¨ï¼Œè€Œæ˜¯ç›´æ¥æ–°å»ºä¸€ä¸ªpyæ–‡ä»¶ï¼Œè¯¥å¦‚ä½•æ“ä½œï¼Ÿ</p>
<p>æœç´¢ç›¸å…³èµ„æ–™åï¼Œå‘ç°æ˜¯è¿™æ ·</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"></div><div class="line">__author__ = <span class="string">'zhangslob'</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</div><div class="line"></div><div class="line"><span class="comment"># set PYSPARK_PYTHON to python36</span></div><div class="line">os.environ[<span class="string">'PYSPARK_PYTHON'</span>] = <span class="string">'/usr/bin/python36'</span></div><div class="line"></div><div class="line"><span class="comment"># load mongo data</span></div><div class="line">input_uri = <span class="string">"mongodb://127.0.0.1:spark.spark_test"</span></div><div class="line">output_uri = <span class="string">"mongodb://127.0.0.1:spark.spark_test"</span></div><div class="line"></div><div class="line">my_spark = SparkSession\</div><div class="line">    .builder\</div><div class="line">    .appName(<span class="string">"MyApp"</span>)\</div><div class="line">    .config(<span class="string">"spark.mongodb.input.uri"</span>, input_uri)\</div><div class="line">    .config(<span class="string">"spark.mongodb.output.uri"</span>, output_uri)\</div><div class="line">    .config(<span class="string">'spark.jars.packages'</span>,<span class="string">'org.mongodb.spark:mongo-spark-connector_2.11:2.2.0'</span>)\</div><div class="line">    .getOrCreate()</div><div class="line"></div><div class="line">df = my_spark.read.format(<span class="string">'com.mongodb.spark.sql.DefaultSource'</span>).load()</div></pre></td></tr></table></figure>
<p>å¿…é¡»è¦å¢åŠ é»˜è®¤è®¾ç½®<code>(&#39;spark.jars.packages&#39;,&#39;org.mongodb.spark:mongo-spark-connector_2.11:2.2.0&#39;)</code>ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4d4095947c89bd7dc59b691aec7fb0ed_1200x500.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åäº”ç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å­¦ä¹ Spark  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
    
    </summary>
    
      <category term="spark" scheme="https://zhangslob.github.io/categories/spark/"/>
    
    
      <category term="spark" scheme="https://zhangslob.github.io/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>Sparkæ•™ç¨‹ï¼ˆä¸€ï¼‰ä¸ºä»€ä¹ˆè¦å­¦spark</title>
    <link href="https://zhangslob.github.io/2018/09/01/Spark%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%AD%A6spark/"/>
    <id>https://zhangslob.github.io/2018/09/01/Sparkæ•™ç¨‹ï¼ˆä¸€ï¼‰ä¸ºä»€ä¹ˆè¦å­¦spark/</id>
    <published>2018-09-01T14:00:50.000Z</published>
    <updated>2018-09-03T14:05:47.548Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://pic4.zhimg.com/v2-4d4095947c89bd7dc59b691aec7fb0ed_1200x500.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åå››ç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<p>å­¦ä¹ Spark  (à¹‘â€¢ . â€¢à¹‘)</p>
<a id="more"></a>
<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>Apache Sparkæ˜¯ä¸€ä¸ªå¼€æºé›†ç¾¤è¿ç®—æ¡†æ¶ï¼Œæœ€åˆæ˜¯ç”±åŠ å·å¤§å­¦æŸå…‹è±åˆ†æ ¡AMPLabæ‰€å¼€å‘ã€‚ç›¸å¯¹äºHadoopçš„MapReduceä¼šåœ¨è¿è¡Œå®Œå·¥ä½œåå°†ä¸­ä»‹æ•°æ®å­˜æ”¾åˆ°ç£ç›˜ä¸­ï¼ŒSparkä½¿ç”¨äº†å­˜å‚¨å™¨å†…è¿ç®—æŠ€æœ¯ï¼Œèƒ½åœ¨æ•°æ®å°šæœªå†™å…¥ç¡¬ç›˜æ—¶å³åœ¨å­˜å‚¨å™¨å†…åˆ†æè¿ç®—ã€‚</p>
<p>Sparkåœ¨å­˜å‚¨å™¨å†…è¿è¡Œç¨‹åºçš„è¿ç®—é€Ÿåº¦èƒ½åšåˆ°æ¯”Hadoop MapReduceçš„è¿ç®—é€Ÿåº¦å¿«ä¸Š100å€ï¼Œå³ä¾¿æ˜¯è¿è¡Œç¨‹åºäºç¡¬ç›˜æ—¶ï¼ŒSparkä¹Ÿèƒ½å¿«ä¸Š10å€é€Ÿåº¦ã€‚Sparkå…è®¸ç”¨æˆ·å°†æ•°æ®åŠ è½½è‡³é›†ç¾¤å­˜å‚¨å™¨ï¼Œå¹¶å¤šæ¬¡å¯¹å…¶è¿›è¡ŒæŸ¥è¯¢ï¼Œéå¸¸é€‚åˆç”¨äºæœºå™¨å­¦ä¹ ç®—æ³•</p>
<p>Sparkä¹Ÿæ”¯æŒä¼ªåˆ†å¸ƒå¼ï¼ˆpseudo-distributedï¼‰æœ¬åœ°æ¨¡å¼ï¼Œä¸è¿‡é€šå¸¸åªç”¨äºå¼€å‘æˆ–æµ‹è¯•æ—¶ä»¥æœ¬æœºæ–‡ä»¶ç³»ç»Ÿå–ä»£åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼ŒSparkä»…åœ¨ä¸€å°æœºå™¨ä¸Šä½¿ç”¨æ¯ä¸ªCPUæ ¸å¿ƒè¿è¡Œç¨‹åºã€‚</p>
<blockquote>
<p>Apache Sparkâ„¢ is a unified analytics engine for large-scale data processing.</p>
</blockquote>
<h1 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h1><ol>
<li>é¦–å…ˆï¼ŒSparkä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…¨é¢ã€ç»Ÿä¸€çš„æ¡†æ¶ç”¨äºç®¡ç†å„ç§æœ‰ç€ä¸åŒæ€§è´¨ï¼ˆæ–‡æœ¬æ•°æ®ã€å›¾è¡¨æ•°æ®ç­‰ï¼‰çš„æ•°æ®é›†å’Œæ•°æ®æºï¼ˆæ‰¹é‡æ•°æ®æˆ–å®æ—¶çš„æµæ•°æ®ï¼‰çš„å¤§æ•°æ®å¤„ç†çš„éœ€æ±‚ã€‚</li>
<li>Sparkå¯ä»¥å°†Hadoopé›†ç¾¤ä¸­çš„åº”ç”¨åœ¨å†…å­˜ä¸­çš„è¿è¡Œé€Ÿåº¦æå‡100å€ï¼Œç”šè‡³èƒ½å¤Ÿå°†åº”ç”¨åœ¨ç£ç›˜ä¸Šçš„è¿è¡Œé€Ÿåº¦æå‡10å€ã€‚</li>
<li>Sparkè®©å¼€å‘è€…å¯ä»¥å¿«é€Ÿçš„ç”¨Javaã€Scalaæˆ–Pythonç¼–å†™ç¨‹åºã€‚å®ƒæœ¬èº«è‡ªå¸¦äº†ä¸€ä¸ªè¶…è¿‡80ä¸ªé«˜é˜¶æ“ä½œç¬¦é›†åˆã€‚è€Œä¸”è¿˜å¯ä»¥ç”¨å®ƒåœ¨shellä¸­ä»¥äº¤äº’å¼åœ°æŸ¥è¯¢æ•°æ®ã€‚</li>
<li>é™¤äº†Mapå’ŒReduceæ“ä½œä¹‹å¤–ï¼Œå®ƒè¿˜æ”¯æŒSQLæŸ¥è¯¢ï¼Œæµæ•°æ®ï¼Œæœºå™¨å­¦ä¹ å’Œå›¾è¡¨æ•°æ®å¤„ç†ã€‚å¼€å‘è€…å¯ä»¥åœ¨ä¸€ä¸ªæ•°æ®ç®¡é“ç”¨ä¾‹ä¸­å•ç‹¬ä½¿ç”¨æŸä¸€èƒ½åŠ›æˆ–è€…å°†è¿™äº›èƒ½åŠ›ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ã€‚</li>
</ol>
<p><img src="https://pic4.zhimg.com/80/v2-9fad838af226986154c0053b0b59d337_hd.jpg" alt=""></p>
<h1 id="äº²èº«ä½“ä¼š"><a href="#äº²èº«ä½“ä¼š" class="headerlink" title="äº²èº«ä½“ä¼š"></a>äº²èº«ä½“ä¼š</h1><p>ç»è¿‡è¿™ä¸¤å‘¨çš„æŠ˜è…¾ï¼Œæ€»ç®—æ˜¯åœ¨æœ¬åœ°ç¯å¢ƒä¸‹å®Œæˆäº†ç¬¬ä¸€ä¸ªsparké¡¹ç›®ï¼Œå®Œæˆåä¸‡çº§æ–‡æœ¬åˆ†è¯å’Œå»é‡ï¼Œé€Ÿåº¦è¿˜æ˜¯æŒºå¿«çš„ï¼Œä»è¯»å–æ•°æ®ã€å¤„ç†æ•°æ®ã€å†åˆ°ä¿å­˜æ•°æ®ï¼Œå¤§æ¦‚èŠ±äº†ååˆ†é’Ÿå·¦å³ã€‚è¿™é‡Œæ“ä½œçš„æ•°æ®åº“éƒ½æ˜¯MongoDBï¼Œå› ä¸ºçˆ¬è™«çˆ¬å–çš„æ•°æ®éƒ½æ˜¯ç›´æ¥ä¿å­˜åˆ°Mongoã€‚</p>
<p>ä¹‹åå†å¢åŠ æ•°æ®é‡ï¼Œè¾¾åˆ°å››åƒå¤šä¸‡ï¼Œè¯»å–æ•°æ®èŠ±äº†8åˆ†é’Ÿï¼Œä¸‹å›¾æ˜¯æ­£åœ¨å¤„ç†å’Œä¿å­˜æ•°æ®çš„Spark UIã€‚</p>
<p><img src="https://pic1.zhimg.com/v2-297ea8af7b3cce137f8e49aeec10295d_r.jpg" alt=""></p>
<p>ä»¥å‰å¤„ç†æ•°æ®ä¼šä½¿ç”¨pandasï¼Œæ•°æ®ä¼šä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæ•°æ®é‡è¿‡å¤§å°±ä¼šå´©äº†ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åˆ†å¸ƒå¼è®¡ç®—çš„åŸå› ã€‚æ²¡æœ‰åšè¿‡æ¨ªå‘å¯¹æ¯”ï¼Œæš‚æ—¶è¿˜ä¸çŸ¥é“æœ‰å¤šå¤§å·®åˆ«ã€‚</p>
<p>æœ€åèŠ±äº†1.3hï¼Œæœ¬åœ°å¤„ç†å®Œäº†å››åƒå¤šä¸‡æ•°æ®ï¼ŒCPUå’Œå†…å­˜éƒ½è¦ç‚¸äº†ï¼Œçœ‹æ¥ä»¥åè®¡ç®—éƒ¨åˆ†è¿˜æ˜¯è¦æ­é›†ç¾¤ã€‚</p>
<p><img src="https://pic1.zhimg.com/v2-da6f75baee44298362382c4fdfda51fa_r.jpg" alt=""></p>
<h1 id="å­¦ä¹ è®¡åˆ’"><a href="#å­¦ä¹ è®¡åˆ’" class="headerlink" title="å­¦ä¹ è®¡åˆ’"></a>å­¦ä¹ è®¡åˆ’</h1><p>æˆ‘åœ¨Githubä¸Šå¼€äº†ä¸€ä¸ªä»“åº“ï¼Œè®°å½•æ‰€å­¦ï¼Œåœ°å€åœ¨è¿™ï¼š<a href="https://github.com/zhangslob/learning-spark" target="_blank" rel="external">learning-spark</a></p>
<p>åˆšå¼€å§‹ä½¿ç”¨çš„è¯­è¨€è¿˜æ˜¯Pythonï¼Œç›®æ ‡æ˜¯å­¦Scalaï¼Œçœ‹äº†äº›åŸºç¡€è¯­æ³•ï¼Œå’ŒPythonæŒºç±»ä¼¼çš„ï¼Œä»¥åå¤šå†™å†™ï¼Œç»´æŒè¿™ä¸ªé¡¹ç›®ï¼Œè®°å½•å„ç§å‘ã€‚</p>
<p>okï¼ŒBBäº†è¿™ä¹ˆå¤šï¼Œä¸‹ä¸€ç¯‡å°±è¦å¼€å§‹çœŸæ­£çš„ä»£ç å®æˆ˜äº†ã€‚</p>
<p><img src="https://pic3.zhimg.com/80/v2-7b58d87198c657329a93350c480cc75e_hd.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-4d4095947c89bd7dc59b691aec7fb0ed_1200x500.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åå››ç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å­¦ä¹ Spark  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
    
    </summary>
    
      <category term="spark" scheme="https://zhangslob.github.io/categories/spark/"/>
    
    
      <category term="spark" scheme="https://zhangslob.github.io/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨scrapyå‘é€postè¯·æ±‚çš„å‘</title>
    <link href="https://zhangslob.github.io/2018/08/24/%E4%BD%BF%E7%94%A8scrapy%E5%8F%91%E9%80%81post%E8%AF%B7%E6%B1%82%E7%9A%84%E5%9D%91/"/>
    <id>https://zhangslob.github.io/2018/08/24/ä½¿ç”¨scrapyå‘é€postè¯·æ±‚çš„å‘/</id>
    <published>2018-08-24T13:54:28.000Z</published>
    <updated>2018-09-03T13:59:38.696Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://pic1.zhimg.com/v2-4a7e42516aa3fc2ad8c5532d885e3c44_1200x500.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åä¸‰ç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<p>ä½¿ç”¨scrapyå‘é€postè¯·æ±‚çš„å‘</p>
<a id="more"></a>
<h1 id="ä½¿ç”¨requestså‘é€postè¯·æ±‚"><a href="#ä½¿ç”¨requestså‘é€postè¯·æ±‚" class="headerlink" title="ä½¿ç”¨requestså‘é€postè¯·æ±‚"></a>ä½¿ç”¨requestså‘é€postè¯·æ±‚</h1><p>å…ˆæ¥çœ‹çœ‹ä½¿ç”¨requestsæ¥å‘é€postè¯·æ±‚æ˜¯å¤šå°‘å¥½ç”¨ï¼Œå‘é€è¯·æ±‚</p>
<p>Requests ç®€ä¾¿çš„ API æ„å‘³ç€æ‰€æœ‰ HTTP è¯·æ±‚ç±»å‹éƒ½æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è¿™æ ·å‘é€ä¸€ä¸ª HTTP POST è¯·æ±‚ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.post(<span class="string">'http://httpbin.org/post'</span>, data = &#123;<span class="string">'key'</span>:<span class="string">'value'</span>&#125;)</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨dataå¯ä»¥ä¼ é€’å­—å…¸ä½œä¸ºå‚æ•°ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä¼ é€’å…ƒç¥–</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>payload = ((<span class="string">'key1'</span>, <span class="string">'value1'</span>), (<span class="string">'key1'</span>, <span class="string">'value2'</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.post(<span class="string">'http://httpbin.org/post'</span>, data=payload)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(r.text)</div><div class="line">&#123;</div><div class="line">  ...</div><div class="line">  <span class="string">"form"</span>: &#123;</div><div class="line">    <span class="string">"key1"</span>: [</div><div class="line">      <span class="string">"value1"</span>,</div><div class="line">      <span class="string">"value2"</span></div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¼ é€’jsonæ˜¯è¿™æ ·</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> json</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">'https://api.github.com/some/endpoint'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>payload = &#123;<span class="string">'some'</span>: <span class="string">'data'</span>&#125;</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.post(url, data=json.dumps(payload))</div></pre></td></tr></table></figure>
<p>2.4.2 ç‰ˆçš„æ–°åŠ åŠŸèƒ½ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">'https://api.github.com/some/endpoint'</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>payload = &#123;<span class="string">'some'</span>: <span class="string">'data'</span>&#125;</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.post(url, json=payload)</div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ ä¸éœ€è¦å¯¹å‚æ•°åšä»€ä¹ˆå˜åŒ–ï¼Œåªéœ€è¦å…³æ³¨ä½¿ç”¨data=è¿˜æ˜¯json=ï¼Œå…¶ä½™çš„requestséƒ½å·²ç»å¸®ä½ åšå¥½äº†ã€‚</p>
<h1 id="ä½¿ç”¨scrapyå‘é€postè¯·æ±‚"><a href="#ä½¿ç”¨scrapyå‘é€postè¯·æ±‚" class="headerlink" title="ä½¿ç”¨scrapyå‘é€postè¯·æ±‚"></a>ä½¿ç”¨scrapyå‘é€postè¯·æ±‚</h1><p>å®˜æ–¹æ¨èçš„ Using FormRequest to send data via HTTP POST</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> [FormRequest(url=<span class="string">"http://www.example.com/post/action"</span>,</div><div class="line">                    formdata=&#123;<span class="string">'name'</span>: <span class="string">'John Doe'</span>, <span class="string">'age'</span>: <span class="string">'27'</span>&#125;,</div><div class="line">                    callback=self.after_post)]</div></pre></td></tr></table></figure>
<p>è¿™é‡Œä½¿ç”¨çš„æ˜¯FormRequestï¼Œå¹¶ä½¿ç”¨formdataä¼ é€’å‚æ•°ï¼Œçœ‹åˆ°è¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªå­—å…¸ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¶…çº§å‘çš„ä¸€ç‚¹æ¥äº†ï¼Œä»Šå¤©æŠ˜è…¾äº†ä¸€ä¸‹åˆï¼Œä½¿ç”¨è¿™ç§æ–¹æ³•å‘é€è¯·æ±‚ï¼Œæ€ä¹ˆå‘éƒ½ä¼šå‡ºé—®é¢˜ï¼Œè¿”å›çš„æ•°æ®ä¸€ç›´éƒ½ä¸æ˜¯æˆ‘æƒ³è¦çš„</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> scrapy.FormRequest(url, formdata=(payload))</div></pre></td></tr></table></figure>
<p>åœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…ï¼Œæœ€ç»ˆæ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œä½¿ç”¨scrapy.Requestå‘é€è¯·æ±‚ï¼Œå°±å¯ä»¥æ­£å¸¸çš„è·å–æ•°æ®ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> scrapy.Request(url, body=json.dumps(payload), method=<span class="string">'POST'</span>, headers=&#123;<span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>&#125;,)</div></pre></td></tr></table></figure>
<p>å‚è€ƒï¼šSend Post Request in Scrapy</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">my_data = &#123;<span class="string">'field1'</span>: <span class="string">'value1'</span>, <span class="string">'field2'</span>: <span class="string">'value2'</span>&#125;</div><div class="line">request = scrapy.Request( url, method=<span class="string">'POST'</span>, </div><div class="line">                          body=json.dumps(my_data), </div><div class="line">                          headers=&#123;<span class="string">'Content-Type'</span>:<span class="string">'application/json'</span>&#125; )</div></pre></td></tr></table></figure>
<h1 id="FormRequest-ä¸-Request-åŒºåˆ«"><a href="#FormRequest-ä¸-Request-åŒºåˆ«" class="headerlink" title="FormRequest ä¸ Request åŒºåˆ«"></a>FormRequest ä¸ Request åŒºåˆ«</h1><p>åœ¨æ–‡æ¡£ä¸­ï¼Œå‡ ä¹çœ‹ä¸åˆ°å·®åˆ«ï¼Œ</p>
<blockquote>
<p>The FormRequest class adds a new argument to the constructor. The remaining arguments are the same as for the Request class and are not documented here.</p>
<p>Parameters:    formdata (dict or iterable of tuples) â€“ is a dictionary (or iterable of (key, value) tuples) containing HTML Form data which will be url-encoded and assigned to the body of the request.</p>
</blockquote>
<p>è¯´FormRequestæ–°å¢åŠ äº†ä¸€ä¸ªå‚æ•°formdataï¼Œæ¥å—åŒ…å«è¡¨å•æ•°æ®çš„å­—å…¸æˆ–è€…å¯è¿­ä»£çš„å…ƒç»„ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºè¯·æ±‚çš„bodyã€‚å¹¶ä¸”FormRequestæ˜¯ç»§æ‰¿Requestçš„</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FormRequest</span><span class="params">(Request)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, *args, **kwargs)</span>:</span></div><div class="line">        formdata = kwargs.pop(<span class="string">'formdata'</span>, <span class="keyword">None</span>)</div><div class="line">        <span class="keyword">if</span> formdata <span class="keyword">and</span> kwargs.get(<span class="string">'method'</span>) <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            kwargs[<span class="string">'method'</span>] = <span class="string">'POST'</span></div><div class="line"></div><div class="line">        super(FormRequest, self).__init__(*args, **kwargs)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> formdata:</div><div class="line">            items = formdata.items() <span class="keyword">if</span> isinstance(formdata, dict) <span class="keyword">else</span> formdata</div><div class="line">            querystr = _urlencode(items, self.encoding)</div><div class="line">            <span class="keyword">if</span> self.method == <span class="string">'POST'</span>:</div><div class="line">                self.headers.setdefault(<span class="string">b'Content-Type'</span>, <span class="string">b'application/x-www-form-urlencoded'</span>)</div><div class="line">                self._set_body(querystr)</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                self._set_url(self.url + (<span class="string">'&amp;'</span> <span class="keyword">if</span> <span class="string">'?'</span> <span class="keyword">in</span> self.url <span class="keyword">else</span> <span class="string">'?'</span>) + querystr)</div><div class="line">            <span class="comment">###</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_urlencode</span><span class="params">(seq, enc)</span>:</span></div><div class="line">    values = [(to_bytes(k, enc), to_bytes(v, enc))</div><div class="line">              <span class="keyword">for</span> k, vs <span class="keyword">in</span> seq</div><div class="line">              <span class="keyword">for</span> v <span class="keyword">in</span> (vs <span class="keyword">if</span> is_listlike(vs) <span class="keyword">else</span> [vs])]</div><div class="line">    <span class="keyword">return</span> urlencode(values, doseq=<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>æœ€ç»ˆæˆ‘ä»¬ä¼ é€’çš„{â€˜keyâ€™: â€˜valueâ€™, â€˜kâ€™: â€˜vâ€™}ä¼šè¢«è½¬åŒ–ä¸ºâ€™key=value&amp;k=vâ€™ å¹¶ä¸”é»˜è®¤çš„methodæ˜¯POSTï¼Œå†æ¥çœ‹çœ‹Request</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span><span class="params">(object_ref)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, url, callback=None, method=<span class="string">'GET'</span>, headers=None, body=None,</span></span></div><div class="line">                 cookies=None, meta=None, encoding=<span class="string">'utf-8'</span>, priority=<span class="number">0</span>,</div><div class="line">                 dont_filter=False, errback=None, flags=None):</div><div class="line"></div><div class="line">        self._encoding = encoding  <span class="comment"># this one has to be set first</span></div><div class="line">        self.method = str(method).upper()</div></pre></td></tr></table></figure>
<p>é»˜è®¤çš„æ–¹æ³•æ˜¯GETï¼Œå…¶å®å¹¶ä¸å½±å“ã€‚ä»ç„¶å¯ä»¥å‘é€postè¯·æ±‚ã€‚è¿™è®©æˆ‘æƒ³èµ·æ¥requestsä¸­çš„requestç”¨æ³•ï¼Œè¿™æ˜¯å®šä¹‰è¯·æ±‚çš„åŸºç¡€æ–¹æ³•ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">request</span><span class="params">(method, url, **kwargs)</span>:</span></div><div class="line">    <span class="string">"""Constructs and sends a :class:`Request &lt;Request&gt;`.</span></div><div class="line"></div><div class="line">    :param method: method for the new :class:`Request` object.</div><div class="line">    :param url: URL for the new :class:`Request` object.</div><div class="line">    :param params: (optional) Dictionary or bytes to be sent in the query string for the :class:`Request`.</div><div class="line">    :param data: (optional) Dictionary or list of tuples ``[(key, value)]`` (will be form-encoded), bytes, or file-like object to send in the body of the :class:`Request`.</div><div class="line">    :param json: (optional) json data to send in the body of the :class:`Request`.</div><div class="line">    :param headers: (optional) Dictionary of HTTP Headers to send with the :class:`Request`.</div><div class="line">    :param cookies: (optional) Dict or CookieJar object to send with the :class:`Request`.</div><div class="line">    :param files: (optional) Dictionary of ``'name': file-like-objects`` (or ``&#123;'name': file-tuple&#125;``) for multipart encoding upload.</div><div class="line">        ``file-tuple`` can be a 2-tuple ``('filename', fileobj)``, 3-tuple ``('filename', fileobj, 'content_type')``</div><div class="line">        or a 4-tuple ``('filename', fileobj, 'content_type', custom_headers)``, where ``'content-type'`` is a string</div><div class="line">        defining the content type of the given file and ``custom_headers`` a dict-like object containing additional headers</div><div class="line">        to add for the file.</div><div class="line">    :param auth: (optional) Auth tuple to enable Basic/Digest/Custom HTTP Auth.</div><div class="line">    :param timeout: (optional) How many seconds to wait for the server to send data</div><div class="line">        before giving up, as a float, or a :ref:`(connect timeout, read</div><div class="line">        timeout) &lt;timeouts&gt;` tuple.</div><div class="line">    :type timeout: float or tuple</div><div class="line">    :param allow_redirects: (optional) Boolean. Enable/disable GET/OPTIONS/POST/PUT/PATCH/DELETE/HEAD redirection. Defaults to ``True``.</div><div class="line">    :type allow_redirects: bool</div><div class="line">    :param proxies: (optional) Dictionary mapping protocol to the URL of the proxy.</div><div class="line">    :param verify: (optional) Either a boolean, in which case it controls whether we verify</div><div class="line">            the server's TLS certificate, or a string, in which case it must be a path</div><div class="line">            to a CA bundle to use. Defaults to ``True``.</div><div class="line">    :param stream: (optional) if ``False``, the response content will be immediately downloaded.</div><div class="line">    :param cert: (optional) if String, path to ssl client cert file (.pem). If Tuple, ('cert', 'key') pair.</div><div class="line">    :return: :class:`Response &lt;Response&gt;` object</div><div class="line">    :rtype: requests.Response</div><div class="line"></div><div class="line">    Usage::</div><div class="line"></div><div class="line">      &gt;&gt;&gt; import requests</div><div class="line">      &gt;&gt;&gt; req = requests.request('GET', 'http://httpbin.org/get')</div><div class="line">      &lt;Response [200]&gt;</div><div class="line">    """</div><div class="line"></div><div class="line">    <span class="comment"># By using the 'with' statement we are sure the session is closed, thus we</span></div><div class="line">    <span class="comment"># avoid leaving sockets open which can trigger a ResourceWarning in some</span></div><div class="line">    <span class="comment"># cases, and look like a memory leak in others.</span></div><div class="line">    <span class="keyword">with</span> sessions.Session() <span class="keyword">as</span> session:</div><div class="line">        <span class="keyword">return</span> session.request(method=method, url=url, **kwargs)</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://pic1.zhimg.com/v2-4a7e42516aa3fc2ad8c5532d885e3c44_1200x500.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åä¸‰ç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨scrapyå‘é€postè¯·æ±‚çš„å‘&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="scrapy" scheme="https://zhangslob.github.io/tags/scrapy/"/>
    
      <category term="post" scheme="https://zhangslob.github.io/tags/post/"/>
    
  </entry>
  
  <entry>
    <title>æ·˜å®signåŠ å¯†ç®—æ³•</title>
    <link href="https://zhangslob.github.io/2018/08/14/%E6%B7%98%E5%AE%9Dsign%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/"/>
    <id>https://zhangslob.github.io/2018/08/14/æ·˜å®signåŠ å¯†ç®—æ³•/</id>
    <published>2018-08-14T13:50:33.000Z</published>
    <updated>2018-09-03T13:56:28.816Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://pic4.zhimg.com/v2-1b87ba90b26d4a65d78146dcee21a40e_1200x500.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åäºŒç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<p>æ·˜å®signåŠ å¯†ç®—æ³•</p>
<a id="more"></a>
<h1 id="æ·˜å®signåŠ å¯†ç®—æ³•"><a href="#æ·˜å®signåŠ å¯†ç®—æ³•" class="headerlink" title="æ·˜å®signåŠ å¯†ç®—æ³•"></a>æ·˜å®signåŠ å¯†ç®—æ³•</h1><p>æ·˜å®å¯¹äºh5çš„è®¿é—®é‡‡ç”¨äº†å’Œå®¢æˆ·ç«¯ä¸åŒçš„æ–¹å¼ï¼Œç”±äºåœ¨h5çš„jsä»£ç ä¸­ä¿å­˜appsercretå…·æœ‰è¾ƒé«˜çš„é£é™©ï¼Œmtopé‡‡ç”¨äº†éšæœºåˆ†é…ä»¤ç‰Œçš„æ–¹å¼ï¼Œä¸ºæ¯ä¸ªè®¿é—®ç«¯åˆ†é…ä¸€ä¸ªtokenï¼Œä¿å­˜åœ¨ç”¨æˆ·çš„cookieä¸­ï¼Œé€šè¿‡cookieå¸¦å›æœåŠ¡ç«¯åˆ†é…çš„token, å®¢æˆ·ç«¯åˆ©ç”¨åˆ†é…çš„tokenå¯¹è¯·æ±‚çš„URLå‚æ•°ç”Ÿæˆæ‘˜è¦å€¼sign,</p>
<p>MTOPåˆ©ç”¨è¿™ä¸ªæ‘˜ç”¨å€¼å’Œcookieä¸­çš„tokenæ¥é˜²æ­¢URLç¯¡æ”¹ã€‚</p>
<h1 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h1><ol>
<li>å½“æœ¬åœ°cookieä¸­çš„tokenä¸ºç©ºæ—¶ï¼ˆé€šå¸¸æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®ï¼‰ï¼Œmtopä¼šæ”¶åˆ°â€FAIL_SYS_TOKEN_EXOIRED:: ä»¤ç‰Œè¿‡æœŸâ€œè¿™ä¸ªé”™è¯¯åº”ç­”ï¼ŒåŒæ—¶mtopä¼šç”Ÿæˆtokenå†™å…¥cookieä¸­ï¼ˆresponse.cookiesï¼‰ã€‚</li>
<li>ç¬¬äºŒæ¬¡è¯·æ±‚æ—¶ï¼Œjsé€šè¿‡è¯»å–cookieä¸­çš„tokenå€¼ï¼ŒæŒ‰ç…§çº¦å®šçš„ç®—æ³•ç”Ÿæˆsign, signåœ¨mtopçš„è¯·æ±‚ä¸­å¸¦ä¸Šï¼Œmtopé€šè¿‡cookieä¸­å’Œtokenç”¨åŒæ ·çš„æ–¹å¼è®¡ç®—å‡ºsign,ä¸è¯·æ±‚çš„signè¿›è¡Œæ¯”è¾ƒï¼Œæ£€æŸ¥é€šè¿‡å°†è¿”å›apiçš„åº”ç­”ï¼Œå¤±è´¥æç¤ºâ€œFAIL_SYS_ILLEGAL_ACCESS:: éæ³•è¯·æ±‚â€</li>
<li>cookieä¸­çš„tokenæ˜¯æœ‰æ—¶æ•ˆæ€§çš„ï¼Œé‡åˆ°tokenå¤±æ•ˆæ—¶ï¼Œå°†æ”¶åˆ°åº”ç­”â€FAIL_SYS_TOKEN_EXOIRED:: ä»¤ç‰Œè¿‡æœŸâ€, åŒæ—¶ä¼šå†™å…¥æ–°çš„token,jsåˆ©ç”¨æ–°çš„tokené‡æ–°è®¡ç®—signå¹¶é‡å‘è¯·æ±‚ã€‚</li>
</ol>
<p>å…³äºcookieä¸­çš„tokençš„è‡ªæˆ‘æ£€æŸ¥ï¼Œç”±äºtokenåœ¨cookieä¸­æ˜¯æ˜æ–‡çš„ï¼Œå¯èƒ½ä¼šè¢«ä»¿å†’ï¼Œåœ¨è¾“å‡ºçš„cookieä¸­åŒ…å«ä¸€ä¸ªç”¨éå¯¹ç§°å¯†é’¥çš„å…¬é’¥åŠ å¯†åçš„token, MTOPåœ¨æ¯æ¬¡è¯·æ±‚æ—¶ä¼šå…ˆæ£€æŸ¥cookieä¸­çš„tokenæ˜¯å¦æ˜¯ç”±æœåŠ¡ç«¯åˆ†é…å‡ºå»çš„ï¼ˆåˆ©ç”¨åŠ å¯†åçš„tokenå’Œç§é’¥è¿˜åŸtokenï¼Œä¸å›ä¼ çš„æ˜æ–‡tokenæ¯”è¾ƒï¼‰</p>
<h1 id="sign-ç”Ÿæˆ"><a href="#sign-ç”Ÿæˆ" class="headerlink" title="sign ç”Ÿæˆ"></a>sign ç”Ÿæˆ</h1><p>å…³äºsignçš„ç”Ÿæˆå…¬å¼ï¼š</p>
<p><code>md5Hex(token&amp;t&amp;appKey&amp;data)</code></p>
<p>å¦‚ï¼šmd5Hex(â€œ645d1f414d4914297dfaab40f3f76016 &amp;1234&amp;4272&amp;{â€œitemNumIdâ€:â€1500011132496â€}â€)</p>
<p>sign=d2b2f818a03496b296b899a230c03abd</p>
<h1 id="token"><a href="#token" class="headerlink" title="token"></a>token</h1><p>å…³äºcookieçš„æœ‰æ•ˆæ—¶é•¿ï¼Œcookieçš„æœ‰æ•ˆæ—¶é•¿ä¸º7å¤©ï¼Œä½†æ˜¯tokençš„æœ‰æ•ˆæ—¶é•¿ç›®å‰ä¸º60åˆ†é’Ÿ<br>_m_h5_tk: æ ¼å¼ä¸º æ˜æ–‡token_expireTime, ä»response.cookieså¤„è·å–ï¼Œå¦‚ï¼š <code>2fcd2baa62fc60f73c0487a9f8a0a9d1_1362559577301</code></p>
<p>tokenå°±æ˜¯2fcd2baa62fc60f73c0487a9f8a0a9d1</p>
<p>t<br>å¾ˆç®€å•ï¼Œå³æ—¶é—´æˆ³ int(time.time()*1000)</p>
<p>appKey<br>ä¸€èˆ¬æ˜¯å›ºå®šæ•°å€¼</p>
<p>data<br>ä¸€èˆ¬æ˜¯æäº¤çš„å‚æ•°</p>
<p>example<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">headers = &#123;</div><div class="line">    <span class="string">'accept-encoding'</span>: <span class="string">'gzip, deflate, br'</span>,</div><div class="line">    <span class="string">'accept-language'</span>: <span class="string">'zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7'</span>,</div><div class="line">    <span class="string">'user-agent'</span>: <span class="string">'Mozilla/5.0 (iPhone; CPU iPhone OS 10_3 like Mac OS X) AppleWebKit/602.1.50 (KHTML, like Gecko) CriOS/56.0.2924.75 Mobile/14E5239e Safari/602.1'</span>,</div><div class="line">    <span class="string">'accept'</span>: <span class="string">'*/*'</span>,</div><div class="line">    <span class="string">'referer'</span>: <span class="string">'https://h5.m.taobao.com/?sprefer=sypc00'</span>,</div><div class="line">    <span class="string">'authority'</span>: <span class="string">'h5api.m.taobao.com'</span>,</div><div class="line">    <span class="string">'cookie'</span>: <span class="string">'t=cff5759b3198bafb639030a7296d6bff; cna=OOz3EwDBHU8CAS9eVNkZGaaY; thw=cn; _m_h5_tk=4dab06478749cf71bcb31296c169e46f_1534260967070; _m_h5_tk_enc=eb5abdfc8a3e52d0f7982d2ab34eb471; isg=BH9_A4W7GMQHLxzbVJKP32QcDlqleywDp44sWxFMGy51IJ-iGTRjVv02ZvbeeKt-'</span>,</div><div class="line">&#125;</div><div class="line"></div><div class="line">params = (</div><div class="line">    (<span class="string">'jsv'</span>, <span class="string">'2.4.11'</span>),</div><div class="line">    (<span class="string">'appKey'</span>, <span class="string">'12574478'</span>),</div><div class="line">    (<span class="string">'t'</span>, <span class="string">'1534253767277'</span>),</div><div class="line">    (<span class="string">'sign'</span>, <span class="string">'12c6fac6a03cf98c8f912413feeaeaaf'</span>),</div><div class="line">    (<span class="string">'api'</span>, <span class="string">'mtop.taobao.wireless.home.load'</span>),</div><div class="line">    (<span class="string">'v'</span>, <span class="string">'1.0'</span>),</div><div class="line">    (<span class="string">'type'</span>, <span class="string">'jsonp'</span>),</div><div class="line">    (<span class="string">'dataType'</span>, <span class="string">'jsonp'</span>),</div><div class="line">    (<span class="string">'callback'</span>, <span class="string">'mtopjsonp2'</span>),</div><div class="line">    (<span class="string">'data'</span>, <span class="string">'&#123;"containerId":"main","ext":"&#123;\\"h5_platform\\":\\"h5\\",\\"h5_ttid\\":\\"60000@taobao_h5_1.0.0\\"&#125;"&#125;'</span>),</div><div class="line">)</div><div class="line"></div><div class="line">response = requests.get(<span class="string">'https://h5api.m.taobao.com/h5/mtop.taobao.wireless.home.load/1.0/'</span>, headers=headers, params=params)</div></pre></td></tr></table></figure></p>
<h1 id="å¦‚ä½•å¯»æ‰¾"><a href="#å¦‚ä½•å¯»æ‰¾" class="headerlink" title="å¦‚ä½•å¯»æ‰¾"></a>å¦‚ä½•å¯»æ‰¾</h1><p>çœ‹ä¸‹é¢è¿™æ®µjs</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"># https://g.alicdn.com/hollywood/hollywood-lib/2.0.2/mtop.js</div><div class="line"></div><div class="line">if (d.H5Request === !0) &#123;</div><div class="line">    var f = "//" + (d.prefix ? d.prefix + "." : "") + (d.subDomain ? d.subDomain + "." : "") + d.mainDomain + "/h5/" + c.api.toLowerCase() + "/" + c.v.toLowerCase() + "/"</div><div class="line">      , g = c.appKey || ("waptest" === d.subDomain ? "4272" : "12574478")</div><div class="line">      , i = (new Date).getTime()</div><div class="line">      , j = h(d.token + "&amp;" + i + "&amp;" + g + "&amp;" + c.data)</div><div class="line">      , k = &#123;</div><div class="line">        jsv: w,</div><div class="line">        appKey: g,</div><div class="line">        t: i,</div><div class="line">        sign: j</div><div class="line">    &#125;</div><div class="line">      , l = &#123;</div><div class="line">        data: c.data,</div><div class="line">        ua: c.ua</div><div class="line">    &#125;;</div></pre></td></tr></table></figure>
<p>ä½ å¯èƒ½ä¼šé—®ï¼Œå¦‚ä½•å¯»æ‰¾ï¼Œç­”æ¡ˆæ˜¯jsæ–­ç‚¹ï¼Œä¸€æ­¥æ­¥è°ƒè¯•ã€‚</p>
<p>æœ‰å…´è¶£çš„å¯ä»¥æŒç»­å…³æ³¨ï¼Œä»¥åä¼šæ·±å…¥ã€‚</p>
<p>å¥½ä¹…éƒ½æ²¡æ³•ä¸œè¥¿äº†ï¼Œä¸»è¦æ˜¯æœ€è¿‘å¤ªå¿™ï¼ŒåŠ ç­æ¯”è¾ƒå¤šï¼›è‡ªå·±ä¹Ÿå˜æ‡’äº†ï¼Œä¹Ÿåœ¨å­¦ä¸€äº›æ–°ä¸œè¥¿ï¼Œå°±ä¸çŸ¥é“å†™ä»€ä¹ˆå¥½ï¼Œä»¥åè¿˜æ˜¯å‹¤å¿«ç‚¹å§ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-1b87ba90b26d4a65d78146dcee21a40e_1200x500.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åäºŒç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ·˜å®signåŠ å¯†ç®—æ³•&lt;/p&gt;
    
    </summary>
    
      <category term="åŠ å¯†ç®—æ³•" scheme="https://zhangslob.github.io/categories/%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="åŠ å¯†" scheme="https://zhangslob.github.io/tags/%E5%8A%A0%E5%AF%86/"/>
    
      <category term="æ·˜å®" scheme="https://zhangslob.github.io/tags/%E6%B7%98%E5%AE%9D/"/>
    
  </entry>
  
  <entry>
    <title>Pythonå¤šçº¿ç¨‹ï¼ˆä¸€ï¼‰</title>
    <link href="https://zhangslob.github.io/2018/07/28/Python%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <id>https://zhangslob.github.io/2018/07/28/Pythonå¤šçº¿ç¨‹ï¼ˆä¸€ï¼‰/</id>
    <published>2018-07-28T07:01:34.000Z</published>
    <updated>2018-07-28T08:13:29.170Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://www.cn314.com/d/file/xinpin/452214b5930752f61039756c8dc70d67.jpg" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åä¸€ç¯‡åŸåˆ›æ–‡ç« </div></pre></td></tr></table></figure>
<p>è®°å½•è‡ªå·±å¯¹å¤šçº¿ç¨‹çš„ç†è§£  (à¹‘â€¢ . â€¢à¹‘)</p>
<a id="more"></a>
<h1 id="çº¿ç¨‹ä¸å½±åˆ†èº«"><a href="#çº¿ç¨‹ä¸å½±åˆ†èº«" class="headerlink" title="çº¿ç¨‹ä¸å½±åˆ†èº«"></a>çº¿ç¨‹ä¸å½±åˆ†èº«</h1><p>å¤šçº¿ç¨‹å°±æ˜¯é¸£äººçš„<code>å½±åˆ†èº«ä¹‹æœ¯</code>ï¼Œå¯èƒ½ä¸å¤§æ°å½“ï¼Œä½†æ˜¯éå¸¸å®¹æ˜“ç†è§£ã€‚</p>
<p><img src="https://cf-darren0322.zi.org.tw/wp-content/uploads/2017/09/1504614882-afaa0c0f0d32fd75d061c2aeff07b38f.jpg" alt=""></p>
<p>å¹³æ—¶ä¸€ä¸ªé¸£äººä¼šä¸€ä¸ªäººï¼Œä½†æ˜¯é‡åˆ°å¼ºæ•Œæ—¶ï¼Œä»–ä¼šä½¿ç”¨<code>å½±åˆ†èº«ä¹‹æœ¯</code>ï¼Œå¬å”¤è‡ªå·±çš„å…„å¼Ÿæ¥å¸®åŠ©ä»–ä¸€èµ·æ¥æˆ˜æ–—ã€‚è¿™æ ·ï¼Œä»–å°±ä»ä¸€ä¸ªäººæˆ˜æ–—å˜æˆå¤šä¸ªäººæˆ˜æ–—ã€‚</p>
<p>å¤šçº¿ç¨‹ä¹Ÿæ˜¯è¿™æ ·ï¼Œå¹³æ—¶ä¸€ä¸ªçº¿ç¨‹å»åšæŸä»¶äº‹ï¼Œå½“ä½¿ç”¨å¤šçº¿ç¨‹åï¼Œå°±ä¼šæœ‰å¾ˆå¤šä¸ªçº¿ç¨‹æŒ‰ç…§å‘½ä»¤å»åšäº‹ï¼Œå°±åƒå½±åˆ†èº«ä¸€æ ·ã€‚</p>
<h1 id="Pythonä½¿ç”¨"><a href="#Pythonä½¿ç”¨" class="headerlink" title="Pythonä½¿ç”¨"></a>Pythonä½¿ç”¨</h1><p>é¸£äººå’Œä½¿ç”¨éœ€è¦å…ˆç»“å°</p>
<p><img src="http://i0.qhmsg.com/t01ccd9cfd17482901d.jpg" alt=""></p>
<p>Python ä¸­éœ€è¦å…ˆè°ƒç”¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> threading</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">shadow</span><span class="params">(num)</span>:</span></div><div class="line">    print(<span class="string">'äº§ç”Ÿäº†ç¬¬&#123;&#125;ä¸ªåˆ†èº«...'</span>.format(num))</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>):</div><div class="line">    t = threading.Thread(target=shadow, args=(i,))</div><div class="line">    t.start()</div><div class="line">    t.join()</div></pre></td></tr></table></figure>
<p>Output</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">äº§ç”Ÿäº†ç¬¬1ä¸ªåˆ†èº«...</div><div class="line">äº§ç”Ÿäº†ç¬¬2ä¸ªåˆ†èº«...</div><div class="line">äº§ç”Ÿäº†ç¬¬3ä¸ªåˆ†èº«...</div><div class="line">äº§ç”Ÿäº†ç¬¬4ä¸ªåˆ†èº«...</div><div class="line">äº§ç”Ÿäº†ç¬¬5ä¸ªåˆ†èº«...</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡ºç”¨æ³•éå¸¸ç®€å•ï¼Œåªéœ€è¦å…ˆå¯¼å…¥<code>threading</code>æ¨¡å—ï¼Œç„¶åå®ä¾‹åŒ–ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œæ³¨æ„<code>argsæ˜¯</code>å…ƒç¥–</p>
<p><code>t = threading.Thread(target=shadow, args=(i,))</code></p>
<p>çº¿ç¨‹è¢«åˆ›å»ºä¹‹åå¹¶ä¸ä¼šé©¬ä¸Šè¿è¡Œï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨ <code>start()</code> ï¼Œ <code>join()</code> è®©è°ƒç”¨å®ƒçš„çº¿ç¨‹ä¸€ç›´ç­‰å¾…ç›´åˆ°æ‰§è¡Œç»“æŸï¼š </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">t.start()</div><div class="line">t.join()</div></pre></td></tr></table></figure>
<h1 id="æŸ¥çœ‹çº¿ç¨‹åå­—"><a href="#æŸ¥çœ‹çº¿ç¨‹åå­—" class="headerlink" title="æŸ¥çœ‹çº¿ç¨‹åå­—"></a>æŸ¥çœ‹çº¿ç¨‹åå­—</h1><p>ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªçŸ¥é“äº§ç”Ÿäº†å¤šä¸ªçº¿ç¨‹ï¼Œä½†è¿˜æ˜¯å¹¶ä¸çŸ¥é“å…·ä½“æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹å‡ºé”™äº†ï¼Œæˆ‘ä»¬æ²¡æ³•å»è¿½è¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»™çº¿ç¨‹åŠ ä¸Šåå­—ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> threading</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">shadow</span><span class="params">(num)</span>:</span></div><div class="line">    print(<span class="string">'&#123;&#125;äº§ç”Ÿäº†ç¬¬&#123;&#125;ä¸ªåˆ†èº«...'</span>.format(threading.currentThread().getName(), num))</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>):</div><div class="line">    t = threading.Thread(target=shadow, args=(i,), name=<span class="string">'ç¬¬&#123;&#125;ä¸ªé¸£äºº'</span>.format(i))</div><div class="line">    t.start()</div><div class="line">    t.join()</div></pre></td></tr></table></figure>
<p>Out:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ç¬¬1ä¸ªé¸£äººäº§ç”Ÿäº†ç¬¬1ä¸ªåˆ†èº«...</div><div class="line">ç¬¬2ä¸ªé¸£äººäº§ç”Ÿäº†ç¬¬2ä¸ªåˆ†èº«...</div><div class="line">ç¬¬3ä¸ªé¸£äººäº§ç”Ÿäº†ç¬¬3ä¸ªåˆ†èº«...</div><div class="line">ç¬¬4ä¸ªé¸£äººäº§ç”Ÿäº†ç¬¬4ä¸ªåˆ†èº«...</div><div class="line">ç¬¬5ä¸ªé¸£äººäº§ç”Ÿäº†ç¬¬5ä¸ªåˆ†èº«...</div></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œä½ å¯ä»¥è¿™æ ·</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> threading</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">shadow</span><span class="params">(num)</span>:</span></div><div class="line">    print(<span class="string">'&#123;&#125;äº§ç”Ÿäº†ç¬¬&#123;&#125;ä¸ªåˆ†èº«...'</span>.format(threading.currentThread().getName(), num))</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>):</div><div class="line">    t = threading.Thread(target=shadow, args=(i,))</div><div class="line">    t.start()</div><div class="line">    t.join()</div><div class="line"></div><div class="line">print(threading.currentThread().getName())</div></pre></td></tr></table></figure>
<p>Out</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Thread-1äº§ç”Ÿäº†ç¬¬1ä¸ªåˆ†èº«...</div><div class="line">Thread-2äº§ç”Ÿäº†ç¬¬2ä¸ªåˆ†èº«...</div><div class="line">Thread-3äº§ç”Ÿäº†ç¬¬3ä¸ªåˆ†èº«...</div><div class="line">Thread-4äº§ç”Ÿäº†ç¬¬4ä¸ªåˆ†èº«...</div><div class="line">Thread-5äº§ç”Ÿäº†ç¬¬5ä¸ªåˆ†èº«...</div><div class="line">MainThread</div></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥çœ‹åˆ°åœ¨æ‰€æœ‰åˆ›å»ºçš„çº¿ç¨‹ç»“æŸåï¼Œæˆ‘ä»¬æ‰“å°å½“å‰çº¿ç¨‹åå­—ï¼Œå°±æ˜¯ä¸»çº¿ç¨‹<code>MainThread</code></p>
<h1 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨join"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨join" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨join"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨join</h1><p>åˆšå¼€å§‹å­¦å¤šçº¿ç¨‹æ—¶ï¼Œæœ‰ä¸ªé—®é¢˜å›°æ‰°äº†æˆ‘å¾ˆä¹…ï¼Œå°±æ˜¯ä»€ä¹ˆæ—¶å€™ä½¿ç”¨<code>join()</code></p>
<p>ç¼•ä¸€ç¼•æ­¥éª¤ï¼š</p>
<ol>
<li>ä¸»çº¿ç¨‹ä¸­åˆ›å»ºå­çº¿ç¨‹t</li>
<li>å¼€å§‹çº¿ç¨‹<code>t.star()</code></li>
<li>è°ƒç”¨<code>t.join()</code></li>
<li>é˜»å¡ï¼šç­‰å¾…å­çº¿ç¨‹tç»“æŸåï¼Œå†æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»»åŠ¡</li>
</ol>
<p>ä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨äº†<code>join()</code>åä¼šé˜»å¡å½“å‰çš„çº¿ç¨‹ï¼Œåªæœ‰è¿™ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæ¥ç€èµ°ã€‚è¦æ˜¯ä¸€ç›´ä¸ç»“æŸå‘¢ï¼Ÿä½ å¯ä»¥åŠ ä¸Šè¶…æ—¶æ—¶é—´ï¼Œå¦‚<code>t.join(timeout=10)</code></p>
<h1 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h1><p>é¸£äººä½¿ç”¨å½±åˆ†èº«åï¼Œäº§ç”Ÿäº†Aã€Bã€Cä¸‰ä¸ªå°é¸£äººï¼Œé¸£äººå¯ä»¥ä½¿ç”¨<code>join()</code>æ–¹æ³•ï¼Œè®©Båœ¨Aè€—å°½æŸ¥å…‹æ‹‰ä¹‹åå†è¿›è¡Œæ”»å‡»ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨<code>join()</code>ï¼Œé‚£ä¹ˆå°±ä¼šæ˜¯è¿™æ ·çš„åœºæ™¯ï¼Œå¤§å®¶ä¸€èµ·ä¸Š</p>
<p><img src="https://image.ibb.co/b2AhW8/u_2086124472_3070676486_fm_173_s_C0983_F9_F4_C024_EDA8415_FC6803003079_w_500_h_314_img.jpg" alt=""></p>
<p>è¿™ä¸ªæ—¶å€™å¦‚æœé¸£äººå‘½ä»¤Aã€BåŒæ—¶å»å†™å®¶åº­ä½œä¸šï¼Œé‚£ä¹ˆå¯èƒ½ä¼šäº§ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼ŸAå…ˆå†™è¿˜æ˜¯Bå…ˆå†™ï¼Œå¤§å®¶å¯ä»¥æƒ³æƒ³ã€‚</p>
<p>ä¸‹ä¸€æœŸä¼šè¯´è¯´ <strong>é” </strong></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://www.cn314.com/d/file/xinpin/452214b5930752f61039756c8dc70d67.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åä¸€ç¯‡åŸåˆ›æ–‡ç« &lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è®°å½•è‡ªå·±å¯¹å¤šçº¿ç¨‹çš„ç†è§£  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
    
    </summary>
    
      <category term="å¤šçº¿ç¨‹" scheme="https://zhangslob.github.io/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
    
      <category term="å¤šçº¿ç¨‹" scheme="https://zhangslob.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºä»€ä¹ˆSeleniumç‚¹ä¸åˆ°å…ƒç´ </title>
    <link href="https://zhangslob.github.io/2018/07/24/%E4%B8%BA%E4%BB%80%E4%B9%88Selenium%E7%82%B9%E4%B8%8D%E5%88%B0%E5%85%83%E7%B4%A0/"/>
    <id>https://zhangslob.github.io/2018/07/24/ä¸ºä»€ä¹ˆSeleniumç‚¹ä¸åˆ°å…ƒç´ /</id>
    <published>2018-07-24T14:35:10.000Z</published>
    <updated>2018-07-24T15:28:58.537Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://i.imgur.com/VfFKTnl.jpg" alt=""></p>
<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>æ˜æ˜å¯ä»¥æ˜¾ç¤ºï¼Œä¸ºä»€ä¹ˆå°±æ˜¯ç‚¹ä¸åˆ°å‘¢  (à¹‘â€¢ . â€¢à¹‘)</p>
<a id="more"></a>
<p>æœ€è¿‘åšäº†è®¸å¤šç™»é™†é¡¹ç›®ï¼Œæˆ‘ä¼šä¼˜å…ˆé€‰æ‹©ä½¿ç”¨requestsæ¥æ¨¡æ‹Ÿè¯·æ±‚ï¼Œä½†æ˜¯æœ‰äº›å‚æ•°å®åœ¨æ˜¯å¾ˆéš¾è·å–ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä¼šä½¿ç”¨Seleniumï¼Œä¹Ÿè¿˜æ˜¯é‡åˆ°äº†å„ç§å‘ï¼Œä¹Ÿç®—æ˜¯è§è¯†åˆ°äº†å¾ˆå¤šçš„éªŒè¯æªæ–½ã€‚</p>
<p>ä»Šå¤©è¯´è¯´å¦‚ä½•è§£å†³seleniumç‚¹é€‰ä¸åˆ°æ•°æ®çš„é—®é¢˜ã€‚</p>
<h1 id="ç­‰å¾…"><a href="#ç­‰å¾…" class="headerlink" title="ç­‰å¾…"></a>ç­‰å¾…</h1><p>è¿™è¿˜æ˜¯æœ€å¸¸è§çš„ä¸€ç§æƒ…å†µï¼Œæ¨èæœ€å¤šçš„æ˜¯ä½¿ç”¨æ˜¾ç¤ºç­‰å¾…ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</div><div class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</div><div class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</div><div class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</div><div class="line"></div><div class="line">driver = webdriver.Firefox()</div><div class="line">driver.get(<span class="string">"http://somedomain/url_that_delay_loading"</span>)</div><div class="line"><span class="keyword">try</span>:</div><div class="line">    element = WebDriverWait(driver,<span class="number">10</span>).until(</div><div class="line">        EC.presence_of_element_located((By.ID,<span class="string">"myDynamicElement"</span>))</div><div class="line">    )</div><div class="line"><span class="keyword">finally</span>:</div><div class="line">    driver.quit()</div></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¼šç­‰å¾…10ç§’ï¼Œå¦‚æœ10ç§’å†…æ‰¾åˆ°å…ƒç´ åˆ™ç«‹å³è¿”å›ï¼Œå¦åˆ™ä¼šæŠ›å‡ºTimeoutExceptionå¼‚å¸¸ã€‚</p>
<p>ä½†æ˜¯æˆ‘æ¯”è¾ƒæ‡’ï¼Œå› ä¸º<code>time.sleep()</code>å¯ä»¥è¾¾åˆ°åŒæ ·æ•ˆæœã€‚</p>
<h1 id="é¼ æ ‡äº‹ä»¶"><a href="#é¼ æ ‡äº‹ä»¶" class="headerlink" title="é¼ æ ‡äº‹ä»¶"></a>é¼ æ ‡äº‹ä»¶</h1><p>å®˜æ–¹æŠŠå®ƒå«åšâ€œè¡Œä¸ºé“¾â€ã€‚ActionChainså¯ä»¥å®Œæˆç®€å•çš„äº¤äº’è¡Œä¸ºï¼Œä¾‹å¦‚é¼ æ ‡ç§»åŠ¨ï¼Œé¼ æ ‡ç‚¹å‡»äº‹ä»¶ï¼Œé”®ç›˜è¾“å…¥ï¼Œä»¥åŠå†…å®¹èœå•äº¤äº’ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">click(on_element=None) â€”â€”å•å‡»é¼ æ ‡å·¦é”®</div><div class="line"></div><div class="line">click_and_hold(on_element=None) â€”â€”ç‚¹å‡»é¼ æ ‡å·¦é”®ï¼Œä¸æ¾å¼€</div><div class="line"></div><div class="line">context_click(on_element=None) â€”â€”ç‚¹å‡»é¼ æ ‡å³é”®</div><div class="line"></div><div class="line">double_click(on_element=None) â€”â€”åŒå‡»é¼ æ ‡å·¦é”®</div><div class="line"></div><div class="line">drag_and_drop(<span class="built_in">source</span>, target) â€”â€”æ‹–æ‹½åˆ°æŸä¸ªå…ƒç´ ç„¶åæ¾å¼€</div><div class="line"></div><div class="line">drag_and_drop_by_offset(<span class="built_in">source</span>, xoffset, yoffset) â€”â€”æ‹–æ‹½åˆ°æŸä¸ªåæ ‡ç„¶åæ¾å¼€</div><div class="line"></div><div class="line">key_down(value, element=None) â€”â€”æŒ‰ä¸‹æŸä¸ªé”®ç›˜ä¸Šçš„é”®</div><div class="line"></div><div class="line">key_up(value, element=None) â€”â€”æ¾å¼€æŸä¸ªé”®</div><div class="line"></div><div class="line">move_by_offset(xoffset, yoffset) â€”â€”é¼ æ ‡ä»å½“å‰ä½ç½®ç§»åŠ¨åˆ°æŸä¸ªåæ ‡</div><div class="line"></div><div class="line">move_to_element(to_element) â€”â€”é¼ æ ‡ç§»åŠ¨åˆ°æŸä¸ªå…ƒç´ </div><div class="line"></div><div class="line">move_to_element_with_offset(to_element, xoffset, yoffset) â€”â€”ç§»åŠ¨åˆ°è·æŸä¸ªå…ƒç´ ï¼ˆå·¦ä¸Šè§’åæ ‡ï¼‰å¤šå°‘è·ç¦»çš„ä½ç½®</div><div class="line"></div><div class="line">perform() â€”â€”æ‰§è¡Œé“¾ä¸­çš„æ‰€æœ‰åŠ¨ä½œ</div><div class="line"></div><div class="line">release(on_element=None) â€”â€”åœ¨æŸä¸ªå…ƒç´ ä½ç½®æ¾å¼€é¼ æ ‡å·¦é”®</div><div class="line"></div><div class="line">send_keys(*keys_to_send) â€”â€”å‘é€æŸä¸ªé”®åˆ°å½“å‰ç„¦ç‚¹çš„å…ƒç´ </div><div class="line"></div><div class="line">send_keys_to_element(element, *keys_to_send) â€”â€”å‘é€æŸä¸ªé”®åˆ°æŒ‡å®šå…ƒç´ </div></pre></td></tr></table></figure>
<p>æ·±å…¥äº†è§£å¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/huilan_same/article/details/52305176" target="_blank" rel="external">https://blog.csdn.net/huilan_same/article/details/52305176</a></p>
<p><code>move_to_element_with_offset</code>å’Œ<code>click_and_hold</code>ä¼šç»å¸¸ç”¨åˆ°ç ´è§£éªŒè¯ç ä¸­ã€‚</p>
<h1 id="è§¦æ‘¸æ“ä½œ-TouchAction"><a href="#è§¦æ‘¸æ“ä½œ-TouchAction" class="headerlink" title="è§¦æ‘¸æ“ä½œ (TouchAction)"></a>è§¦æ‘¸æ“ä½œ (TouchAction)</h1><p><strong>è¯¥äº‹ä»¶ä»…ä»…é’ˆå¯¹ç§»åŠ¨ç«¯ã€è§¦å±ç‰ˆ</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">flick_element(on_element, xoffset, yoffset, speed) <span class="comment"># ä»¥å…ƒç´ ä¸ºèµ·ç‚¹ä»¥ä¸€å®šé€Ÿåº¦å‘ä¸‹æ»‘åŠ¨</span></div><div class="line">scroll_from_element(on_element xoffset yoffset) <span class="comment">#ä»¥å…ƒç´ ä¸ºèµ·ç‚¹å‘ä¸‹æ»‘åŠ¨</span></div><div class="line">double_tap(on_element)                                     <span class="comment">#åŒå‡»   </span></div><div class="line">flick_element(on_element, xoffset, yoffset, speed)         <span class="comment">#ä»å…ƒç´ å¼€å§‹ä»¥æŒ‡å®šçš„é€Ÿåº¦ç§»åŠ¨</span></div><div class="line">long_press(on_element)ã€€ã€€                                          <span class="comment">#é•¿æŒ‰ä¸é‡Šæ”¾</span></div><div class="line">move(xcoord, ycoord)ã€€ã€€                                              <span class="comment">#ç§»åŠ¨åˆ°æŒ‡å®šçš„ä½ç½®</span></div><div class="line">perform()ã€€ã€€                                                                  <span class="comment">#æ‰§è¡Œé“¾ä¸­çš„æ‰€æœ‰åŠ¨ä½œ</span></div><div class="line">release(xcoord, ycoord)ã€€ã€€                                           <span class="comment">#åœ¨æŸä¸ªä½ç½®æ¾å¼€æ“ä½œ</span></div><div class="line">scroll(xoffset, yoffset)                                                      <span class="comment">#æ»šåŠ¨åˆ°æŸä¸ªä½ç½®</span></div><div class="line">scroll_from_element(on_element, xoffset, yoffset)         <span class="comment">#ä»æŸå…ƒç´ å¼€å§‹æ»šåŠ¨åˆ°æŸä¸ªä½ç½®</span></div><div class="line">tap(on_element)                                                             <span class="comment">#å•å‡»</span></div><div class="line">tap_and_hold(xcoord, ycoord)                                        <span class="comment">#æŸç‚¹æŒ‰ä½</span></div></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆè¦è¯´åˆ°ç§»åŠ¨ç«¯ï¼Œåœ¨åšç™»é™†æ—¶ï¼Œç§»åŠ¨ç«¯å¾€å¾€ä¼šæ›´åŠ ç®€å•ï¼Œä½†æ˜¯è§¦å±ç‰ˆçš„ç‚¹å‡»å’ŒPCç«¯æ—¶å®Œå…¨ä¸åŒçš„ï¼Œç‚¹å‡»ä¸æŒ‰ä½æ—¶ä¸åŒçš„ã€‚</p>
<p>åœ¨æŸä¸ªé¡¹ç›®æˆ‘æ¢æˆ<code>TouchAction</code>åï¼Œç¥å¥‡çš„å‘ç°ï¼Œæ³¨å†Œä¸å†éœ€è¦å¤„ç†éªŒè¯ç äº†ï¼ŒçœŸæ˜¯å¤ªæ£’äº†ã€‚</p>
<h1 id="ä½¿ç”¨js"><a href="#ä½¿ç”¨js" class="headerlink" title="ä½¿ç”¨js"></a>ä½¿ç”¨js</h1><p>å½“ä½ ä½¿ç”¨æµè§ˆå™¨å·²ç»æ‰¾åˆ°è¯¥å…ƒç´ ï¼Œä½¿ç”¨<code>click()</code>æ–¹æ³•ä½†æ˜¯ä¸èµ·ä½œç”¨æ—¶ï¼Œè¿™ä¸ªæ—¶å€™å»ºè®®å°è¯•jsï¼Œä¾‹å¦‚åœ¨æˆ‘çš„ä¸»é¡µ <a href="https://www.zhihu.com/people/cuishite/activitiesï¼Œç‚¹å‡»" target="_blank" rel="external">https://www.zhihu.com/people/cuishite/activitiesï¼Œç‚¹å‡»</a> â€œæŸ¥çœ‹è¯¦ç»†èµ„æ–™â€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">js = <span class="string">'document.getElementsByClassName("Button ProfileHeader-expandButton Button--plain")[0].click();'</span></div><div class="line">driver.execute_script(js)</div></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥å…ˆåœ¨æ§åˆ¶å°è°ƒè¯•</p>
<p><img src="https://i.imgur.com/kyz089A.png" alt=""></p>
<p>jsé€šå¸¸å¯ä»¥è§£å†³ç»å¤§å¤šæ˜¯é—®é¢˜ï¼Œå¦‚æœè¿˜æ˜¯è§£å†³ä¸äº†ï¼Œé‚£ä½ å¯èƒ½å’Œæˆ‘é‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘åœ¨å¤„ç†æŸç§»åŠ¨ç«¯ç½‘ç«™ç™»é™†ï¼Œå¤„ç†å¦‚ä¸‹éªŒè¯ç æ—¶ï¼Œæˆ‘ä¼šä½¿ç”¨åˆ°<code>move_to_element_with_offset</code>ï¼Œè¯¥æ–¹æ³•æ˜¯â€œç§»åŠ¨åˆ°è·æŸä¸ªå…ƒç´ ï¼ˆå·¦ä¸Šè§’åæ ‡ï¼‰å¤šå°‘è·ç¦»çš„ä½ç½®â€ã€‚</p>
<p>è®¡ç®—å‡ºåæ ‡åï¼Œä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œå¦‚<code>action.move_to_element_with_offset(element, width, height).click().perform()</code>ï¼Œç„¶è€Œå®é™…ä¸Šé—®é¢˜å¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œå¤šæ¬¡ç‚¹å‡»å¤±æ•ˆã€‚å…·ä½“çš„æœ‰æ—¶é—´å†è¯´ã€‚</p>
<p><img src="https://i.imgur.com/5KXib4o.png" alt=""></p>
<h1 id="å®ç”¨æ–¹æ³•"><a href="#å®ç”¨æ–¹æ³•" class="headerlink" title="å®ç”¨æ–¹æ³•"></a>å®ç”¨æ–¹æ³•</h1><p><strong>æå–seleniumçš„cookies</strong></p>
<p>ä»‹ç»æŠŠseleniumçš„cookiesèˆ¹ä½“ç»™requestsä½¿ç”¨çš„æ–¹æ³•ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cookies = driver.get_cookies()</div><div class="line"></div><div class="line">s = requests.Session()</div><div class="line"><span class="keyword">for</span> cookie <span class="keyword">in</span> cookies:</div><div class="line">    s.cookies.set(cookie[<span class="string">'name'</span>], cookie[<span class="string">'value'</span>])</div></pre></td></tr></table></figure>
<p><a href="https://stackoverflow.com/questions/29563335/how-do-i-load-session-and-cookies-from-selenium-browser-to-requests-library-in-p" target="_blank" rel="external">How do I load session and cookies from Selenium browser to requests library in Python?</a></p>
<p><strong>å…ƒç´ æˆªå›¾æ–¹æ³•</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</div><div class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</div><div class="line"></div><div class="line">fox = webdriver.Firefox()</div><div class="line">fox.get(<span class="string">'https://stackoverflow.com/'</span>)</div><div class="line"></div><div class="line"><span class="comment"># now that we have the preliminary stuff out of the way time to get that image :D</span></div><div class="line">element = fox.find_element_by_id(<span class="string">'hlogo'</span>) <span class="comment"># find part of the page you want image of</span></div><div class="line">location = element.location</div><div class="line">size = element.size</div><div class="line">fox.save_screenshot(<span class="string">'screenshot.png'</span>) <span class="comment"># saves screenshot of entire page</span></div><div class="line">fox.quit()</div><div class="line"></div><div class="line">im = Image.open(<span class="string">'screenshot.png'</span>) <span class="comment"># uses PIL library to open image in memory</span></div><div class="line"></div><div class="line">left = location[<span class="string">'x'</span>]</div><div class="line">top = location[<span class="string">'y'</span>]</div><div class="line">right = location[<span class="string">'x'</span>] + size[<span class="string">'width'</span>]</div><div class="line">bottom = location[<span class="string">'y'</span>] + size[<span class="string">'height'</span>]</div><div class="line"></div><div class="line"></div><div class="line">im = im.crop((left, top, right, bottom)) <span class="comment"># defines crop points</span></div><div class="line">im.save(<span class="string">'screenshot.png'</span>) <span class="comment"># saves new cropped image</span></div></pre></td></tr></table></figure>
<p><a href="https://stackoverflow.com/questions/37564932/selenium-cannot-screenshot-a-web-element" target="_blank" rel="external">selenium cannot screenshot a web element</a></p>
<p>æœ€åæ¨èä¸€ä¸ªç¥å™¨ <a href="https://github.com/appium/python-client" target="_blank" rel="external">appium/python-client</a></p>
<p>è‡³äºéªŒè¯ç éƒ¨åˆ†ï¼Œç°åœ¨ä¸»è¦è¿˜æ˜¯é ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¹¶æ²¡æœ‰è‡ªå·±å°è¯•æœºå™¨å­¦ä¹ ç­‰æ–¹æ³•å¤„ç†ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://i.imgur.com/VfFKTnl.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬å…­åç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ˜æ˜å¯ä»¥æ˜¾ç¤ºï¼Œä¸ºä»€ä¹ˆå°±æ˜¯ç‚¹ä¸åˆ°å‘¢  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
    
    </summary>
    
      <category term="Selenium" scheme="https://zhangslob.github.io/categories/Selenium/"/>
    
    
      <category term="Selenium" scheme="https://zhangslob.github.io/tags/Selenium/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨Seleniumä¸Requestsæ¨¡æ‹Ÿç™»é™†</title>
    <link href="https://zhangslob.github.io/2018/07/17/%E4%BD%BF%E7%94%A8Selenium%E4%B8%8ERequests%E6%A8%A1%E6%8B%9F%E7%99%BB%E9%99%86/"/>
    <id>https://zhangslob.github.io/2018/07/17/ä½¿ç”¨Seleniumä¸Requestsæ¨¡æ‹Ÿç™»é™†/</id>
    <published>2018-07-17T13:18:35.000Z</published>
    <updated>2018-07-17T13:47:14.505Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://preview.ibb.co/cd5VUJ/20180717173128.png" alt=""></p>
<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åä¹ç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>æ¨¡æ‹Ÿç™»é™†çš„ä¸¤ç§æ–¹å¼ï¼Œä½ å–œæ¬¢å“ªç§  (à¹‘â€¢ . â€¢à¹‘)</p>
<a id="more"></a>
<p>æœ¬æœŸè®²ä¸€è®²æ¨¡æ‹Ÿç™»å½•ç›¸å…³çš„ä¸œè¥¿ï¼Œç›®æ ‡ç½‘ç«™æ˜¯<a href="https://github.com/" target="_blank" rel="external">Github</a></p>
<p><img src="https://preview.ibb.co/cd5VUJ/20180717173128.png" alt=""></p>
<h1 id="ç®€å•çš„Selnium"><a href="#ç®€å•çš„Selnium" class="headerlink" title="ç®€å•çš„Selnium"></a>ç®€å•çš„Selnium</h1><p>æƒ³è¯´è¯´ç®€å•çš„æ–¹æ³•ï¼Œä½¿ç”¨æµè§ˆå™¨ç™»å½•ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å‚»ç“œæ“ä½œäº†ã€‚</p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç™»å½•è®¾è®¡çš„å¾ˆç®€å•ï¼Œæ²¡æœ‰éªŒè¯ç ä»€ä¹ˆçš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</div><div class="line"></div><div class="line">driver = webdriver.Chrome()</div><div class="line">driver.maximize_window()</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(account, password)</span>:</span></div><div class="line">    driver.get(<span class="string">'https://github.com/login'</span>)</div><div class="line">    time.sleep(<span class="number">2</span>)</div><div class="line">    driver.find_element_by_id(<span class="string">'login_field'</span>).send_keys(account)</div><div class="line">    driver.find_element_by_id(<span class="string">'password'</span>).send_keys(password)</div><div class="line">    driver.find_element_by_xpath(<span class="string">'//input[@class="btn btn-primary btn-block"]'</span>).click()</div><div class="line">    <span class="comment"># do whatever you want</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    account, password = <span class="string">'account'</span>, <span class="string">'password'</span></div><div class="line">    login(account, password)</div></pre></td></tr></table></figure>
<h1 id="åˆ†æè¯·æ±‚ä¹‹Requests"><a href="#åˆ†æè¯·æ±‚ä¹‹Requests" class="headerlink" title="åˆ†æè¯·æ±‚ä¹‹Requests"></a>åˆ†æè¯·æ±‚ä¹‹Requests</h1><p>æ‰“å¼€F12ï¼Œä½¿ç”¨é”™è¯¯çš„è´¦å·å¯†ç ç™»å½•ï¼Œå¤åˆ¶curl</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl <span class="string">'https://github.com/session'</span> -H <span class="string">'Cookie: has_recent_activity=1; _octo=GH1.1.1477592343.1531820067; logged_in=no; _gh_sess=UEZzYnVCMVlhNkVOdE5rU1hWRFpDbmFlY0UyQ1Y2b3Z4TGw2NFlTMmJLUWk5VENVQ3Q4TWxiSWN5ckEyZXN0MUFkT29XVjQvbWJVbm9RV0JNQmc1TmU0UnBtK0taUXJpcElqUk5PNGZ5TjZOQ2ZPRVR4NU5WQXcrb2xWRnRBMnRPMkRWYzYvWmVGY0FrYU12Q3BVVTY3dXVSblliNG4rWjc2QXVwR2pjQ1pzZXM1MFk1MjU5OUw2WkFLTU1BMzJDWGlTeXliNzNaejlUaW43cWhFNzQ0MFFVVmJ1aEppbzdtQTZkRERmUm5mWExkRDlmWW5lNk9mdlFYb05MQUtubDZBbXFJWjV6eFhic3JiWlRtZ2QxZ2FqZUxnOGFheUgzaXJmc290b0Jma09pRTJZdHZySEVmdVdGZHVBU3ZTVTJRM0pESnE1N1VPRDM0ck9FZzNJZTN5VWljUktyZ3FZQU16THVBeFBXV3BNPS0tSDh4WVV6U2RSNjlBL3FNQ3VaRGxEUT09--71cf0886128d55b42c82cf6f7b76e007ebfdc77b; _ga=GA1.2.57857743.1531820085; _gat=1; tz=Asia%2FShanghai'</span> -H <span class="string">'Origin: https://github.com'</span> -H <span class="string">'Accept-Encoding: gzip, deflate, br'</span> -H <span class="string">'Accept-Language: zh-CN,zh;q=0.9,en;q=0.8'</span> -H <span class="string">'Upgrade-Insecure-Requests: 1'</span> -H <span class="string">'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36'</span> -H <span class="string">'Content-Type: application/x-www-form-urlencoded'</span> -H <span class="string">'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'</span> -H <span class="string">'Cache-Control: max-age=0'</span> -H <span class="string">'Referer: https://github.com/login'</span> -H <span class="string">'Connection: keep-alive'</span> --data <span class="string">'commit=Sign+in&amp;utf8=%E2%9C%93&amp;authenticity_token=%2BtgUHwMIxnoHOHNMqQFkLak9mJzrxt%2B4yfFiZaf66WiMB5ZyRaVXq%2BFpZsM%2BtxgaRRX6Fzfezu1IdRqy%2BTGHwg%3D%3D&amp;login=123456788%40gmail.com&amp;password=123456788'</span> --compressed</div></pre></td></tr></table></figure>
<p>è½¬ä¸ºPythonä»£ç ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">cookies = &#123;</div><div class="line">    <span class="string">'has_recent_activity'</span>: <span class="string">'1'</span>,</div><div class="line">    <span class="string">'_octo'</span>: <span class="string">'GH1.1.1477592343.1531820067'</span>,</div><div class="line">    <span class="string">'logged_in'</span>: <span class="string">'no'</span>,</div><div class="line">    <span class="string">'_gh_sess'</span>: <span class="string">'UEZzYnVCMVlhNkVOdE5rU1hWRFpDbmFlY0UyQ1Y2b3Z4TGw2NFlTMmJLUWk5VENVQ3Q4TWxiSWN5ckEyZXN0MUFkT29XVjQvbWJVbm9RV0JNQmc1TmU0UnBtK0taUXJpcElqUk5PNGZ5TjZOQ2ZPRVR4NU5WQXcrb2xWRnRBMnRPMkRWYzYvWmVGY0FrYU12Q3BVVTY3dXVSblliNG4rWjc2QXVwR2pjQ1pzZXM1MFk1MjU5OUw2WkFLTU1BMzJDWGlTeXliNzNaejlUaW43cWhFNzQ0MFFVVmJ1aEppbzdtQTZkRERmUm5mWExkRDlmWW5lNk9mdlFYb05MQUtubDZBbXFJWjV6eFhic3JiWlRtZ2QxZ2FqZUxnOGFheUgzaXJmc290b0Jma09pRTJZdHZySEVmdVdGZHVBU3ZTVTJRM0pESnE1N1VPRDM0ck9FZzNJZTN5VWljUktyZ3FZQU16THVBeFBXV3BNPS0tSDh4WVV6U2RSNjlBL3FNQ3VaRGxEUT09--71cf0886128d55b42c82cf6f7b76e007ebfdc77b'</span>,</div><div class="line">    <span class="string">'_ga'</span>: <span class="string">'GA1.2.57857743.1531820085'</span>,</div><div class="line">    <span class="string">'_gat'</span>: <span class="string">'1'</span>,</div><div class="line">    <span class="string">'tz'</span>: <span class="string">'Asia%2FShanghai'</span>,</div><div class="line">&#125;</div><div class="line"></div><div class="line">headers = &#123;</div><div class="line">    <span class="string">'Origin'</span>: <span class="string">'https://github.com'</span>,</div><div class="line">    <span class="string">'Accept-Encoding'</span>: <span class="string">'gzip, deflate, br'</span>,</div><div class="line">    <span class="string">'Accept-Language'</span>: <span class="string">'zh-CN,zh;q=0.9,en;q=0.8'</span>,</div><div class="line">    <span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span>,</div><div class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36'</span>,</div><div class="line">    <span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</div><div class="line">    <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'</span>,</div><div class="line">    <span class="string">'Cache-Control'</span>: <span class="string">'max-age=0'</span>,</div><div class="line">    <span class="string">'Referer'</span>: <span class="string">'https://github.com/login'</span>,</div><div class="line">    <span class="string">'Connection'</span>: <span class="string">'keep-alive'</span>,</div><div class="line">&#125;</div><div class="line"></div><div class="line">data = [</div><div class="line">  (<span class="string">'commit'</span>, <span class="string">'Sign in'</span>),</div><div class="line">  (<span class="string">'utf8'</span>, <span class="string">'\u2713'</span>),</div><div class="line">  (<span class="string">'authenticity_token'</span>, <span class="string">'+tgUHwMIxnoHOHNMqQFkLak9mJzrxt+4yfFiZaf66WiMB5ZyRaVXq+FpZsM+txgaRRX6Fzfezu1IdRqy+TGHwg=='</span>),</div><div class="line">  (<span class="string">'login'</span>, <span class="string">'123456788@gmail.com'</span>),</div><div class="line">  (<span class="string">'password'</span>, <span class="string">'123456788'</span>),</div><div class="line">]</div><div class="line"></div><div class="line">response = requests.post(<span class="string">'https://github.com/session'</span>, headers=headers, cookies=cookies, data=data)</div></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸¤ä¸ªåœ°æ–¹ï¼Œcookieså’Œå‚æ•°ï¼Œå…ˆæ¥çœ‹çœ‹å‚æ•°ï¼Œç¨å¾®ç‰¹åˆ«çš„å°±æ˜¯<code>authenticity_token</code>ï¼Œæ„Ÿè§‰æ˜¯éªŒè¯ã€‚<code>Ctrl+Shift+F</code>æ‰“å¼€æœç´¢ï¼Œæœ€ç»ˆåœ¨è¿”å›çš„htmlä¸­æ‰¾åˆ°</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- '"` --&gt;</span><span class="comment">&lt;!-- &lt;/textarea&gt;&lt;/xmp&gt; --&gt;</span><span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/session"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"&amp;#x2713;"</span> /&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"authenticity_token"</span> <span class="attr">value</span>=<span class="string">"CTujn/pHGMQBpEhYcJj9Mn6ChsNSkd5ul8rgNSP/6/KxdZlhS0ABKblsq1pLn6EaQvIGLMzl/IQawaDL8KFjDw=="</span> /&gt;</span>      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"auth-form-header p-0"</span>&gt;</span></div></pre></td></tr></table></figure>
<p><code>authenticity_token</code>è§£å†³äº†ï¼Œä¸‹ä¸€æ­¥æƒ³åŠæ³•è·å–cookies</p>
<p><img src="https://preview.ibb.co/iSWqwy/20180717174236.png" alt=""></p>
<p>ç»§ç»­æœç´¢<code>_gh_sess</code>ä¸<code>_octo</code>å…³é”®å­—ï¼Œçœ‹åˆ°æœ‰è¿™æ ·ä¸€æ®µjs</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> e, t = <span class="keyword">void</span> <span class="number">0</span>, r = <span class="keyword">void</span> <span class="number">0</span>, n = <span class="keyword">this</span>._getCookie(<span class="string">"_octo"</span>), a = [];</div></pre></td></tr></table></figure>
<p>çŒœæµ‹cookiesä¸æ˜¯æœ¬åœ°ç”Ÿæˆï¼ŒæŸ¥çœ‹æ‰“å¼€Githubé¦–é¡µçš„è¯·æ±‚ï¼Œæœç„¶åœ¨<code>Response Cookies</code>ä¸­æ‰¾åˆ°äº†ç›¸å…³æ•°æ®ï¼Œé‚£ä¹ˆä½¿ç”¨<code>Session</code>å°±å¯ä»¥ç»´æŒä¼šè¯äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line"></div><div class="line">headers = &#123;</div><div class="line">    <span class="string">'Accept'</span>: <span class="string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8'</span>,</div><div class="line">    <span class="string">'Accept-Encoding'</span>: <span class="string">'gzip, deflate, br'</span>,</div><div class="line">    <span class="string">'Accept-Language'</span>: <span class="string">'zh-CN,zh;q=0.9,en;q=0.8'</span>,</div><div class="line">    <span class="string">'Connection'</span>: <span class="string">'keep-alive'</span>,</div><div class="line">    <span class="string">'Host'</span>: <span class="string">'github.com'</span>,</div><div class="line">    <span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span>,</div><div class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">s = requests.session()</div><div class="line">s.headers.update(headers)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_token</span><span class="params">()</span>:</span></div><div class="line">    url = <span class="string">'https://github.com/login'</span></div><div class="line">    response = s.get(url)</div><div class="line">    pat = <span class="string">'name=\"authenticity_token\" value=\"(.*?)\"'</span></div><div class="line">    authenticity_token = re.findall(pat, response.text)[<span class="number">0</span>]</div><div class="line">    <span class="keyword">return</span> authenticity_token</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(authenticity_token, account, password)</span>:</span></div><div class="line">    payload = &#123;</div><div class="line">        <span class="string">'commit'</span>: <span class="string">'Sign in'</span>,</div><div class="line">        <span class="string">'utf8'</span>: <span class="string">'\u2713'</span>,</div><div class="line">        <span class="string">'authenticity_token'</span>: authenticity_token,</div><div class="line">        <span class="string">'login'</span>: account,</div><div class="line">        <span class="string">'password'</span>: password,</div><div class="line">    &#125;</div><div class="line">    url = <span class="string">'https://github.com/session'</span></div><div class="line">    response = s.post(url, data=payload)</div><div class="line">    print(response)</div><div class="line">    <span class="comment"># do whatever you want</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    account, password = <span class="string">'account'</span>, <span class="string">'password'</span></div><div class="line">    authenticity_token = get_token()</div><div class="line">    login(authenticity_token, account, password)</div></pre></td></tr></table></figure>
<h1 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h1><p>Seleniumï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šç®€å•ã€æ— è„‘ï¼Œä¸ç”¨åˆ†æå¤æ‚çš„ç½‘é¡µè¯·æ±‚ï¼Œä¸ç”¨ä¿æŒä¼šè¯çŠ¶æ€</li>
<li>ç¼ºç‚¹ï¼šé€Ÿåº¦æ…¢ï¼Œé€Ÿåº¦æ…¢ï¼Œé€Ÿåº¦æ…¢ï¼ˆæŸäº›æƒ…å†µä¸‹ä¼šå‡ºç°jsåŠ è½½ä¸å…¨ï¼‰</li>
</ul>
<p><img src="http://www.goalsinfocloud.com/wp-content/uploads/2018/02/selenium.png" alt=""></p>
<p>Requestsï¼š</p>
<ul>
<li>ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ï¼Œå¯ä»¥å¢åŠ è‡ªå·±å¯¹cookiesç™»é™†çš„ç†è§£</li>
<li>ç¼ºç‚¹ï¼šéœ€è¦èŠ±æ—¶é—´å¯»æ‰¾ç›¸å…³å‚æ•°</li>
</ul>
<p><img src="http://docs.python-requests.org/en/master/_static/requests-sidebar.png" alt=""></p>
<p>å¦‚æœå¯¹Githubæ„Ÿå…´è¶£ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <a href="https://developer.github.com/v3/" target="_blank" rel="external">Github API</a></p>
<p>æœ€è¿‘åœ¨ä½¿ç”¨<code>Selenium</code>å¤„ç†éªŒè¯ç ï¼Œå‘ç°å¾ˆå¼ºå¤§ï¼Œå¦‚æœæ¨¡æ‹Ÿè¯·æ±‚ï¼Œéš¾åº¦ä¼šéå¸¸å¤§ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://preview.ibb.co/cd5VUJ/20180717173128.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åä¹ç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ¨¡æ‹Ÿç™»é™†çš„ä¸¤ç§æ–¹å¼ï¼Œä½ å–œæ¬¢å“ªç§  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="Selenium" scheme="https://zhangslob.github.io/tags/Selenium/"/>
    
      <category term="Requests" scheme="https://zhangslob.github.io/tags/Requests/"/>
    
  </entry>
  
  <entry>
    <title>è¯´è¯´æœ€è¿‘é‡åˆ°çš„åçˆ¬</title>
    <link href="https://zhangslob.github.io/2018/07/10/%E8%AF%B4%E8%AF%B4%E6%9C%80%E8%BF%91%E9%81%87%E5%88%B0%E7%9A%84%E5%8F%8D%E7%88%AC/"/>
    <id>https://zhangslob.github.io/2018/07/10/è¯´è¯´æœ€è¿‘é‡åˆ°çš„åçˆ¬/</id>
    <published>2018-07-10T15:07:44.000Z</published>
    <updated>2018-07-10T15:13:23.022Z</updated>
    
    <content type="html"><![CDATA[<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åå…«ç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>çˆ¬è™«ä¸åçˆ¬  (à¹‘â€¢ . â€¢à¹‘)</p>
<p><img src="https://i.imgur.com/qb1MMqd.jpg" alt=""></p>
<a id="more"></a>
<h1 id="å‚æ•°åŠ å¯†"><a href="#å‚æ•°åŠ å¯†" class="headerlink" title="å‚æ•°åŠ å¯†"></a>å‚æ•°åŠ å¯†</h1><p>å‚æ•°åŠ å¯†æŒ‡çš„æ˜¯åœ¨è¯·æ±‚ä¸­éœ€è¦åŠ ä¸Šç±»ä¼¼<code>token</code>ã€<code>uuid</code> å­—æ®µï¼Œä¾‹å¦‚åœ¨æŸä¸ªè¯·æ±‚ä¸­<code>query string parameters</code>ä¸­æœ‰<code>_token</code>å’Œ<code>uuid</code>ã€<code>customerKey</code>ç­‰å­—æ®µï¼Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">_token:eJyN0l9L40AQAPDvsg8+hWZ2</div><div class="line">uuid:59851b5e-92b4<span class="_">-f</span>1f5-19e2<span class="_">-d</span>8148bf7e</div><div class="line">customerKey:0356982437</div></pre></td></tr></table></figure>
<p><strong>è§£å†³æ–¹æ³•</strong></p>
<p>åˆšå¼€å§‹é‡åˆ°è¿™ä¸ªæ˜¯ä¸€è„¸æ‡µé€¼çš„ï¼ŒéªŒè¯å‘ç°æœ‰äº›å‚æ•°ä¸æ˜¯å¿…é¡»çš„ï¼Œæ¯”å¦‚<code>uuid</code>ï¼Œ<code>uuid</code>åœ¨ç»´åŸºç™¾ç§‘ä¸Šæ˜¯ï¼šé€šç”¨å”¯ä¸€è¯†åˆ«ç ï¼Œä¼°è®¡æ²¡å•¥ä½œç”¨ï¼Œpythonä¹Ÿæœ‰å†…ç½®çš„uuidç”Ÿæˆåº“ <a href="https://docs.python.org/3/library/uuid.html" target="_blank" rel="external">uuid â€” UUID objects according to RFC 4122</a></p>
<p>é—®äº†å‰ç«¯å¤§ä½¬ï¼Œå¾—çŸ¥éœ€è¦åœ¨jsä¸­æ‰“æ–­ç‚¹ï¼Œä¸€ç‚¹ç‚¹è°ƒè¯•ï¼Œæœ€åç»ˆäºè§£å†³ï¼Œ<code>_token</code>æ˜¯äºŒæ¬¡åŠ å¯†çš„ã€‚</p>
<p>ç»™å¤§å®¶çœ‹ä¸€ä¸‹è¯¥ç½‘ç«™çš„éƒ¨åˆ†ä»£ç ã€‚çœ‹çœ‹æè¿°ï¼š<strong>è·å¾—åçˆ¬è™«çš„_toke</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * è·å¾—åçˆ¬è™«çš„_token</div><div class="line"> * @param &#123;*&#125; url </div><div class="line"> * @param &#123;*&#125; queryParams </div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRohrToken</span>(<span class="params">host, queryParams</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.Rohr_Opt &amp;&amp; <span class="built_in">window</span>.Rohr_Opt.reload) &#123;</div><div class="line">        <span class="keyword">var</span> rohr = <span class="built_in">window</span>.Rohr_Opt;</div><div class="line"></div><div class="line">        <span class="keyword">var</span> _token = <span class="string">''</span>;</div><div class="line">        <span class="keyword">var</span> params = queryParams</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> params == <span class="string">'string'</span> &amp;&amp; params.indexOf(<span class="string">'_fb_='</span>) !== <span class="number">-1</span>) &#123;</div><div class="line">            params = <span class="string">''</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">var</span> queryString = toQueryString(params);</div><div class="line"></div><div class="line">        <span class="keyword">var</span> _url = location.protocol + host + <span class="string">'?'</span> + queryString;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            _token = rohr.reload(_url) || <span class="string">''</span>;</div><div class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'è·å–tokenå¤±è´¥:'</span> + e)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> _token;</div><div class="line">    &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…³äºå¦‚ä½•è°ƒè¯•ï¼Œè¿™é‡Œæœ‰æ•™ç¨‹ï¼Œ<a href="http://wiki.jikexueyuan.com/project/chrome-devtools/debugging-javascript.html" target="_blank" rel="external">è°ƒè¯• JavaScript è„šæœ¬</a> </p>
<blockquote>
<p>è¿™é‡Œè¿˜æœ‰å¦ä¸€ç§appæŠ“åŒ…åŠ å¯†æƒ…å†µï¼Œæš‚æ—¶è¿˜æ²¡æ¥è§¦è¿‡ï¼Œå¬è¿‡æ˜¯éœ€è¦åç¼–è¯‘apkåŒ…ï¼Œç„¶åé˜…è¯»ä»£ç ã€‚</p>
</blockquote>
<h1 id="ç™»å½•é—®é¢˜"><a href="#ç™»å½•é—®é¢˜" class="headerlink" title="ç™»å½•é—®é¢˜"></a>ç™»å½•é—®é¢˜</h1><p>å¾ˆå¤šç½‘ç«™æ•°æ®æ˜¯ç™»å½•å¯è§ï¼Œé‚£ä¹ˆå°±å¿…é¡»è¦å¼€å‘è¯¥ç½‘ç«™çš„ç™»å½•ç³»ç»Ÿäº†ã€‚</p>
<p>ç™»å½•å¯èƒ½ä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼š</p>
<ol>
<li>ç™»å½•è¿‡ç¨‹ä¸­é‡åˆ°çš„éªŒè¯ç ï¼ˆä¸‹é¢ä¼šè¯´ï¼‰</li>
<li>cookiesæŒä¹…åŒ–é—®é¢˜</li>
<li>è´¦å·è¢«å°ç¦é—®é¢˜</li>
</ol>
<p><strong>è§£å†³æ–¹æ³•</strong></p>
<ul>
<li><p>ç™»å½•è´¦å·è·å¾—<code>cookies</code>åï¼Œç»è¿‡ä¸€æ®µæ—¶é—´ï¼Œ<code>cookies</code>å°±å¯èƒ½ä¼šå¤±æ•ˆï¼Œå…·ä½“ç½‘ç«™æƒ…å†µä¸åŒï¼Œè¿™æ—¶å€™å°±å¿…é¡»æœ‰ä¸ªè„šæœ¬ï¼Œæ¥ä¿è¯<code>cookies</code>æœ‰æ•ˆ</p>
</li>
<li><p>è´¦å·åšå‡ºä¸€äº›è·Ÿæ­£å¸¸ç”¨æˆ·ä¸åŒçš„æ“ä½œå°±ä¼šäº§ç”Ÿå¼‚å¸¸ï¼Œåˆ«äººå¾ˆå®¹æ˜“å°±å‘ç°ã€‚æ‰€ä»¥å°±è®©ä½ çš„è´¦å·åƒæ­£å¸¸äººä¸€æ ·ã€‚</p>
</li>
</ul>
<p>æœ€è¿‘çœ‹åˆ°æœ‰äººå†é—®è±†ç“£ç™»å½•é‡‡é›†å½±è¯„å¯¼è‡´è¢«å°å·çš„äº‹æƒ…ï¼Œè±†ç“£æˆ‘ä»¥å‰ä¹Ÿè¢«å°è¿‡ï¼Œåˆ°ç°åœ¨ä¹Ÿæ²¡æœ‰è§£å°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ä¾æ®ç”¨æˆ·ç®¡ç†ç»†åˆ™ï¼Œæ­¤å¸å·å·²è¢«æ°¸ä¹…åœç”¨ã€‚åœç”¨æ—¶é—´:2017-09-29</div><div class="line">å¦‚æœ‰ç–‘é—®ï¼Œè¯·å‘é€é‚®ä»¶åˆ°<span class="built_in">help</span>@douban.com</div></pre></td></tr></table></figure>
<p>æˆ‘çš„å»ºè®®æ˜¯ï¼š</p>
<ol>
<li>æœ‰èƒ½åŠ›çš„å¤šæ³¨å†Œè´¦å·ï¼Œè´¦å·è¢«å°äº†å°±å†å»æ³¨å†Œå‘—</li>
<li>æ‰‹æœºappæŠ“åŒ…ï¼Œappä¸éœ€è¦ç™»å½•ï¼Œè€Œä¸”å¯ä»¥æŒç»­æŠ“æœ€æ–°è¯„è®º</li>
</ol>
<h1 id="å›¾å½¢éªŒè¯ç "><a href="#å›¾å½¢éªŒè¯ç " class="headerlink" title="å›¾å½¢éªŒè¯ç "></a>å›¾å½¢éªŒè¯ç </h1><p>éªŒè¯ç ä¸€ç›´æ˜¯åçˆ¬è™«åˆ©å™¨ï¼Œä»ç®€å•çš„æ•°å­—è¯†åˆ«ï¼Œåˆ°å¤æ‚çš„æ»‘åŠ¨æ‹¼å›¾ã€å›¾ç‰‡ç‚¹é€‰ç­‰ç­‰ã€‚æœ‰å…´è¶£çš„æ¥è¯•è¯•ç ´è§£ <a href="http://dun.163.com/trial/picture-click" target="_blank" rel="external">ç½‘æ˜“äº‘æ˜“ç›¾</a>ï¼Œæ„Ÿè§‰å¾ˆå¤´ç–¼ã€‚</p>
<p><img src="https://image.ibb.co/ebAMMo/20180710202053.png" alt=""></p>
<p><strong>è§£å†³æ–¹æ³•</strong></p>
<p>ä¾‹å¦‚ä¸Šå›¾ï¼Œè¿™æ˜¯æˆ‘ç°åœ¨é‡åˆ°çš„ä¸€ç§éªŒè¯ç æƒ…å†µï¼Œä¾æ¬¡ç‚¹å‡»å‡ ä¸ªæ–‡å­—ã€‚</p>
<p>å¦‚æœæ˜¯è‡ªå·±æ¥åšçš„è¯ï¼Œä¼šè€ƒè™‘è¿™æ ·ï¼š</p>
<ol>
<li>å°†éªŒè¯ç å›¾ç‰‡éƒ¨åˆ†æˆªå›¾æˆ–ä¸‹è½½å›æ¥</li>
<li>å¯¹å›¾ç‰‡è¿›è¡ŒOCRï¼Œæå–æ–‡å­—</li>
<li>æ–‡å­—è¯†åˆ«ï¼Œè·å–åæ ‡</li>
<li>ä½¿ç”¨<code>selenium</code>æ ¹æ®åæ ‡ç‚¹å‡»</li>
</ol>
<p>è¿™åªæ˜¯åˆæ­¥æ€è·¯ï¼Œä½†æƒ³æ³•å¾ˆå®¹æ˜“ï¼Œåšèµ·æ¥å´æ²¡é‚£ä¹ˆç®€å•ã€‚</p>
<p>åœ¨Githubä¸Šæ‰¾åˆ°å¤§ä½¬å†™çš„æ–¹æ³• <a href="https://github.com/cos120/captcha_crack" target="_blank" rel="external">captcha_crack</a>ï¼ŒçŸ¥ä¹ä¸Šä¹Ÿæœ‰ <a href="https://zhuanlan.zhihu.com/p/34186397" target="_blank" rel="external">ä½¿ç”¨æ·±åº¦å­¦ä¹ ç ´è§£ç‚¹å‡»éªŒè¯ç </a></p>
<p>é‚£ä¹ˆå¦‚æœç›´æ¥æ¥å…¥ç¬¬ä¸‰æ–¹æ‰“ç å¹³å°æ¥ï¼Œé‚£å°±ä¼šç®€å•å¾ˆå¤šï¼Œåœ¨å®é™…å¼€å‘ä¸­ä¸ºäº†æé«˜å‡†ç¡®æ€§ï¼Œæ›´å¤šä¼šä½¿ç”¨æ‰“ç å¹³å°ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åå…«ç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çˆ¬è™«ä¸åçˆ¬  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/qb1MMqd.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="åçˆ¬" scheme="https://zhangslob.github.io/tags/%E5%8F%8D%E7%88%AC/"/>
    
  </entry>
  
  <entry>
    <title>å¿«é€Ÿå†™ä¸€ä¸ªçˆ¬è™«</title>
    <link href="https://zhangslob.github.io/2018/07/03/%E5%BF%AB%E9%80%9F%E5%86%99%E4%B8%80%E4%B8%AA%E7%88%AC%E8%99%AB/"/>
    <id>https://zhangslob.github.io/2018/07/03/å¿«é€Ÿå†™ä¸€ä¸ªçˆ¬è™«/</id>
    <published>2018-07-03T15:20:52.732Z</published>
    <updated>2018-07-03T15:20:52.732Z</updated>
    
    <content type="html"><![CDATA[<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åä¸ƒç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>å¿«ã€æ›´å¿«  (à¹‘â€¢ . â€¢à¹‘)</p>
<p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1530640088638&amp;di=367da0e00206dae5988d7515df52c2a9&amp;imgtype=jpg&amp;src=http%3A%2F%2Fimg1.imgtn.bdimg.com%2Fit%2Fu%3D1476255146%2C3695215484%26fm%3D214%26gp%3D0.jpg" alt=""></p>
<a id="more"></a>
<h1 id="ç¼˜æ¥"><a href="#ç¼˜æ¥" class="headerlink" title="ç¼˜æ¥"></a>ç¼˜æ¥</h1><p>ä»Šå¤©ä¸‹ç­å‰ï¼Œè€æ¿è®©æˆ‘å¸®å¿™çˆ¬ä¸€ä¸ªæ•°æ®ï¼Œç®€å•çœ‹äº†ä¸‹ï¼Œéœ€è¦ç™»å½•ï¼Œçœ‹èµ·æ¥åº”è¯¥ä¸éš¾ã€‚å›åˆ°å®¶ï¼Œæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå¤åˆ¶<code>url</code>ï¼Œç„¶åç”¨postmanè½¬ä»£ç ï¼Œç®€å•æš´åŠ›ï¼Œç›´æ¥æ’¸ã€‚</p>
<blockquote>
<p>è¿™é‡Œè¯´ä¸‹postmançš„ä¸€ä¸ªBUGï¼Œå‘é€è¯·æ±‚ä¸ä¼šè·å¾—ä»»ä½•æ•°æ®ï¼Œå¦‚æœä½ é‡åˆ°ï¼Œå»ºè®®å‡çº§postmanä¸ºæœ€æ–°ç‰ˆæœ¬</p>
</blockquote>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> logging</div><div class="line"><span class="keyword">import</span> pymongo</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> traceback</div><div class="line"><span class="keyword">from</span> concurrent <span class="keyword">import</span> futures</div><div class="line"><span class="keyword">from</span> urllib.request <span class="keyword">import</span> urljoin</div><div class="line"><span class="keyword">from</span> scrapy.selector <span class="keyword">import</span> Selector</div><div class="line"></div><div class="line"></div><div class="line">logging.basicConfig(level=logging.INFO)</div><div class="line"></div><div class="line">client = pymongo.MongoClient()</div><div class="line">coll = client[<span class="string">'table'</span>][<span class="string">'collection'</span>]</div><div class="line"><span class="comment"># coll.create_index('url', unique=True)</span></div><div class="line"></div><div class="line">url = <span class="string">"your urls"</span></div><div class="line"></div><div class="line"></div><div class="line">headers = &#123;</div><div class="line">    <span class="string">'user-agent'</span>: <span class="string">"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 "</span></div><div class="line">                  <span class="string">"(KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36"</span>,</div><div class="line">    <span class="string">'accept'</span>: <span class="string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8"</span>,</div><div class="line">    <span class="string">'accept-encoding'</span>: <span class="string">"gzip, deflate, br"</span>,</div><div class="line">    <span class="string">'accept-language'</span>: <span class="string">"zh-CN,zh;q=0.9,en;q=0.8"</span>,</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch</span><span class="params">(page)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        proxies = &#123;</div><div class="line">            <span class="string">'http'</span>: proxy,</div><div class="line">            <span class="string">'https'</span>: proxy</div><div class="line">        &#125;</div><div class="line">        response = requests.get(url.format(page), headers=headers, timeout=<span class="number">20</span>, proxies=proxies)</div><div class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</div><div class="line">            s = Selector(text=response.text)</div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> s.xpath(<span class="string">'//*[@id="search-results"]/tbody/tr'</span>):</div><div class="line">                url_ = i.xpath(<span class="string">'td[4]/a/@href'</span>).extract_first()</div><div class="line">                detail_url = urljoin(url, url_)</div><div class="line">                data = get_detail(detail_url)</div><div class="line">                logging.info(<span class="string">'success save data &#123;&#125; '</span>.format(data[<span class="string">'url'</span>]))</div><div class="line">                save_mongo(data)</div><div class="line"></div><div class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">        logging.error(traceback.format_exc())</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_detail</span><span class="params">(detail_url)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        proxies = &#123;</div><div class="line">            <span class="string">'http'</span>: proxy,</div><div class="line">            <span class="string">'https'</span>: proxy</div><div class="line">        &#125;</div><div class="line">        response = requests.get(detail_url, headers=headers, timeout=<span class="number">20</span>, proxies=proxies)</div><div class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</div><div class="line">            s = Selector(text=response.text)</div><div class="line">            data = dict()</div><div class="line">            data[<span class="string">'url'</span>] = detail_url</div><div class="line">            data[<span class="string">'SMILES '</span>] = s.xpath(<span class="string">'//*[@id="smiles"]/text()'</span>).extract_first()</div><div class="line">            img = s.xpath(<span class="string">'//*[@id="molecule-image"]/img/@src'</span>).extract_first()</div><div class="line">            data[<span class="string">'img'</span>] = urljoin(detail_url, img)</div><div class="line">            data[<span class="string">'formula'</span>] = s.xpath(<span class="string">'//*[@id="name-structure"]/tbody/tr[2]/td[2]/text()'</span>).extract_first()</div><div class="line">            data[<span class="string">'Mass'</span>] = s.xpath(<span class="string">'//*[@id="name-structure"]/tbody/tr[3]/td[2]/text()'</span>).extract_first()</div><div class="line"></div><div class="line">            <span class="keyword">return</span> data</div><div class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">        logging.error(traceback.format_exc())</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_mongo</span><span class="params">(data)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        coll.insert(data)</div><div class="line">    <span class="keyword">except</span> pymongo.errors.DuplicateKeyError:</div><div class="line">        <span class="keyword">pass</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="comment"># for i in range(1, 11):</span></div><div class="line">    <span class="comment">#     fetch(str(i))</span></div><div class="line"></div><div class="line">    <span class="comment"># if use Thread</span></div><div class="line">    <span class="keyword">with</span> futures.ThreadPoolExecutor(max_workers=<span class="number">50</span>) <span class="keyword">as</span> executor:</div><div class="line">            to_do = []</div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">51</span>):</div><div class="line">                future = executor.submit(fetch, str(i))</div><div class="line">                to_do.append(future)</div></pre></td></tr></table></figure>
<p>ä»£ç ç›¸å½“ç®€å•ï¼Œ<code>fetch</code>å‡½æ•°ç”¨æ¥æŠ“å–åˆ—è¡¨é¡µï¼Œ<code>get_detail</code>å‡½æ•°æŠ“å–è¯¦æƒ…é¡µï¼Œ<code>save_mongo</code>ä¿å­˜æ•°æ®åº“ï¼Œéœ€è¦è¯´æ˜ä¸‹çš„å°±æ˜¯æœ€åä½¿ç”¨çš„å¤šçº¿ç¨‹äº†ï¼Œè¿™é‡Œå·ä½¿ç”¨çš„æ˜¯<code>futures</code>ï¼Œå¹¶ä¸æƒ³è¯´å¾ˆå¤šå¤§é“ç†ï¼Œæ¥çœ‹çœ‹<a href="https://docs.python.org/3/library/concurrent.futures.html" target="_blank" rel="external">æ–‡æ¡£</a></p>
<h1 id="æé«˜é€Ÿåº¦"><a href="#æé«˜é€Ÿåº¦" class="headerlink" title="æé«˜é€Ÿåº¦"></a>æé«˜é€Ÿåº¦</h1><p>concurrent.futures æ˜¯python3æ–°å¢åŠ çš„ä¸€ä¸ªåº“ï¼Œç”¨äºå¹¶å‘å¤„ç†ï¼Œæä¾›äº†å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹çš„å¹¶å‘åŠŸèƒ½ </p>
<p><strong>çº¿ç¨‹æ± </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> concurrent.futures</div><div class="line"><span class="keyword">import</span> urllib.request</div><div class="line"></div><div class="line">URLS = [<span class="string">'http://www.foxnews.com/'</span>,</div><div class="line">        <span class="string">'http://www.cnn.com/'</span>,</div><div class="line">        <span class="string">'http://europe.wsj.com/'</span>,</div><div class="line">        <span class="string">'http://www.bbc.co.uk/'</span>,</div><div class="line">        <span class="string">'http://some-made-up-domain.com/'</span>]</div><div class="line"></div><div class="line"><span class="comment"># Retrieve a single page and report the URL and contents</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_url</span><span class="params">(url, timeout)</span>:</span></div><div class="line">    <span class="keyword">with</span> urllib.request.urlopen(url, timeout=timeout) <span class="keyword">as</span> conn:</div><div class="line">        <span class="keyword">return</span> conn.read()</div><div class="line"></div><div class="line"><span class="comment"># We can use a with statement to ensure threads are cleaned up promptly</span></div><div class="line"><span class="keyword">with</span> concurrent.futures.ThreadPoolExecutor(max_workers=<span class="number">5</span>) <span class="keyword">as</span> executor:</div><div class="line">    <span class="comment"># Start the load operations and mark each future with its URL</span></div><div class="line">    future_to_url = &#123;executor.submit(load_url, url, <span class="number">60</span>): url <span class="keyword">for</span> url <span class="keyword">in</span> URLS&#125;</div><div class="line">    <span class="keyword">for</span> future <span class="keyword">in</span> concurrent.futures.as_completed(future_to_url):</div><div class="line">        url = future_to_url[future]</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            data = future.result()</div><div class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> exc:</div><div class="line">            print(<span class="string">'%r generated an exception: %s'</span> % (url, exc))</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            print(<span class="string">'%r page is %d bytes'</span> % (url, len(data)))</div></pre></td></tr></table></figure>
<p><strong>è¿›ç¨‹æ± </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> concurrent.futures</div><div class="line"><span class="keyword">import</span> math</div><div class="line"></div><div class="line">PRIMES = [</div><div class="line">    <span class="number">112272535095293</span>,</div><div class="line">    <span class="number">112582705942171</span>,</div><div class="line">    <span class="number">112272535095293</span>,</div><div class="line">    <span class="number">115280095190773</span>,</div><div class="line">    <span class="number">115797848077099</span>,</div><div class="line">    <span class="number">1099726899285419</span>]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_prime</span><span class="params">(n)</span>:</span></div><div class="line">    <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line">    sqrt_n = int(math.floor(math.sqrt(n)))</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, sqrt_n + <span class="number">1</span>, <span class="number">2</span>):</div><div class="line">        <span class="keyword">if</span> n % i == <span class="number">0</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">with</span> concurrent.futures.ProcessPoolExecutor() <span class="keyword">as</span> executor:</div><div class="line">        <span class="keyword">for</span> number, prime <span class="keyword">in</span> zip(PRIMES, executor.map(is_prime, PRIMES)):</div><div class="line">            print(<span class="string">'%d is prime: %s'</span> % (number, prime))</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>å…³äºå…¥åº“æ–¹é¢ï¼Œå»ºè®®æ˜¯å¢åŠ å”¯ä¸€ç´¢å¼•ï¼Œ <code>coll.create_index(&#39;url&#39;, unique=True)</code>ï¼Œä¸€ä¸ªæ˜¯å»é‡ï¼Œä¸€ä¸ªæ˜¯æé«˜æŸ¥è¯¢é€Ÿåº¦ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åä¸ƒç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¿«ã€æ›´å¿«  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://timgsa.baidu.com/timg?image&amp;amp;quality=80&amp;amp;size=b9999_10000&amp;amp;sec=1530640088638&amp;amp;di=367da0e00206dae5988d7515df52c2a9&amp;amp;imgtype=jpg&amp;amp;src=http%3A%2F%2Fimg1.imgtn.bdimg.com%2Fit%2Fu%3D1476255146%2C3695215484%26fm%3D214%26gp%3D0.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
  </entry>
  
  <entry>
    <title>Katalon + å‚»ç“œ == selenium</title>
    <link href="https://zhangslob.github.io/2018/06/25/Katalon-selenium-%E5%82%BB%E7%93%9C/"/>
    <id>https://zhangslob.github.io/2018/06/25/Katalon-selenium-å‚»ç“œ/</id>
    <published>2018-06-25T13:58:25.816Z</published>
    <updated>2018-06-25T13:58:25.816Z</updated>
    
    <content type="html"><![CDATA[<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åå…­ç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>ç®€ç›´æ˜¯ç¥å™¨å•Š  (à¹‘â€¢ . â€¢à¹‘)</p>
<p><img src="https://i.imgur.com/dIxaOYj.png" alt=""></p>
<a id="more"></a>
<p>ä»Šå¤©åœ¨ç¿»è«çƒ¦å¤§å¤§çš„åšå®¢æ—¶ï¼Œçœ‹åˆ°ä»–æåˆ°ä¸€ä¸ªå·¥å…·ï¼Œä¾¿å»çœ‹äº†ä¸‹ï¼Œç¬¬ä¸€æ„Ÿå—æ˜¯ï¼Œå¤ªå¥½ç”¨äº†ã€çˆ±ä¸é‡Šæ‰‹ã€‚</p>
<p>ä¸‹é¢æ¥è¯´è¯´è¿™ä¸ªå·¥å…·ï¼šKatalon Recorder</p>
<h1 id="Katalon-Recorder"><a href="#Katalon-Recorder" class="headerlink" title="Katalon Recorder"></a>Katalon Recorder</h1><p>å®‰è£…åœ°å€ï¼š<a href="https://chrome.google.com/webstore/detail/katalon-recorder-selenium/ljdobmomdgdljniojadhoplhkpialdid/related" target="_blank" rel="external">Katalon Recorder</a></p>
<p>å®˜æ–¹ä»‹ç»æ˜¯ï¼š</p>
<blockquote>
<p>Best Selenium IDE record, play, debug app. Exports Selenium WebDriver code. Provides reports, logs, screenshots. Fast &amp; extensible. </p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œä»–å¯ä»¥è®°å½•ä½ åœ¨æµè§ˆå™¨ä¸Šçš„æ¯ä¸€ä¸ªåŠ¨ä½œï¼ŒåŒ…æ‹¬ã€ç‚¹å‡»ã€è¾“å…¥ã€è¾“å…¥å­—ç¬¦ç­‰ç­‰ï¼Œæœ€åä¸€é”®è½¬åŒ–ä¸ºç¼–ç¨‹ä»£ç ï¼Œå¯ä»¥è½¬åŒ–çš„è¯­è¨€æœ‰ï¼š</p>
<ol>
<li>C#</li>
<li>JAVA</li>
<li>Katalon Studio</li>
<li>Python2</li>
<li>Roboot Framework</li>
<li>Ruby</li>
<li>XML</li>
</ol>
<p>ä¾‹å¦‚ä¸‹å›¾å°±æ˜¯ç›´æ¥è½¬åŒ–ä¸º Python2çš„ä»£ç </p>
<p><img src="https://i.imgur.com/q6t07p3.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</div><div class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</div><div class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</div><div class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select</div><div class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException</div><div class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoAlertPresentException</div><div class="line"><span class="keyword">import</span> unittest, time, re</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UntitledTestCase</span><span class="params">(unittest.TestCase)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></div><div class="line">        self.driver = webdriver.Firefox()</div><div class="line">        self.driver.implicitly_wait(<span class="number">30</span>)</div><div class="line">        self.base_url = <span class="string">"https://www.katalon.com/"</span></div><div class="line">        self.verificationErrors = []</div><div class="line">        self.accept_next_alert = <span class="keyword">True</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_untitled_test_case</span><span class="params">(self)</span>:</span></div><div class="line">        driver = self.driver</div><div class="line">        driver.get(<span class="string">"https://zhangslob.github.io/"</span>)</div><div class="line">        driver.find_element_by_link_text(<span class="string">u"Cookiesæ± çš„åç»­è§£å†³æ–¹æ¡ˆ"</span>).click()</div><div class="line">        driver.find_element_by_xpath(<span class="string">"//main[@id='main']/div/div"</span>).click()</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_element_present</span><span class="params">(self, how, what)</span>:</span></div><div class="line">        <span class="keyword">try</span>: self.driver.find_element(by=how, value=what)</div><div class="line">        <span class="keyword">except</span> NoSuchElementException <span class="keyword">as</span> e: <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_alert_present</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">try</span>: self.driver.switch_to_alert()</div><div class="line">        <span class="keyword">except</span> NoAlertPresentException <span class="keyword">as</span> e: <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close_alert_and_get_its_text</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            alert = self.driver.switch_to_alert()</div><div class="line">            alert_text = alert.text</div><div class="line">            <span class="keyword">if</span> self.accept_next_alert:</div><div class="line">                alert.accept()</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                alert.dismiss()</div><div class="line">            <span class="keyword">return</span> alert_text</div><div class="line">        <span class="keyword">finally</span>: self.accept_next_alert = <span class="keyword">True</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></div><div class="line">        self.driver.quit()</div><div class="line">        self.assertEqual([], self.verificationErrors)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    unittest.main()</div></pre></td></tr></table></figure>
<p>è™½ç„¶è¯´ç”¨çš„æ˜¯Python2ï¼Œä½†æ˜¯å¹¶ä¸å½±å“ï¼Œç®€å•æ”¹ä¸€ä¸‹å°±å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œä¸»è¦é€»è¾‘åœ¨<code>test_untitled_test_case</code>å‡½æ•°ä¸­ï¼Œå¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨ã€‚</p>
<p>æ³¨æ„è¿™é‡Œä½¿ç”¨äº†<code>unittest</code>ï¼Œä¸ç†Ÿæ‚‰çš„å¯ä»¥æ¥çœ‹çœ‹<a href="https://docs.python.org/3/library/unittest.html" target="_blank" rel="external">æ–‡æ¡£</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> unittest</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestStringMethods</span><span class="params">(unittest.TestCase)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_upper</span><span class="params">(self)</span>:</span></div><div class="line">        self.assertEqual(<span class="string">'foo'</span>.upper(), <span class="string">'FOO'</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_isupper</span><span class="params">(self)</span>:</span></div><div class="line">        self.assertTrue(<span class="string">'FOO'</span>.isupper())</div><div class="line">        self.assertFalse(<span class="string">'Foo'</span>.isupper())</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_split</span><span class="params">(self)</span>:</span></div><div class="line">        s = <span class="string">'hello world'</span></div><div class="line">        self.assertEqual(s.split(), [<span class="string">'hello'</span>, <span class="string">'world'</span>])</div><div class="line">        <span class="comment"># check that s.split fails when the separator is not a string</span></div><div class="line">        <span class="keyword">with</span> self.assertRaises(TypeError):</div><div class="line">            s.split(<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    unittest.main()</div></pre></td></tr></table></figure>
<h1 id="å®‰è£…æ–¹æ³•"><a href="#å®‰è£…æ–¹æ³•" class="headerlink" title="å®‰è£…æ–¹æ³•"></a>å®‰è£…æ–¹æ³•</h1><p>è¿™é‡Œå»ºè®®ç›´æ¥åœ¨Chromeåº”ç”¨å¸‚åœºå®‰è£…ï¼Œåœ°å€ <a href="https://chrome.google.com/webstore/detail/katalon-recorder-selenium/ljdobmomdgdljniojadhoplhkpialdid/related" target="_blank" rel="external">Katalon Recorder</a></p>
<p>è€ƒè™‘åˆ°æœ‰äº›åŒå­¦å¯èƒ½é‚£å•¥ï¼Œæ‰€ä»¥æˆ‘å·²ç»ä¸‹è½½å¥½äº†ã€‚å…¬ä¼—å·ï¼šPythonçˆ¬è™«ä¸ç®—æ³•è¿›é˜¶ï¼Œå›å¤ï¼š<strong>å‚»ç“œ</strong></p>
<p><img src="https://i.imgur.com/93kxeCD.jpg" alt=""></p>
<h1 id="æ„Ÿå—"><a href="#æ„Ÿå—" class="headerlink" title="æ„Ÿå—"></a>æ„Ÿå—</h1><p>è¿™ä¸ªç›¸å½“äºæŒ‰é”®ç²¾çµï¼ŒæŠŠæˆ‘ä»¬å¯¹æµè§ˆå™¨çš„æ¯ä¸€æ­¥æ“ä½œéƒ½å®Œæˆäº†ï¼Œå¯ä»¥ç”¨æ¥ç”Ÿæˆä»£ç ï¼Œå’Œpostmanä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘æ‰ä¼šè¯´ <code>Katalon + å‚»ç“œ == selenium</code>ï¼Œå®Œå…¨æ˜¯å‚»ç“œæ“ä½œã€‚</p>
<p>æ¯”å¦‚æ¥åšä¸€äº›è‡ªåŠ¨åŒ–ç™»å½•ã€æ³¨å†Œç­‰æ¿å—ä¼šéå¸¸çˆ½ï¼Œä½†æ˜¯éªŒè¯ç éƒ¨åˆ†è¿˜æ˜¯éœ€è¦è‡ªè¡Œè§£å†³ã€‚</p>
<p>ä½†æ˜¯è¯¥è½¯ä»¶ä¹Ÿæ˜¯æœ‰ä¸€äº›é—®é¢˜çš„ï¼Œå®ƒä¸èƒ½è¿›è¡Œå¤šé¡µé¢åˆ‡æ¢ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½è‡ªåŠ¨åˆ‡æ¢åˆ°æ–°æ‰“å¼€çš„çª—å£ï¼Œä¼šæœ‰é”™è¯¯æç¤º<code># ERROR: Caught exception [ERROR: Unsupported command [selectWindow | win_ser_1 | ]]</code>ï¼Œè¿™ä¸€æ­¥å¿…é¡»è‡ªå·±æ‰‹åŠ¨æ¥æ“ä½œï¼Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">driver.current_window_handle è·å–å½“å‰çª—å£handle</div><div class="line">driver.window_handles è·å–æ‰€æœ‰çª—å£çš„handleï¼Œè¿”å›liståˆ—è¡¨</div><div class="line">driver.switch_to.window(handle) åˆ‡æ¢åˆ°å¯¹åº”çš„çª—å£</div><div class="line">driver.close() å…³é—­å½“å‰çª—å£</div></pre></td></tr></table></figure>
<p>æµ‹è¯•æ‰“å¼€å¤šçª—å£çš„ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</div><div class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</div><div class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</div><div class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select</div><div class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoSuchElementException</div><div class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> NoAlertPresentException</div><div class="line"><span class="keyword">import</span> unittest, time, re</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Zhihu</span><span class="params">(unittest.TestCase)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(self)</span>:</span></div><div class="line">        self.driver = webdriver.Firefox()</div><div class="line">        self.driver.implicitly_wait(<span class="number">30</span>)</div><div class="line">        self.base_url = <span class="string">"https://www.katalon.com/"</span></div><div class="line">        self.verificationErrors = []</div><div class="line">        self.accept_next_alert = <span class="keyword">True</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_zhihu</span><span class="params">(self)</span>:</span></div><div class="line">        driver = self.driver</div><div class="line">        driver.get(<span class="string">"https://www.zhihu.com/people/cuishite/activities"</span>)</div><div class="line">        driver.find_element_by_xpath(<span class="string">"//div[@id='ProfileMain']/div/ul/li[2]/a"</span>).click()</div><div class="line">        driver.find_element_by_xpath(<span class="string">"//div[@id='ProfileMain']/div/ul/li[4]/a/span"</span>).click()</div><div class="line">        driver.find_element_by_link_text(<span class="string">u"Cookiesæ± çš„åç»­è§£å†³æ–¹æ¡ˆ"</span>).click()</div><div class="line">        <span class="comment"># ERROR: Caught exception [ERROR: Unsupported command [selectWindow | win_ser_1 | ]]</span></div><div class="line">        driver.find_element_by_xpath(<span class="string">"//img[contains(@src,'https://pic4.zhimg.com/v2-7ff26e52e6c82c080f62d8e9291e532b_b.jpg')]"</span>).click()</div><div class="line">        driver.find_element_by_link_text(<span class="string">u"Cookiesæ± çš„åç»­è§£å†³æ–¹æ¡ˆ"</span>).click()</div><div class="line">        <span class="comment"># ERROR: Caught exception [ERROR: Unsupported command [selectWindow | win_ser_2 | ]]</span></div><div class="line">        driver.find_element_by_xpath(<span class="string">"//div[@id='js_article']/div[2]"</span>).click()</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_element_present</span><span class="params">(self, how, what)</span>:</span></div><div class="line">        <span class="keyword">try</span>: self.driver.find_element(by=how, value=what)</div><div class="line">        <span class="keyword">except</span> NoSuchElementException <span class="keyword">as</span> e: <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_alert_present</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">try</span>: self.driver.switch_to_alert()</div><div class="line">        <span class="keyword">except</span> NoAlertPresentException <span class="keyword">as</span> e: <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close_alert_and_get_its_text</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            alert = self.driver.switch_to_alert()</div><div class="line">            alert_text = alert.text</div><div class="line">            <span class="keyword">if</span> self.accept_next_alert:</div><div class="line">                alert.accept()</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                alert.dismiss()</div><div class="line">            <span class="keyword">return</span> alert_text</div><div class="line">        <span class="keyword">finally</span>: self.accept_next_alert = <span class="keyword">True</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(self)</span>:</span></div><div class="line">        self.driver.quit()</div><div class="line">        self.assertEqual([], self.verificationErrors)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    unittest.main()</div></pre></td></tr></table></figure>
<p>æ‰€ä»¥åªéœ€è¦è¿™ä¸€ç‚¹å°±å¯ä»¥å®Œå–„ä»£ç ï¼ŒåŒæ—¶å¯ä»¥çœ‹çœ‹ä»–ä»¬çš„å®˜ç½‘ <a href="https://www.katalon.com/" target="_blank" rel="external">KATALON - Best automated testing tool for web, mobile, API</a>ï¼Œä»–ä»¬ä¸»è¦æ˜¯æä¾›æµ‹è¯•å·¥å…·ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥äº†è§£ä¸‹ã€‚</p>
<p><img src="https://i.imgur.com/V8smLse.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åå…­ç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç®€ç›´æ˜¯ç¥å™¨å•Š  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/dIxaOYj.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
  </entry>
  
  <entry>
    <title>Cookiesæ± çš„åç»­è§£å†³æ–¹æ¡ˆ</title>
    <link href="https://zhangslob.github.io/2018/06/16/Cookies%E6%B1%A0%E7%9A%84%E5%90%8E%E7%BB%AD%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <id>https://zhangslob.github.io/2018/06/16/Cookiesæ± çš„åç»­è§£å†³æ–¹æ¡ˆ/</id>
    <published>2018-06-16T07:01:54.000Z</published>
    <updated>2018-06-16T07:05:36.039Z</updated>
    
    <content type="html"><![CDATA[<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åäº”ç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>ç»ˆäºæœ‰æ–¹æ³•äº†  (à¹‘â€¢ . â€¢à¹‘)</p>
<p><img src="https://i.imgur.com/VD9q71g.jpg" alt=""></p>
<a id="more"></a>
<p><img src="https://i.imgur.com/VD9q71g.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/bmiddle/76a1b64dly1fschugfmkfg20a905savu.gif" alt=""></p>
<blockquote>
<p>ä½œä¸ºä¸€åç½—å¹,å…ˆå¹ä¸€æ³¢Cç½—ç‰›çš®,ç®€ç›´å¤ªå¸…äº†äº†äº†</p>
<p>ç§ç§è¿™ä¸ªçœ¼ç¥<br>å»ºè®®å¤§å®¶å¯ä»¥çœ‹çœ‹è¿™åœºæ¯”èµ›ï¼Œè¥¿ç­ç‰™VSè‘¡è„ç‰™ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¼šçˆ±ä¸Šè¶³çƒçš„</p>
</blockquote>
<h1 id="æ­£æ–‡å¼€å§‹"><a href="#æ­£æ–‡å¼€å§‹" class="headerlink" title="æ­£æ–‡å¼€å§‹"></a>æ­£æ–‡å¼€å§‹</h1><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« : ç®€å•è¯´æ˜äº†è‡ªå·±å¯¹äºè¯¥ç½‘ç«™çš„æƒ³æ³•,åœ¨ç»è¿‡ä¸¤å¤©çš„æµ‹è¯•ä¸ç ”ç©¶ä¹‹å,æˆ‘æœ‰äº†æ›´å¤šçš„æƒ³æ³•.</p>
<h2 id="æƒ³æ³•ä¸€-ä¸ºæ¯ä¸ªCookiesç»‘å®šå”¯ä¸€IP"><a href="#æƒ³æ³•ä¸€-ä¸ºæ¯ä¸ªCookiesç»‘å®šå”¯ä¸€IP" class="headerlink" title="æƒ³æ³•ä¸€: ä¸ºæ¯ä¸ªCookiesç»‘å®šå”¯ä¸€IP"></a>æƒ³æ³•ä¸€: ä¸ºæ¯ä¸ªCookiesç»‘å®šå”¯ä¸€IP</h2><p>ä½ ä½œä¸ºä¸€ä¸ªæ™®é€šç”¨æˆ·,å¦‚æœå¯¹æ–¹ç½‘ç«™æ£€æµ‹åˆ°ä½ ä¸åœåœ°å˜æ¢IPä»ä¸åŒåœ°æ–¹æ¥å‘é€è¯·æ±‚,é‚£ä»–è‚¯å®šä¼šæœ‰è¯†åˆ«.é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸€ä¸ªCookiesåˆ†é…å”¯ä¸€çš„IPä»£ç†,ä¹Ÿå°±æ˜¯ä½ è¿™ä¸ªCookieså‘é€è¯·æ±‚çš„ä»£ç†å§‹ç»ˆæ˜¯å”¯ä¸€çš„.</p>
<p>ä½†æ˜¯è¿™ç§æ–¹æ³•çš„å®ç°æ–¹å¼è¿˜æ²¡æœ‰æƒ³å‡ºæ¥,ä¸çŸ¥é“è¯¥ä½¿ç”¨å“ªäº›æŠ€æœ¯æ ˆæ¥å®ç°è¿™ä¸ªæƒ³æ³•</p>
<h2 id="æƒ³æ³•äºŒ-è§£å†³éªŒè¯ç "><a href="#æƒ³æ³•äºŒ-è§£å†³éªŒè¯ç " class="headerlink" title="æƒ³æ³•äºŒ: è§£å†³éªŒè¯ç "></a>æƒ³æ³•äºŒ: è§£å†³éªŒè¯ç </h2><p>å¥½,æ—¢ç„¶ä½ å¼¹å‡ºéªŒè¯ç ,é‚£æˆ‘å°±è§£å†³å®ƒ! è§£å†³æ–¹æ³•æ˜¯:</p>
<ol>
<li>è¯¥ç½‘ç«™çš„éªŒè¯ç å›¾ç‰‡æ˜¯<code>base64</code>,ç”¨<code>python</code>è½¬ä¸€ä¸‹,æ¥ä¸Šç¬¬ä¸‰æ–¹å°±OK</li>
<li>åŒæ—¶è¯¥ç½‘ç«™å‚æ•°ä¸­è¿˜å¸¦æœ‰<code>token</code>å‚æ•°,ç»è¿‡å‰ç«¯å¤§ä½¬çš„æ–­ç‚¹è°ƒè¯•,å‘ç°æ˜¯å¯¹å¤šä¸ªå­—æ®µçš„ä¸¤æ¬¡åŠ å¯†</li>
<li>ä¿æŒä¼šè¯session.ä½ éœ€è¦è®©å¯¹æ–¹ç½‘ç«™çŸ¥é“æ˜¯ä½ è¿™ä¸ªç”¨æˆ·,æ‰€ä»¥ä½ çš„cookies,ip,headersç›¸å…³ä¿¡æ¯å¿…é¡»ä¿æŒä¸€è‡´,æˆ‘å½“æ—¶çš„æƒ³æ³•æ˜¯ä½¿ç”¨<code>requests</code>çš„<code>session</code>æ¥å®Œæˆè¿™ä¸€æ­¥æ“ä½œ,ä½†æ˜¯å¾ˆéš¾å®Œå…¨æ¨¡æ‹Ÿ,å› ä¸ºæ•´ä¸ªçˆ¬è™«ä½¿ç”¨<code>scrapy</code>æ¥å†™,å¤„ç†éªŒè¯ç ä½¿ç”¨<code>requests</code>æ¥åš,<code>session</code>è¿™éƒ¨åˆ†ä¸å¤§å¥½æ¨¡æ‹Ÿ.</li>
</ol>
<p>é™„ä¸Šä¸€äº›ä¸º<code>session</code>æ·»åŠ ä¿¡æ¯çš„ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, my_cookie, proxy, headers)</span>:</span></div><div class="line">    self.session = requests.session()</div><div class="line">    self.session.cookies.update(my_cookie)</div><div class="line">    self.session.headers.update(&#123;<span class="string">'User-Agent'</span>: headers&#125;)</div><div class="line">    self.session.update(proxy)</div></pre></td></tr></table></figure>
<h2 id="æƒ³æ³•ä¸‰-ä¸è§£å†³éªŒè¯é—®é¢˜-æ— è„‘é‡è¯•"><a href="#æƒ³æ³•ä¸‰-ä¸è§£å†³éªŒè¯é—®é¢˜-æ— è„‘é‡è¯•" class="headerlink" title="æƒ³æ³•ä¸‰: ä¸è§£å†³éªŒè¯é—®é¢˜,æ— è„‘é‡è¯•"></a>æƒ³æ³•ä¸‰: ä¸è§£å†³éªŒè¯é—®é¢˜,æ— è„‘é‡è¯•</h2><p>è¿™æ˜¯æœ€è ¢çš„åŠæ³•,ä¹Ÿæ˜¯æˆ‘ç›®å‰åœ¨ä½¿ç”¨çš„æ–¹æ³•. /(ã„’oã„’)/~~</p>
<p>æ€è·¯æ˜¯: å°†<code>cookies</code>ä¿å­˜åˆ°mongoDBåšæŒä¹…åŒ–,å†å†™ä¸€ä¸ªè„šæœ¬,æŒç»­çš„å‘<code>redis</code>ä¸­æ·»åŠ <code>cookies</code>å’Œ<code>start_urls</code>,ç„¶åå¯¹è¿™äº›<code>start_urls</code>ä¸åœåœ°é‡è¯•,å¯¹,å°±æ˜¯ä¸åœåœ°é‡è¯•,ç›´åˆ°æŠŠæ‰€æœ‰çš„é“¾æ¥è·‘å®Œ.æœ¬æ¬¡éœ€è¦é‡‡é›†çš„é“¾æ¥å¹¶ä¸å¤š,è´¨é‡è¦æ±‚ä¸é«˜,åªéœ€è¦æˆ‘é‡‡é›†åˆ°æ•°æ®å°±å¥½.</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯:</p>
<ol>
<li>éœ€è¦ä¸ºä½ çš„è¡¨å¢åŠ å”¯ä¸€é”®,ä¸ç„¶ä¼šæœ‰é‡å¤æ•°æ®</li>
<li>æ¯æ¡è¯·æ±‚æ·»åŠ <code>dont_filter=True</code>,ä¸ç„¶å»é‡ä¼šå½±å“çˆ¬å–</li>
</ol>
<p>æ·»åŠ <code>cookies</code>å’Œ<code>start_urls</code>ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># add cookies and start_urls to local_redis</span></div><div class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">if</span> local_redis.scard(<span class="string">'spider:cookies'</span>) &lt; <span class="number">10</span>:</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> cookies_list:</div><div class="line">            local_redis.sadd(<span class="string">'spider:cookies'</span>, i)</div><div class="line">        print(<span class="string">"cookies Done"</span>)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> local_redis.scard(<span class="string">'spider:start_urls'</span>) &lt; <span class="number">10</span>:</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> url_list:</div><div class="line">            local_redis.sadd(<span class="string">'spider:start_urls'</span>, i)</div><div class="line">        print(<span class="string">"start_urls Done"</span>)</div><div class="line">        </div><div class="line">    time.sleep(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<h1 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h1><p>æˆ‘æ˜¯ç”¨çš„æ˜¯ç¬¬ä¸‰ç§æ–¹æ³•,ç›®å‰çœ‹æ¥æ•ˆæœè¿˜è¡Œ,æ•°æ®å·²ç»çˆ¬å–äº†å¤§åŠ,ç›¸ä¿¡ä¸‰å¤©å‡è¿‡å»äº†åº”è¯¥å°±æ²¡é—®é¢˜äº†.</p>
<p>å¦‚æœä»¥åè¦é•¿æœŸåšè¿™ä¸ªé¡¹ç›®çš„è¯,æœ€å¥½çš„åŠæ³•åº”è¯¥è¿˜æ˜¯ç¬¬äºŒç§,ä»æ ¹æœ¬å»è§£å†³é—®é¢˜.</p>
<p>æœ¬æ¬¡åšè¿™ä¸ªé¡¹ç›®ä¹Ÿæ”¶è·é¢‡å¤š,å¯¹äº<code>cookies</code>ä½¿ç”¨æ›´åŠ æœ‰ç»éªŒ;æ„Ÿè§‰æœ€å¥½ç©çš„æ˜¯<code>token</code>çš„åŠ å¯†ä¸è§£å¯†å®ç°,å¯¹è¿™æ–¹é¢æ„Ÿå…´è¶£çš„å¯ä»¥äº†è§£ä¸‹è¿™ä¸ª: <a href="https://docs.python.org/3/library/zlib.html" target="_blank" rel="external">zlib â€” Compression compatible with gzip</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åäº”ç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç»ˆäºæœ‰æ–¹æ³•äº†  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/VD9q71g.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="cookieæ± " scheme="https://zhangslob.github.io/tags/cookie%E6%B1%A0/"/>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>ä»cookieæ± æ­å»ºè¯´èµ·</title>
    <link href="https://zhangslob.github.io/2018/06/14/%E4%BB%8Ecookie%E6%B1%A0%E6%90%AD%E5%BB%BA%E8%AF%B4%E8%B5%B7/"/>
    <id>https://zhangslob.github.io/2018/06/14/ä»cookieæ± æ­å»ºè¯´èµ·/</id>
    <published>2018-06-14T13:25:46.000Z</published>
    <updated>2018-06-14T14:33:09.507Z</updated>
    
    <content type="html"><![CDATA[<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åå››ç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>æˆ‘å¿«ç»æœ›äº†  (à¹‘â€¢ . â€¢à¹‘)</p>
<p><img src="https://i.imgur.com/ZJMuGd5.jpg" alt=""></p>
<a id="more"></a>
<p>è¿™å‡ å¤©æ¥æ‰‹äº†ä¸€ä¸ªå¾ˆæ€¥çš„é¡¹ç›®ï¼Œè¦åœ¨å‡ å¤©çˆ¬å–æŸç½‘ç«™çš„æ•°æ®ã€‚è¯¥ç«™æ˜¯æˆ‘çŸ¥é“å›½å†…åçˆ¬æ¯”è¾ƒä¸¥é‡çš„ç½‘ç«™ä¹‹ä¸€ï¼Œæˆ‘ä¹Ÿåšå¥½äº†å¿ƒç†å‡†å¤‡ã€‚</p>
<p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1528996797209&amp;di=3836d0c6faff25ec236862e1eae20486&amp;imgtype=0&amp;src=http%3A%2F%2Fkibey-echo.b0.upaiyun.com%2Fposter%2F2014%2F09%2F24%2Fbd9ba222cb5a1e9e.gif" alt=""></p>
<h1 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h1><p>è¯¥ç½‘ç«™æ•°æ®éœ€è¦ç™»å½•æ‰èƒ½æŸ¥çœ‹ï¼ŒAPPæŠ“åŒ…äº†ä½†æ˜¯æ²¡æœ‰å‘ç°ç›¸å…³æ•°æ®ï¼Œæ‰€ä»¥é€‰æ‹©ä»PCç«™å…¥æ‰‹ã€‚</p>
<p>æ—¢ç„¶éœ€è¦ç™»å½•ï¼Œé‚£å°±éœ€è¦éªŒè¯ä¸€ä¸ªæ–°é²œçš„<code>cookies</code>å¯ä»¥è®¿é—®å¤šå°‘é“¾æ¥ï¼›éªŒè¯æ–¹æ³•æ˜¯ï¼š</p>
<blockquote>
<p>ç›´æ¥æ‹·è´å·²ç»ç™»å½•è¯¥ç½‘ç«™è¯·æ±‚çš„Curlï¼Œè½¬æ¢ä¸ºPythonä»£ç ï¼ŒåŠ ä¸€ä¸ªå¾ªç¯ï¼Œæµ‹è¯•ï¼Œå•ä¸ªè´¦å·å¯ä»¥è·‘å¤šå°‘é¡µ</p>
</blockquote>
<p>ç»è¿‡10å¤šæ¬¡æµ‹è¯•ï¼Œå‘ç°å•ä¸ªCookieså¯ä»¥ä¸‹è½½ï¼Œè‡³å°‘50ä¸ªç½‘é¡µã€‚</p>
<p>é‚£ä¹ˆå°±å¾ˆå¥½åšäº†ï¼Œå¯ä»¥å¼€å§‹å†™æ€è·¯äº†ã€‚</p>
<p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1528996828313&amp;di=58be2c7592bc5f2f35ac0df4e513234f&amp;imgtype=0&amp;src=http%3A%2F%2Fcdnq.duitang.com%2Fuploads%2Fitem%2F201507%2F10%2F20150710172216_LtFrM.thumb.700_0.jpeg" alt=""></p>
<h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å¤šä¸ªå¯ä»¥ç™»å½•çš„Cookiesï¼Œç„¶ååˆ©ç”¨è¿™äº›Cookieså»ä¸‹è½½ç½‘é¡µï¼›ä¸€æ—¦è¿”å›çŠ¶æ€ç ä¸æ˜¯200ï¼Œå°±æ‹‰é»‘è¯¥Cookiesã€‚</p>
<p>å…·ä½“çš„æ–¹æ³•çœ‹ä¸‹å›¾ï¼š</p>
<p><img src="https://i.imgur.com/7uqitsi.png" alt=""></p>
<p>æœ‰å‡ ç‚¹è¯´æ˜ä¸‹ï¼š</p>
<ol>
<li><strong>å¦‚ä½•æ¨¡æ‹Ÿæ³¨å†Œ</strong>ã€‚æœ‰ä¸¤ç§æ–¹æ³•ï¼Œ<strong>æ¨¡æ‹Ÿè¯·æ±‚</strong>å’Œ<strong>æµè§ˆå™¨æ¨¡æ‹Ÿ</strong>ã€‚æ¨¡æ‹Ÿè¯·æ±‚å°±æ˜¯å»åˆ†ææ³¨å†Œè¿‡ç¨‹ä¸­çš„æ¯ä¸€æ­¥æ“ä½œï¼Œè¿™ä¸ªè¯·æ±‚æ˜¯å‘é€éªŒè¯ç çš„ï¼Œé‚£ä¸ªæ˜¯æ³¨å†Œçš„ï¼Œæˆ‘ä¼˜å…ˆæ¨èè¯¥æ–¹æ³•ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•é‡åˆ°ä¸€äº›æºå¸¦æœ‰å¤§é‡ç­¾åå‚æ•°çš„å˜æ€ç½‘ç«™æ—¶ï¼Œéš¾åº¦è¾ƒå¤§ï¼Œéœ€è¦è‡ªå·±ä¸€æ­¥æ­¥æ–­ç‚¹<code>JavaScript</code>ã€‚æµè§ˆå™¨æ¨¡æ‹Ÿå¤§å®¶åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼ŒPythonä¸­å°±æ˜¯<code>selenium</code>å‚»ç“œæ“ä½œï¼Œéœ€è¦å“ªé‡Œç‚¹å“ªé‡Œã€‚æ³¨æ„çš„å‘æ˜¯ä½•æ—¶åˆ‡æ¢<code>iframe</code></li>
<li><strong>Cookiesçš„æ­å»º</strong>ã€‚å…¶å®éå¸¸ç®€å•ï¼Œè¿™é‡Œåˆ©ç”¨äº†<code>redis</code>çš„é›†åˆï¼Œå–Cookiesä½¿ç”¨<code>spop</code>å³å¯ã€‚è¿™é‡Œå¹¶æ²¡æœ‰åšéªŒæ´»ï¼Œå› ä¸ºåŸºæœ¬ä¸ŠCookiesäº§ç”Ÿä¹‹åå°±ä¼šè¢«ä½¿ç”¨ã€‚</li>
</ol>
<h1 id="æˆ‘è¦å´©æºƒäº†"><a href="#æˆ‘è¦å´©æºƒäº†" class="headerlink" title="æˆ‘è¦å´©æºƒäº†"></a>æˆ‘è¦å´©æºƒäº†</h1><p>ä¸åšä¸çŸ¥é“ï¼Œä¸€åšå“ä¸€è·³ã€‚</p>
<p>ä½†æˆ‘ä»¥ä¸ºè¯¥ç½‘ç«™å¾ˆç®€å•ï¼Œæ­å»ºä¸€ä¸ªç®€å•çš„Cookiesæ± å°±å¯ä»¥è§£å†³ï¼Œä½†æ˜¯æˆ‘æ˜æ˜¾å¤ªå¹´è½»äº†ã€‚</p>
<p>æˆ‘å…ˆæŠŠé‡‡é›†é“¾æ¥æ¨åˆ°<code>redis</code>ä¸­ï¼Œä½¿ç”¨äº†<code>scrapy_redis</code>ã€‚</p>
<p>è¯¥ç½‘ç«™çš„åçˆ¬ï¼š</p>
<ol>
<li><strong>ä»£ç†é—®é¢˜</strong>ã€‚å…¶å®è¿™é‡Œæœ‰ä¸€ä¸ªæ‚–è®ºï¼Œåˆ°åº•è¯¥ä¸è¯¥ä½¿ç”¨ä»£ç†ã€‚é¦–å…ˆï¼Œæˆ‘ä¸ç”¨ä»£ç†ï¼Œåˆšå¼€å§‹è¿˜å¥½ï¼Œä½†æ˜¯å¾ˆå¿«æˆ‘çš„æœ¬åœ°ä»£ç†å°±è¢«æ‹‰é»‘äº†ï¼›é‚£å¥½ä¸Šä»£ç†ï¼Œä½†æ˜¯æ¥ä¸‹æ¥é—®é¢˜æ¥äº†ï¼Œå¼€å§‹å‡ºç°ä¸€ä¸ªä¸ªçš„éªŒè¯ç éœ€è¦å¡«äº†ï¼Œä½œä¸ºä¸€ä¸ª<strong>å•ç‹¬çš„ç”¨æˆ·</strong>ï¼Œæˆ‘æ˜¯ä¸å¯èƒ½é¢‘ç¹çš„æ”¹å˜è‡ªå·±çš„<code>IP</code>å»è®¿é—®ç½‘ç«™çš„ï¼Œè§£å†³æ–¹æ³•åªæœ‰ä¸€ä¸ªï¼ŒCookieså’Œä»£ç†ç»‘å®šï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•çœŸçš„ä¸å¥½å®ç°ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨<code>Scrapy</code>å¼€å‘çš„çˆ¬è™«ã€‚</li>
<li><strong>éªŒè¯ç é—®é¢˜</strong>ã€‚æ—¢ç„¶å‡ºç°äº†éªŒè¯ç ï¼Œé‚£å°±å»è§£å†³å®ƒã€‚éªŒè¯ç ä¸€èˆ¬æ˜¯å’ŒCookiesç»‘å®šçš„ï¼Œé‚£ä¹ˆæˆ‘éœ€è¦æŠŠè®¿é—®è¯¥è´¦å·çš„<code>IP</code>ã€<code>User-Agent</code>ã€<code>Cookies</code>å…¨éƒ¨æ‹¿å‡ºæ¥ï¼Œå†å»å‘é€æ–°çš„è¯·æ±‚ï¼Œè€Œä¸”éœ€è¦æ³¨æ„ï¼Œæ­¤è¿‡ç¨‹ä¸­ä¸èƒ½å†è¿›è¡Œ<code>IP</code>çš„å˜åŒ–ã€‚</li>
</ol>
<h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>ä»Šå¤©äº†å¤§æ¦‚ä¸¤å¤©çš„æ–—æ™ºæ–—å‹‡ï¼Œç°åœ¨åŸºæœ¬ä¸Šå¯ä»¥çˆ¬åˆ°æ•°æ®äº†ï¼Œå¸Œæœ›æ˜å¤©å¯ä»¥äº¤å·®ï¼Œä¸ç„¶ç«¯åˆå°±è¦åŠ ç­äº†ã€‚</p>
<p>å¸Œæœ›è¿™åªå°çŒ«å’ªå¯ä»¥ç»™æˆ‘å¸¦æ¥å¥½è¿œã€‚</p>
<p><img src="https://i.imgur.com/vWSjxX9.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åå››ç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘å¿«ç»æœ›äº†  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/ZJMuGd5.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="cookieæ± " scheme="https://zhangslob.github.io/tags/cookie%E6%B1%A0/"/>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºäº†çŸ¥é“èƒ¡æ­Œç²‰ä¸çš„ç”·å¥³æ¯”ç‡ï¼Œçˆ¬äº†ä¸‰ç™¾ä¸‡å¾®åšæ•°æ®</title>
    <link href="https://zhangslob.github.io/2018/06/07/%E8%83%A1%E6%AD%8C%E7%94%B7%E7%B2%89%E5%A4%9A%E8%BF%98%E6%98%AF%E5%A5%B3%E7%B2%89%E5%A4%9A-%E7%88%AC%E7%88%AC%E5%BE%AE%E5%8D%9A/"/>
    <id>https://zhangslob.github.io/2018/06/07/èƒ¡æ­Œç”·ç²‰å¤šè¿˜æ˜¯å¥³ç²‰å¤š-çˆ¬çˆ¬å¾®åš/</id>
    <published>2018-06-07T13:59:53.000Z</published>
    <updated>2018-06-10T08:04:50.610Z</updated>
    
    <content type="html"><![CDATA[<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åä¸‰ç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>è€èƒ¡å¥½å¸…  (à¹‘â€¢ . â€¢à¹‘)</p>
<p><img src="http://wx1.sinaimg.cn/large/48e837eely1fmhxeqwby0j22ds1sg157.jpg" alt=""></p>
<a id="more"></a>
<p>æœ€è¿‘å¶ç„¶é—´çœ‹åˆ°ä¸€æ¡æ–°é—»ï¼Œæ ‡é¢˜æ˜¯ï¼šâ€œèƒ¡æ­Œä½œä¸ºä¸€ä¸ªç”·æ€§æ˜æ˜Ÿï¼Œç”·ç²‰ä¸æ¯”å¥³ç²‰ä¸è¿˜å¤šï¼Œè¿™ä¸ç§‘å­¦ï¼â€</p>
<p><img src="https://i.imgur.com/959B59J.png" alt=""></p>
<p>æ–‡ä¸­è¿™æ ·è¯´é“â€œèƒ¡æ­Œåœ¨å¾®åšä¸Šçš„ç²‰ä¸å°±å·²ç»è¾¾åˆ°äº†5748.9398ä¸‡äººï¼Œå¹¶ä¸”é€šè¿‡æŸ¥çœ‹ç²‰ä¸å¯ä»¥å‘ç°è®¸å¤šéƒ½æ˜¯ç”·æ€§ç²‰ä¸ï¼Œè¿™ä¸å¾—ä¸è¯´è¿™æ˜¯ç‹¬ä¸€æ— äºŒäº†â€</p>
<p>å½“æ—¶æˆ‘å°±éœ‡æƒŠäº†ï¼Œâ€œé€šè¿‡æŸ¥çœ‹ç²‰ä¸â€ï¼Ÿï¼Ÿï¼Ÿè¿™æ˜¯ä»€ä¹ˆæ“ä½œï¼Œç°åœ¨çš„UCå°ç¼–è¶Šæ¥è¶Šå¤šäº†å—ï¼Ÿ</p>
<p>æˆ‘ä½œä¸ºä¸€åè€èƒ¡çš„ç²‰ä¸ï¼Œç®€ç›´æ˜¯ä¸èƒ½å¿ï¼Œè¿™å®Œå…¨æ˜¯åœ¨çå†™å•Šã€‚</p>
<p>æ‰€ä»¥æˆ‘æœ‰ä¸ªæƒ³æ³•ï¼ŒæŠŠèƒ¡æ­Œå¾®åšä¸Šå…­åƒä¸‡ç²‰ä¸æ•°æ®çˆ¬å–ä¸‹æ¥ï¼Œçœ‹çœ‹åˆ°åº•ç”·ç²‰ä¸å¤šè¿˜æ˜¯å¥³ç²‰ä¸å¤šã€‚</p>
<blockquote>
<p>å¤§å®¶å¯ä»¥åœ¨è‡ªå·±å¿ƒä¸­çŒœæµ‹ä¸€ä¸ªç­”æ¡ˆï¼Œåˆ°åº•ç”·ç²‰å¤šè¿˜æ˜¯å¥³ç²‰å¤šå‘¢ï½ï½ã€‚æˆ‘çš„ç­”æ¡ˆæ˜¯ç”·æ€§æ¯”è¾ƒå¤šã€‚</p>
</blockquote>
<h1 id="åˆ†æé—®é¢˜"><a href="#åˆ†æé—®é¢˜" class="headerlink" title="åˆ†æé—®é¢˜"></a>åˆ†æé—®é¢˜</h1><p><img src="https://i.imgur.com/h1TyXZ7.png" alt=""></p>
<p>è¿™é‡Œå¯ä»¥çœ‹åˆ°èƒ¡æ­Œå¾®åšç²‰ä¸æ€»æ•°çº¦6åƒä¸‡ï¼Œæœ¬æ¬¡æˆ‘çš„ç›®æ ‡å°±æ˜¯å°½åŠ›å»æ‰¾åˆ°èƒ¡æ­Œ<strong>æ´»è·ƒç²‰ä¸</strong>çš„ç”·å¥³æ¯”ä¾‹ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬çŸ¥é“å¾®åšæ˜¯æœ‰é™åˆ¶çš„ï¼Œå¾®åšä¸ä¼šæŠŠæ‰€æœ‰æ•°æ®éƒ½å±•ç¤ºå‡ºæ¥ï¼Œå¦‚å›¾</p>
<p><img src="https://i.imgur.com/UxASfy6.png" alt=""></p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘è¦æ€æ ·æ‰èƒ½å°½å¯èƒ½å¤šçš„æŠ“åˆ°ç²‰ä¸æ•°æ®ï¼Ÿ</p>
<p>è¿™é‡Œæˆ‘å°±æƒ³è¦å°½å¯èƒ½å¤šçš„æŠ“å–åˆ°è€èƒ¡çš„æ´»è·ƒç²‰ä¸ï¼Œ æ‰€è°“æ´»è·ƒç²‰ä¸ï¼ŒæŒ‡çš„æ˜¯é™¤å»â€œä¸è½¬å‘ã€ä¸è¯„è®ºã€ä¸ç‚¹èµâ€è¿™äº›â€œä¸‰ä¸â€ç”¨æˆ·ï¼Œæ˜¯æ´»è·ƒçš„ã€æœ‰å‚ä¸çš„ç”¨æˆ·ã€‚è¿™äº›ç”¨æˆ·æ‰æ˜¯çœŸæ­£æœ‰ä»·å€¼çš„ï¼Œæ­£å¥½å»é™¤äº†åƒµå°¸ç²‰ã€‚</p>
<h1 id="ä¸¤ç§æ€è·¯"><a href="#ä¸¤ç§æ€è·¯" class="headerlink" title="ä¸¤ç§æ€è·¯"></a>ä¸¤ç§æ€è·¯</h1><p>é‡‡é›†å¾®åšç²‰ä¸ï¼Œç›®å‰æˆ‘æœ‰ä¸¤ç§æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œï¼š</p>
<ol>
<li>å…¨é‡é‡‡é›†ã€‚é‡‡é›†å¾®åšæ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼ŒåŒ…æ‹¬å…³æ³¨ã€ç²‰ä¸ç­‰ã€‚é€šè¿‡ç²‰ä¸çš„ç²‰ä¸ã€å…³æ³¨çš„å…³æ³¨ã€ç”¨æˆ·åˆ†ç±»ã€æ¨èç­‰ç­‰å„ç§æ–¹æ³•æ‹¿åˆ°å¾®åšå…¨é‡ç”¨æˆ·æ•°æ®ã€‚</li>
<li>é‡‡æ ·ã€‚é‡‡é›†èƒ¡æ­Œçš„æ‰€æœ‰å¾®åšä¸‹æœ‰è¯„è®ºã€ç‚¹èµã€è½¬å‘çš„ç”¨æˆ·ï¼Œå‡¡æ˜¯æœ‰å‚ä¸è¿‡çš„äº²å¯†å€¼åŠ ä¸€ï¼Œå½“è¿™ä¸ªå€¼è¶…è¿‡ä¸€å®šé™åº¦æ—¶ï¼ˆæ¯”å¦‚è¯´5æˆ–è€…10ï¼‰ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¯¥ç”¨æˆ·æ˜¯èƒ¡æ­Œçš„ç²‰ä¸ã€‚</li>
</ol>
<p>æƒ³äº†æƒ³ï¼Œç¬¬ä¸€ç§æ–¹æ³•çŸ­æ—¶é—´å†…æ˜¯ä¸ç°å®çš„ï¼Œæ–¹æ³•2å€’æ˜¯å¯ä»¥å°è¯•ä¸€æ³¢ã€‚</p>
<h1 id="çˆ¬è™«é€»è¾‘"><a href="#çˆ¬è™«é€»è¾‘" class="headerlink" title="çˆ¬è™«é€»è¾‘"></a>çˆ¬è™«é€»è¾‘</h1><p>çˆ¬è™«åˆ†ä¸ºä¸‰æ­¥ï¼š</p>
<ol>
<li>é‡‡é›†èƒ¡æ­Œæ‰€æœ‰å¾®åš</li>
<li>é‡‡é›†æ¯æ¡å¾®åšçš„ä¸‰ç±»æ•°æ®ï¼ˆè½¬å‘ã€è¯„è®ºã€ç‚¹èµï¼‰</li>
<li>æ•°æ®æ¸…æ´—</li>
</ol>
<p>å¥½äº†ï¼Œç°åœ¨å·²ç»éå¸¸æ¸…æ™°äº†ï¼Œä¸‹é¢å°±å¼€å§‹å»å¯»æ‰¾çˆ¬å–æ–¹æ³•ã€‚</p>
<h1 id="å¾®åšæ¥å£"><a href="#å¾®åšæ¥å£" class="headerlink" title="å¾®åšæ¥å£"></a>å¾®åšæ¥å£</h1><p>æ ¹æ®ä»¥å¾€çš„ç»éªŒï¼Œweibo.cn å’Œ m.weibo.cn æ˜¯æœ€ç®€å•çˆ¬å–çš„ï¼Œweibo.com æ˜¯æœ€éš¾çš„ã€‚è¿™æ¬¡æˆ‘ä»¬ä» m.weibo.cn å…¥æ‰‹ï¼Œåˆ†æå¯ä»¥å¾—åˆ°èƒ¡æ­Œå¾®åšçš„æ¥å£ï¼Œè€Œä¸”æ˜¯æ— éœ€ç™»å½•çš„ï¼ï¼ï¼å¾ˆé‡è¦ã€‚å…¶ä»–å…¥å£éƒ½éœ€è¦è§£å†³ç™»å½•éš¾é¢˜ï¼</p>
<p><code>https://m.weibo.cn/api/container/getIndex?containerid=1076031223178222&amp;page={}</code></p>
<p>è¿”å›æ•°æ®ï¼š</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function">cardlistInfo: &#123;</span></div><div class="line"><span class="title">containerid</span>: "1076031223178222",</div><div class="line"><span class="title">v_p</span>: 42,</div><div class="line"><span class="title">show_style</span>: 1,</div><div class="line"><span class="title">total</span>: 3643,</div><div class="line"><span class="title">page</span>: 2</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<p>è¿™é‡Œå‘Šè¯‰æˆ‘ä»¬æ€»å…±æœ‰3643æ¡æ•°æ®ï¼Œæ¯é¡µ10æ¡ï¼Œé‚£ä¹ˆç¿»é¡µå°±å¾ˆæ¸…æ™°äº†ã€‚</p>
<h2 id="å…¶ä»–æ¥å£"><a href="#å…¶ä»–æ¥å£" class="headerlink" title="å…¶ä»–æ¥å£"></a>å…¶ä»–æ¥å£</h2><figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">è½¬å‘ï¼šhttps://m.weibo.cn/api/statuses/repostTimeline?id=<span class="number">4238119278366780</span>&amp;page=&#123;&#125;</div><div class="line"></div><div class="line">è¯„è®ºï¼šhttps://m.weibo.cn/api/comments/show?id=<span class="number">4238119278366780</span>&amp;page=&#123;&#125;</div><div class="line"></div><div class="line">ç‚¹èµï¼šhttps://m.weibo.cn/api/attitudes/show?id=<span class="number">4238119278366780</span>&amp;page=&#123;&#125;</div></pre></td></tr></table></figure>
<p>ï¼ˆæƒ³è¦çˆ¬å…¶ä»–äººï¼Œæ›¿æ¢è¿™é‡Œçš„idå³å¯ï¼‰</p>
<p>æš‚æ—¶ä¸æ¸…æ¥šæ€»å…±æœ‰å¤šå°‘é¡µï¼Œè™½ç„¶è¿”å›çš„æ•°æ®ä¸­æœ‰ <code>total_number</code> ï¼Œä½†æ˜¯æ­¤æ•°å­—å¹¶ä¸å‡†ç¡®ï¼Œè¿˜éœ€è¦æ›´å¤šæµ‹è¯•ã€‚</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function">total_number: 19526897,</span></div><div class="line"><span class="title">hot_total_number</span>: 0,</div><div class="line"><span class="title">max</span>: 1952690</div></pre></td></tr></table></figure>
<p>ï¼ˆç®€å•æµ‹åå‘ç°æ€»é¡µæ•°ä¸º<code>total_number//55</code>ï¼‰</p>
<h2 id="é‡‡é›†ç”¨æˆ·ä¿¡æ¯æ¥å£"><a href="#é‡‡é›†ç”¨æˆ·ä¿¡æ¯æ¥å£" class="headerlink" title="é‡‡é›†ç”¨æˆ·ä¿¡æ¯æ¥å£"></a>é‡‡é›†ç”¨æˆ·ä¿¡æ¯æ¥å£</h2><p><code>https://m.weibo.cn/api/container/getIndex?type=uid&amp;value=6114792181</code></p>
<p>å…¶å®ä¸éœ€è¦è¿™ä¸€æ¬¡è¯·æ±‚ï¼Œå› ä¸ºåœ¨è½¬å‘æ¥å£ä¸­å·²ç»æœ‰æˆ‘ä»¬æƒ³è¦çš„æ•°æ®äº†ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function">user: &#123;</span></div><div class="line"><span class="title">id</span>: 6431898981,</div><div class="line"><span class="title">screen_name</span>: "è±ªæ°”<span class="title">superiority</span>",</div><div class="line"><span class="title">profile_image_url</span>: "<span class="title">https</span>://<span class="title">tvax2.sinaimg.cn</span>/<span class="title">crop</span>.9.0.220.220.180/0071<span class="title">hAK9ly8fmdxpea2vxj306n064glj.jpg</span>",</div><div class="line"><span class="title">profile_url</span>: "<span class="title">https</span>://<span class="title">m.weibo.cn</span>/<span class="title">u</span>/6431898981?<span class="title">uid</span>=6431898981&amp;<span class="title">featurecode</span>=20000320",</div><div class="line"><span class="title">statuses_count</span>: 7255,</div><div class="line"><span class="title">verified</span>: <span class="title">false</span>,</div><div class="line"><span class="title">verified_type</span>: -1,</div><div class="line"><span class="title">close_blue_v</span>: <span class="title">false</span>,</div><div class="line"><span class="title">description</span>: "",</div><div class="line"><span class="title">gender</span>: "<span class="title">m</span>",</div><div class="line"><span class="title">mbtype</span>: 0,</div><div class="line"><span class="title">urank</span>: 4,</div><div class="line"><span class="title">mbrank</span>: 0,</div><div class="line"><span class="title">follow_me</span>: <span class="title">false</span>,</div><div class="line"><span class="title">following</span>: <span class="title">false</span>,</div><div class="line"><span class="title">followers_count</span>: 2,</div><div class="line"><span class="title">follow_count</span>: 62,</div><div class="line"><span class="title">cover_image_phone</span>: "<span class="title">https</span>://<span class="title">tva1.sinaimg.cn</span>/<span class="title">crop</span>.0.0.640.640.640/549<span class="title">d0121tw1egm1kjly3jj20hs0hsq4f.jpg</span>",</div><div class="line"><span class="title">avatar_hd</span>: "<span class="title">https</span>://<span class="title">wx2.sinaimg.cn</span>/<span class="title">orj480</span>/0071<span class="title">hAK9ly8fmdxpea2vxj306n064glj.jpg</span>",</div><div class="line"><span class="title">like</span>: <span class="title">false</span>,</div><div class="line"><span class="title">like_me</span>: <span class="title">false</span>,</div><div class="line"><span class="title">badge</span>: &#123;</div><div class="line"><span class="title">user_name_certificate</span>: 1,</div><div class="line"><span class="title">wenchuan_10th</span>: 1</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¾ˆè›‹ç–¼çš„æ˜¯ï¼Œç‚¹èµå’Œè¯„è®ºæ¥å£ä¸­å¹¶æ²¡æœ‰ç›¸å…³æ•°æ®ï¼Œæ‰€ä»¥ç‚¹èµå’Œè¯„è®ºéƒ¨åˆ†è¦é‡æ–°çˆ¬å–ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"><span class="function">id: 4247512245791226,</span></div><div class="line"><span class="title">created_at</span>: "5åˆ†é’Ÿå‰",</div><div class="line"><span class="title">source</span>: "å¾®åš <span class="title">weibo.com</span>",</div><div class="line"><span class="title">user</span>: &#123;</div><div class="line"><span class="title">id</span>: 6114792181,</div><div class="line"><span class="title">screen_name</span>: "<span class="title">Ming_54456</span>",</div><div class="line"><span class="title">profile_image_url</span>: "<span class="title">https</span>://<span class="title">tvax1.sinaimg.cn</span>/<span class="title">crop</span>.367.164.918.918.180/006<span class="title">FP2Mlly8fjs2mf3x6pj319x0yoqbo.jpg</span>",</div><div class="line"><span class="title">verified</span>: <span class="title">false</span>,</div><div class="line"><span class="title">verified_type</span>: -1,</div><div class="line"><span class="title">mbtype</span>: 12,</div><div class="line"><span class="title">profile_url</span>: "<span class="title">https</span>://<span class="title">m.weibo.cn</span>/<span class="title">u</span>/6114792181?<span class="title">uid</span>=6114792181&amp;<span class="title">featurecode</span>=20000320",</div><div class="line"><span class="title">remark</span>: "",</div><div class="line"><span class="title">following</span>: <span class="title">false</span>,</div><div class="line"><span class="title">follow_me</span>: <span class="title">false</span></div><div class="line">&#125;</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<p>å¾®åšå®˜æ–¹APIåŒæ ·æä¾›ç›¸åº”æ•°æ® ï¼Œå»ºè®®ä½¿ç”¨å‰ä»”ç»†é˜…è¯» <a href="http://open.weibo.com/wiki/Rate-limiting" target="_blank" rel="external">æ¥å£è®¿é—®é¢‘æ¬¡æƒé™</a></p>
<h1 id="çˆ¬è™«ä»£ç "><a href="#çˆ¬è™«ä»£ç " class="headerlink" title="çˆ¬è™«ä»£ç "></a>çˆ¬è™«ä»£ç </h1><p>çˆ¬è™«å®Œæ•´ä»£ç å¯ä»¥å»æˆ‘çš„å…¬ä¼—å·ï¼ˆPythonçˆ¬è™«ä¸ç®—æ³•è¿›é˜¶ï¼‰ï¼Œå›å¤â€œå¾®åšâ€è·å¾—ã€‚</p>
<p>çˆ¬è™«è¯­è¨€æ˜¯Python3ï¼Œä½¿ç”¨Scrapyæ¡†æ¶ï¼Œæ•°æ®ä¿å­˜åœ¨mongoï¼Œæ²¡æœ‰ä½¿ç”¨åˆ†å¸ƒå¼ï¼Œå•æœº3å¤©è·‘å®Œã€‚</p>
<p>å› ä¸ºå¾®åšçš„åçˆ¬ï¼Œéœ€è¦å¤§é‡ä»£ç†æ”¯æ’‘ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># code is far away from bugs with the god animal protecting</span></div><div class="line">    I love animals. They taste delicious.</div><div class="line">              â”â”“      â”â”“</div><div class="line">            â”â”›â”»â”â”â”â”›â”»â”“</div><div class="line">            â”ƒ      â˜ƒ      â”ƒ</div><div class="line">            â”ƒ  â”³â”›  â”—â”³  â”ƒ</div><div class="line">            â”ƒ      â”»      â”ƒ</div><div class="line">            â”—â”â”“      â”â”â”›</div><div class="line">                â”ƒ      â”—â”â”â”â”“</div><div class="line">                â”ƒ  ç¥å…½ä¿ä½‘    â”£â”“</div><div class="line">                â”ƒã€€æ°¸æ— BUGï¼   â”â”›</div><div class="line">                â”—â”“â”“â”â”â”³â”“â”â”›</div><div class="line">                  â”ƒâ”«â”«  â”ƒâ”«â”«</div><div class="line">                  â”—â”»â”›  â”—â”»â”›</div></pre></td></tr></table></figure>
<p>çˆ¬å–çš„æ•°æ®å®ä¾‹ï¼š</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    "_id" : ObjectId("<span class="number">5</span>b162d10e0eafb1d6e63b460"),</div><div class="line">    "id" : NumberLong(<span class="number">5372682651</span>),</div><div class="line">    "statuses_count" : <span class="number">10599</span>,</div><div class="line">    "screen_name" : "ç”¨æˆ·<span class="number">5372682651</span>",</div><div class="line">    "profile_url" : "https://m.weibo.cn/u/<span class="number">5372682651</span>?uid=<span class="number">5372682651</span>",</div><div class="line">    "description" : "æš‚æ— æ•°æ®",</div><div class="line">    "gender" : "f",</div><div class="line">    "followers_count" : <span class="number">80</span>,</div><div class="line">    "follow_count" : <span class="number">1060</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="ç®€å•æ•°æ®æ¸…æ´—"><a href="#ç®€å•æ•°æ®æ¸…æ´—" class="headerlink" title="ç®€å•æ•°æ®æ¸…æ´—"></a>ç®€å•æ•°æ®æ¸…æ´—</h1><p>æœ€ç»ˆè·‘å®Œä¸€æ¬¡çˆ¬åˆ°çš„æ•°æ®æœ‰<code>3889285</code>ï¼Œå› ä¸ºæœ‰å¤§é‡é¡µé¢ä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œå¯¹è¿™äº›è¯·æ±‚åšä¸€ä¸ªé‡è¯•æ•ˆæœä¼šå¥½äº›ã€‚</p>
<p>æ•°æ®æ¸…æ´—å¯¹æˆ‘æ¥è¯´çœŸçš„æ˜¯ä¸ªå¤´ç–¼çš„é—®é¢˜ï¼Œæ‰¾äº†å¾ˆå¤šç›¸å…³èµ„æ–™ï¼Œæœ€åä½¿ç”¨äº†mongoçš„<code>aggregate</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œä¸‹é¢æ˜¯ä»£ç ï¼š</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">db.getCollection('Weibo').aggregate(</div><div class="line">    [</div><div class="line">        &#123;"$group" : &#123;_id:&#123;id:"$id",gender:"$gender"&#125;, count:&#123;$sum:<span class="number">1</span>&#125;&#125;&#125;,</div><div class="line">        &#123;$sort:&#123;"count":-<span class="number">1</span>&#125;&#125;,</div><div class="line">        &#123; $out:"result"&#125;,</div><div class="line">    ],</div><div class="line">    &#123;</div><div class="line"><span class="function">      allowDiskUse:<span class="title">true</span>,</span></div><div class="line">      <span class="title">cursor</span>:&#123;&#125;</div><div class="line">    &#125;  </div><div class="line">)</div></pre></td></tr></table></figure>
<p>ç»“æœäº§ç”Ÿäº†ä¸€å¼ æ–°çš„è¡¨ï¼Œå¯¹æ¯ä¸ªIDè¿›è¡Œç»Ÿè®¡ï¼Œå¹¶æ’åºï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    "_id" : &#123;</div><div class="line">        "id" : NumberLong(<span class="number">5737668415</span>),</div><div class="line">        "gender" : "f"</div><div class="line">    &#125;,</div><div class="line">    "count" : <span class="number">106701</span>.<span class="number">0</span></div><div class="line">&#125;</div><div class="line">&#123;</div><div class="line">    "_id" : &#123;</div><div class="line">        "id" : NumberLong(<span class="number">5909154992</span>),</div><div class="line">        "gender" : "m"</div><div class="line">    &#125;,</div><div class="line">    "count" : <span class="number">72298</span>.<span class="number">0</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å‚ä¸æ¬¡æ•°è¾¾åˆ°åä¸‡æ¬¡ï¼Œå¤©å‘ï¼Œè¶…çº§çœŸçˆ±ç²‰ï¼Œ<a href="https://m.weibo.cn/u/5737668415?uid=5737668415" target="_blank" rel="external">ç¼˜æ¥æ˜¯å¥¹</a>ï¼Œç–¯ç‹‚åˆ·å±æœ‰æ²¡æœ‰</p>
<p><img src="http://p8eyj0cpn.bkt.clouddn.com/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20180607110639.png" alt=""></p>
<p>å¥½äº†ï¼Œç°åœ¨å¼€å§‹çœ‹çœ‹çœŸæ­£çš„æ•°æ®å§ã€‚</p>
<p>æœ¬æ¬¡å…±é‡‡é›†ç”¨æˆ·æ•°æ®<code>3889285</code>æ¡ï¼Œï¼ŒåŸå§‹æ•°æ®ä¸­ç”·æ€§å æ¯”<code>%33.68</code>ï¼Œå¥³æ€§å æ¯”<code>%66.32</code>ï¼Œå¥½å§ï¼Œçœ‹æ¥å¥³æ€§ç²‰ä¸æ›´å¤šï¼›å»é‡ä¹‹åæ•°æ®å…±æœ‰<code>1129035</code>ï¼Œç”·æ€§å æ¯”<code>%29.58</code>ï¼Œå¥³æ€§å æ¯”<code>%70.42</code>ï¼Œæ€ä¹ˆçœ‹ç€å¥³æ€§ç²‰ä¸è¿˜æ˜¯æ›´å¤šå‘¢ã€‚ã€‚</p>
<p>æˆ‘ä»¬å†æ¥è®¡ç®—ä¸€ä¸ªæ•°æ®ï¼Œäº²å¯†åº¦å¤§äº10çš„ç²‰ä¸å…±æœ‰<code>16486</code>ä½ï¼Œå…¶ä¸­ç”·æ€§å æ¯”<code>%24.05</code>ï¼Œå¥³æ€§å æ¯”<code>%75.95</code>ï¼Œäºæ˜¯æœ‰ä¸‹é¢è¿™å¼ è¡¨æ ¼ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">äº²å¯†åº¦</th>
<th>ç”·æ€§å æ¯”</th>
<th>å¥³æ€§å æ¯”</th>
<th>ç²‰ä¸æ€»æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">å¤§äº0</td>
<td>29.58%</td>
<td>70.42%</td>
<td>1129035</td>
</tr>
<tr>
<td style="text-align:left">å¤§äº10</td>
<td>24.05%</td>
<td>75.95%</td>
<td>16486</td>
</tr>
<tr>
<td style="text-align:left">å¤§äº50</td>
<td>32.77%</td>
<td>67.23%</td>
<td>4285</td>
</tr>
<tr>
<td style="text-align:left">å¤§äº100</td>
<td>36.77%</td>
<td>63.23%</td>
<td>2578</td>
</tr>
<tr>
<td style="text-align:left">å¤§äº1000</td>
<td>40.18%</td>
<td>59.82%</td>
<td>331</td>
</tr>
<tr>
<td style="text-align:left">å¤§äº10000</td>
<td>37.5%</td>
<td>62.5%</td>
<td>24</td>
</tr>
<tr>
<td style="text-align:left">Top10</td>
<td>30.00%</td>
<td>70.00%</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>è¿™ä¸ªæ•°æ®æŒºæœ‰æ„æ€çš„ï¼Œç”»å¼ è¡¨ç§ç§</p>
<p><img src="https://i.loli.net/2018/06/10/5b1cd33ba3031.png" alt=""></p>
<p>ç²‰ä¸æ˜µç§°è¯äº‘</p>
<p><img src="https://i.loli.net/2018/06/10/5b1cd793e1520.png" alt=""></p>
<p>ï¼ˆæ„Ÿè°¢BDPï¼‰</p>
<h1 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h1><p>çœ‹äº†è¿™äº›æ•°æ®ï¼Œç›¸ä¿¡å¤§å®¶è‡ªå·±å¿ƒä¸­å·²ç»æœ‰äº†ç­”æ¡ˆã€‚</p>
<p>èƒ¡æ­Œä½œä¸ºä¸€ä¸ªç‰æ ‘ä¸´é£ã€ è‹±ä¿Šæ½‡æ´’ã€ é£æµå€œå‚¥ã€ ä¸€è¡¨äººæ‰ã€ é«˜å¤§å¨çŒ›ã€ æ°”å®‡ä¸å‡¡ã€ æ¸©æ–‡å°”é›…ã€ å“è²Œéå‡¡ã€ ä»ªè¡¨ä¸å‡¡çš„ç”·äººï¼Œå¥³ç²‰ä¸æ¯”è¾ƒå¤šæ˜¯å¾ˆæ­£å¸¸çš„ã€‚ä½†æ˜¯ä¸ºå•¥å¤§å®¶éƒ½ä¼šæœ‰ä¸€ç§ç”·ç²‰ä¸æ¯”å¥³ç²‰ä¸å¤šçš„é”™è§‰å‘¢ï¼Œæˆ‘è§‰å¾—æ˜¯å¯¹æ¯”äº§ç”Ÿçš„æ„Ÿè§‰ã€‚æˆ‘æ‹¿èƒ¡æ­Œä¸å…¶ä»–å°é²œè‚‰ä½œå¯¹æ¯”ï¼Œè‚¯å®šä¼šè·Ÿæ¬£èµèƒ¡æ­Œã€‚ä½ è¯´å‘¢ï¼Ÿ</p>
<p>æœ¬æ–‡å¹¶ä¸æ˜¯ä¸ºäº†è¯æ˜ä»€ä¹ˆï¼Œåªæ˜¯ä½œä¸ºä¸€åæ™®é€šç²‰ä¸æƒ³å»çœ‹çœ‹æ›´å¤šä¸œè¥¿ã€‚å…¶å®æœ¬æ¬¡æ•°æ®çˆ¬å–æœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦ä¼˜åŒ–ï¼Œå¤§å®¶ä¸ç”¨å¤ªè¿‡å½“çœŸã€‚å¦‚æœä½ æœ‰æ›´å¥½çš„åˆ†ææ•°æ®çš„æƒ³æ³•ï¼Œå¯ä»¥è”ç³»æˆ‘ã€‚</p>
<blockquote>
<p>è€å¤§é•‡æ¥¼</p>
</blockquote>
<p><img src="http://wx1.sinaimg.cn/large/48e837eegy1fe2dmkfsquj21tq1tqu0x.jpg" alt=""></p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åä¸‰ç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è€èƒ¡å¥½å¸…  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://wx1.sinaimg.cn/large/48e837eely1fmhxeqwby0j22ds1sg157.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="èƒ¡æ­Œ" scheme="https://zhangslob.github.io/tags/%E8%83%A1%E6%AD%8C/"/>
    
      <category term="å¾®åš" scheme="https://zhangslob.github.io/tags/%E5%BE%AE%E5%8D%9A/"/>
    
  </entry>
  
  <entry>
    <title>zsh(+fish)=å®Œç¾ç»ˆç«¯</title>
    <link href="https://zhangslob.github.io/2018/06/05/zsh-fish-%E5%AE%8C%E7%BE%8E%E7%BB%88%E7%AB%AF/"/>
    <id>https://zhangslob.github.io/2018/06/05/zsh-fish-å®Œç¾ç»ˆç«¯/</id>
    <published>2018-06-05T14:27:23.000Z</published>
    <updated>2018-06-05T14:35:15.770Z</updated>
    
    <content type="html"><![CDATA[<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åäºŒç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>å¥½çœ‹ã€å¥½ç”¨  (à¹‘â€¢ . â€¢à¹‘)</p>
<p><img src="http://p8eyj0cpn.bkt.clouddn.com/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20180605191928.png" alt=""></p>
<a id="more"></a>
<p>è‡ªä»ç”¨äº†æ·±åº¦ï¼Œæœ‰ä¸€ä¸ªéå¸¸æ˜æ˜¾çš„å˜åŒ–å°±æ˜¯ç»ˆç«¯çš„æ”¹å˜ï¼Œå®åœ¨æ˜¯æ¯”windowsçš„å¥½ç”¨ä¸€ç™¾å€ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨ä¸€äº›å·¥å…·ã€‚ä¸‹é¢è¯´è¯´æˆ‘ç°åœ¨çš„é…ç½®ã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼Œæ˜¯æˆ‘ç›®å‰æ­£åœ¨ä½¿ç”¨çš„ç»ˆç«¯ï¼Œé›†æˆäº†zshå’Œfishçš„åŠŸèƒ½ï¼Œç›®å‰ç”¨ç€æœ€é¡ºæ‰‹çš„ã€‚</p>
<p><img src="http://p8eyj0cpn.bkt.clouddn.com/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20180605190132.png" alt=""></p>
<p><a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="external">https://github.com/robbyrussell/oh-my-zsh</a></p>
<h1 id="å®‰è£…zsh"><a href="#å®‰è£…zsh" class="headerlink" title="å®‰è£…zsh"></a>å®‰è£…zsh</h1><p>ä¸€èˆ¬æ¥è¯´ï¼Œç›´æ¥è¿è¡Œ<code>sudo apt-get install zsh</code>å³å¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸‹è½½æº<a href="http://zsh.sourceforge.net/Arc/source.html" target="_blank" rel="external">Download zsh source</a>ï¼Œä½¿ç”¨curlå®‰è£…<code>curl -L &lt;https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh&gt; | sh</code></p>
<p>æŠŠ<code>zsh</code>è®¾ç½®ä¸ºé»˜è®¤ç»ˆç«¯<code>chsh -s $(which zsh)</code></p>
<p>æ›´å¤šç»†èŠ‚å‚è€ƒ<a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Installing-ZSH" target="_blank" rel="external">Installing ZSH</a></p>
<p>å…ˆæ¬£èµä¸‹<code>zsh</code>çš„æ•ˆæœã€‚æ¥è‡ªå®˜ç½‘</p>
<p><img src="https://i.imgur.com/hLnYQUr.jpg" alt=""></p>
<p><img src="https://i.imgur.com/DHJp9Zy.jpg" alt=""></p>
<p><img src="https://i.imgur.com/EA7m7Ln.jpg" alt=""></p>
<h1 id="ä¿®æ”¹zshä¸»é¢˜"><a href="#ä¿®æ”¹zshä¸»é¢˜" class="headerlink" title="ä¿®æ”¹zshä¸»é¢˜"></a>ä¿®æ”¹zshä¸»é¢˜</h1><p><code>vi ~/.zshrc</code>ï¼Œç„¶åæ‰¾åˆ°<code>ZSH_THEME</code>ï¼Œé»˜è®¤çš„æ˜¯<code>ZSH_THEME=robbyrussell</code>ï¼Œå°±åƒæˆ‘è¿™æ ·ï¼Œå› ä¸ºæˆ‘è¿™é‡Œç”¨çš„æ˜¯æ·±åº¦ç»ˆç«¯ï¼Œè€Œä¸”ä¹Ÿä¿®æ”¹äº†ç»ˆç«¯ä¸»é¢˜</p>
<p><img src="http://p8eyj0cpn.bkt.clouddn.com/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20180605191149.png" alt=""></p>
<p>å½“ç„¶ï¼Œä½ å¯ä»¥æ¥è¿™é‡Œçœ‹çœ‹ï¼Œé€‰ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„ä¸»é¢˜ <a href="https://github.com/robbyrussell/oh-my-zsh/wiki/themes" target="_blank" rel="external">Themes</a></p>
<p><img src="https://cloud.githubusercontent.com/assets/2618447/6316862/70f58fb6-ba03-11e4-82c9-c083bf9a6574.png" alt=""></p>
<p><code>agnoster</code>ä¹Ÿå¾ˆå¥½çœ‹ã€‚</p>
<p>æ®è¯´å¤§ç¥éƒ½ç”¨<code>random</code>ï¼Œæ˜¯çœŸçš„å—ï¼Ÿ</p>
<h1 id="å®‰è£…-fish"><a href="#å®‰è£…-fish" class="headerlink" title="å®‰è£… fish"></a>å®‰è£… fish</h1><p>æœ‰å¥è¯è¿™æ ·è¯´</p>
<blockquote>
<p>äºŒé€¼é’å¹´ç”¨ bashï¼Œæ™®é€šé’å¹´ç”¨ zshï¼Œæ–‡è‰ºé’å¹´ç”¨ <a href="http://fishshell.com/" target="_blank" rel="external">fish</a></p>
</blockquote>
<p>æˆ‘æœ€å–œæ¬¢ <code>fish</code>çš„ä¸€ç‚¹å°±æ˜¯ <strong>æ ¹æ®å†å²è¾“å…¥è‡ªåŠ¨è¡¥å…¨</strong>ï¼Œæ¥çœ‹å›¾ï¼Œåªè¦æ˜¯å†å²æœ‰è¾“å…¥çš„ï¼Œéƒ½ä¼šæœ‰è®°å½•æœ‰æç¤ºï¼Œå¯¹äºä¸€äº›å¾ˆé•¿çš„å‘½ä»¤ï¼Œç®€ç›´è¶…çº§çˆ½ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹åŠ¨å¤åˆ¶ç²˜è´´äº†ã€‚</p>
<p><img src="http://p8eyj0cpn.bkt.clouddn.com/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20180605191928.png" alt=""></p>
<p>ä½†æ˜¯<code>fish</code>å’Œ<code>zsh</code>å¥½åƒä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ’ä»¶å¯ä»¥åœ¨<code>zsh</code>ä¸Šè¾¾åˆ°å’Œ<code>fish</code>åŒæ ·çš„æ•ˆæœã€‚</p>
<p>åœ°å€åœ¨è¿™é‡Œ <a href="https://github.com/zsh-users/zsh-autosuggestions" target="_blank" rel="external"><strong>zsh-autosuggestions</strong></a></p>
<p>é¦–å…ˆä¸‹è½½ä¸‹æ¥</p>
<p><code>git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions</code></p>
<p>ç„¶å<code>vi ~/.zshrc</code>ï¼Œæ·»åŠ <code>zsh-autosuggestions</code>åˆ°pluginsä¸­ï¼Œ<code>git</code>æ˜¯é»˜è®¤å°±æœ‰çš„ã€‚ç„¶åæ–°æ‰“å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œå°±å¯ä»¥è¾¾åˆ°<code>fish</code>æœ‰çš„ä½ æ˜¯æç¤ºåŠŸèƒ½äº†ã€‚</p>
<p><img src="http://p8eyj0cpn.bkt.clouddn.com/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20180605193558.png" alt=""></p>
<p>è¿˜å¯ä»¥å®‰è£…è¯­æ³•é«˜äº®æ’ä»¶ <a href="https://github.com/zsh-users/zsh-syntax-highlighting" target="_blank" rel="external">zsh-syntax-highlighting</a>ï¼Œå®‰è£…æ–¹æ³•å’Œä¸Šé¢çš„ä¸€æ ·ï¼Œåœ¨pluginsä¸­æ·»åŠ <code>zsh-syntax-highlighting</code>å³å¯ã€‚</p>
<p>è¿™äº›æ˜¯æˆ‘ç›®å‰å‘ç°çš„æ¯”è¾ƒå¥½ç”¨çš„æ’ä»¶å’Œå·¥å…·ï¼Œå¤§å®¶æœ‰ä»€ä¹ˆæ¨èçš„å—ï¼Ÿ</p>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åäºŒç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¥½çœ‹ã€å¥½ç”¨  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://p8eyj0cpn.bkt.clouddn.com/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20180605191928.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="ç»ˆç«¯" scheme="https://zhangslob.github.io/categories/%E7%BB%88%E7%AB%AF/"/>
    
    
      <category term="linux" scheme="https://zhangslob.github.io/tags/linux/"/>
    
      <category term="zsh" scheme="https://zhangslob.github.io/tags/zsh/"/>
    
  </entry>
  
  <entry>
    <title>çˆ¬è™«å­¦åˆ°ä»€ä¹ˆç¨‹åº¦å¯ä»¥å»æ‰¾å·¥ä½œ</title>
    <link href="https://zhangslob.github.io/2018/05/29/%E7%88%AC%E8%99%AB%E5%AD%A6%E5%88%B0%E4%BB%80%E4%B9%88%E7%A8%8B%E5%BA%A6%E5%8F%AF%E4%BB%A5%E5%8E%BB%E6%89%BE%E5%B7%A5%E4%BD%9C/"/>
    <id>https://zhangslob.github.io/2018/05/29/çˆ¬è™«å­¦åˆ°ä»€ä¹ˆç¨‹åº¦å¯ä»¥å»æ‰¾å·¥ä½œ/</id>
    <published>2018-05-29T14:52:52.000Z</published>
    <updated>2018-05-29T16:09:07.909Z</updated>
    
    <content type="html"><![CDATA[<pre><code>è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åä¸€ç¯‡åŸåˆ›æ–‡ç« 
</code></pre><p>åˆ†äº«ä¸‹æˆ‘çš„ç»éªŒä¸æ•™è®­  (à¹‘â€¢ . â€¢à¹‘)</p>
<p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1527615838846&amp;di=6927100e3cb49201774aa07736031e9b&amp;imgtype=0&amp;src=http%3A%2F%2Fwww.btestingsky.com%2Ffiles%2Fcourse%2F2015%2F04-14%2F16211177d887256747.gif%3F4.2.0" alt=""></p>
<a id="more"></a>
<p>æœ€è¿‘å¾ˆå¤šæœ‹å‹é—®æˆ‘ï¼Œæˆ‘åœ¨è‡ªå­¦çˆ¬è™«ï¼Œå­¦åˆ°ä»€ä¹ˆç¨‹åº¦å¯ä»¥å»æ‰¾å·¥ä½œå‘¢ï¼Ÿ</p>
<p>è¿™ç¯‡æ–‡ç« ä¼šè¯´è¯´æˆ‘è‡ªå·±çš„å¿ƒå¾—ä½“éªŒï¼Œå…³äºçˆ¬è™«ã€å…³äºå·¥ä½œï¼Œä»…ä¾›å‚è€ƒã€‚</p>
<h1 id="å­¦åˆ°å“ªç§ç¨‹åº¦"><a href="#å­¦åˆ°å“ªç§ç¨‹åº¦" class="headerlink" title="å­¦åˆ°å“ªç§ç¨‹åº¦"></a>å­¦åˆ°å“ªç§ç¨‹åº¦</h1><p>æš‚ä¸”æŠŠç›®æ ‡å®šä½åˆçº§çˆ¬è™«å·¥ç¨‹å¸ˆï¼Œç®€å•åˆ—ä¸€ä¸‹å§ï¼š</p>
<p>ï¼ˆå¿…è¦éƒ¨åˆ†ï¼‰</p>
<ol>
<li>è¯­è¨€é€‰æ‹©ï¼šä¸€èˆ¬æ˜¯äº†è§£Pythonã€Javaã€Golangä¹‹ä¸€</li>
<li>ç†Ÿæ‚‰å¤šçº¿ç¨‹ç¼–ç¨‹ã€ç½‘ç»œç¼–ç¨‹ã€HTTPåè®®ç›¸å…³</li>
<li>å¼€å‘è¿‡å®Œæ•´çˆ¬è™«é¡¹ç›®ï¼ˆæœ€å¥½æœ‰å…¨ç«™çˆ¬è™«ç»éªŒï¼Œè¿™ä¸ªä¸‹é¢ä¼šè¯´åˆ°ï¼‰</li>
<li>åçˆ¬ç›¸å…³ï¼Œcookieã€ipæ± ã€éªŒè¯ç ç­‰ç­‰</li>
<li>ç†Ÿç»ƒä½¿ç”¨åˆ†å¸ƒå¼</li>
</ol>
<p>ï¼ˆéå¿…è¦ï¼Œå»ºè®®ï¼‰</p>
<ol>
<li>äº†è§£æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚RabbitMQã€Kafkaã€Redisç­‰</li>
<li>å…·æœ‰æ•°æ®æŒ–æ˜ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€ä¿¡æ¯æ£€ç´¢ã€æœºå™¨å­¦ä¹ ç»éªŒ</li>
<li>ç†Ÿæ‚‰APPæ•°æ®é‡‡é›†ã€ä¸­é—´äººä»£ç†</li>
<li>å¤§æ•°æ®å¤„ç†ï¼ˆHive/MR/Spark/Stormï¼‰</li>
<li>æ•°æ®åº“Mysqlï¼Œredisï¼Œmongdb</li>
<li>ç†Ÿæ‚‰Gitæ“ä½œã€linuxç¯å¢ƒå¼€å‘</li>
<li>è¯»æ‡‚jsä»£ç ï¼Œè¿™ä¸ªçœŸçš„å¾ˆé‡è¦</li>
</ol>
<h1 id="å¦‚ä½•æå‡"><a href="#å¦‚ä½•æå‡" class="headerlink" title="å¦‚ä½•æå‡"></a>å¦‚ä½•æå‡</h1><p>éšä¾¿çœ‹çœ‹çŸ¥ä¹ä¸Šçš„æ•™ç¨‹å°±å¯ä»¥å…¥é—¨äº†ï¼Œå°±Pythonè€Œè¨€ï¼Œä¼šrequestså½“ç„¶æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦äº†è§£scrapyå’Œpyspiderè¿™ä¸¤ä¸ªæ¡†æ¶ï¼Œscrapy_redisä¹Ÿæ˜¯éœ€è¦ç†è§£åŸç†çš„ã€‚</p>
<p>åˆ†å¸ƒå¼å¦‚ä½•æ­å»ºã€å¦‚ä½•è§£å†³å…¶ä¸­é‡åˆ°å†…å­˜ã€é€Ÿåº¦é—®é¢˜ã€‚</p>
<p>å‚è€ƒ <a href="https://mp.weixin.qq.com/s?__biz=MzIwNjUxMTQyMA==&amp;mid=2247484093&amp;idx=1&amp;sn=f6d3d91af46830816c1ad30221504630&amp;chksm=9721ceeea05647f86376f66d75cff028f5c03c9930dbb1ca14bb3d290437be2509a4420d0f7a#rd" target="_blank" rel="external">scrapy-redis å’Œ scrapy æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></p>
<p><img src="https://i.imgur.com/1uic8Qk.jpg" alt=""></p>
<h1 id="ä»€ä¹ˆå«å…¨ç«™çˆ¬å–"><a href="#ä»€ä¹ˆå«å…¨ç«™çˆ¬å–" class="headerlink" title="ä»€ä¹ˆå«å…¨ç«™çˆ¬å–"></a>ä»€ä¹ˆå«å…¨ç«™çˆ¬å–</h1><p>æœ€ç®€å•çš„æ‹¿æ‹‰é’©æ¥ä¸¾ä¾‹ï¼Œæœç´¢å…³é”®è¯ï¼Œæœ‰30é¡µï¼Œä¸è¦ä»¥ä¸ºæŠŠè¿™30é¡µçˆ¬å®Œå°±æ˜¯å…¨ç«™çˆ¬å–äº†ï¼Œä½ åº”è¯¥æƒ³æ–¹æ³•æŠŠæ‰€æœ‰æ•°æ®å…¨éƒ¨çˆ¬ä¸‹æ¥ã€‚</p>
<p>ä»€ä¹ˆåŠæ³•ï¼Œé€šè¿‡ç­›é€‰ç¼©å°èŒƒå›´ï¼Œæ…¢æ…¢æ¥å°±OKäº†ã€‚</p>
<p>åŒæ—¶ï¼Œæ¯ä¸ªèŒä½è¿˜ä¼šæœ‰æ¨èèŒä½ï¼Œå†å†™ä¸€ä¸ªé‡‡é›†æ¨èçš„çˆ¬è™«ã€‚</p>
<p><img src="https://i.imgur.com/MuvjEAt.png" alt=""></p>
<p>è¿™ä¸ªè¿‡ç¨‹éœ€è¦æ³¨æ„çš„æ˜¯å¦‚ä½•å»é‡ï¼ŒMongoå¯ä»¥ã€redisä¹Ÿå¯ä»¥ </p>
<p>å‚è€ƒ <a href="https://mp.weixin.qq.com/s?__biz=MzIwNjUxMTQyMA==&amp;mid=2247484074&amp;idx=1&amp;sn=c5d2e89ca4f30024ed213f07cd148cb2&amp;chksm=9721cef9a05647ef3c3ba3c5344de607af087d3688dbf089dd2a45519894469fe10bbc06a277#rd" target="_blank" rel="external">Scrapyä¸­å¦‚ä½•æé«˜æ•°æ®çš„æ’å…¥é€Ÿåº¦</a></p>
<h1 id="å®é™…é¡¹ç›®ç»éªŒ"><a href="#å®é™…é¡¹ç›®ç»éªŒ" class="headerlink" title="å®é™…é¡¹ç›®ç»éªŒ"></a>å®é™…é¡¹ç›®ç»éªŒ</h1><p>è¿™ä¸ªé¢è¯•ä¸­è‚¯å®šä¼šè¢«äººé—®é“ï¼Œå¦‚ï¼š</p>
<ol>
<li>ä½ çˆ¬è¿‡å“ªäº›ç½‘ç«™</li>
<li>æ—¥å‡æœ€å¤§é‡‡é›†é‡æ˜¯å¤šå°‘</li>
<li>ä½ é‡åˆ°å“ªäº›æ£˜æ‰‹é—®é¢˜ï¼Œå¦‚ä½•è§£å†³</li>
<li>ç­‰ç­‰</li>
</ol>
<p>é‚£ä¹ˆæ€ä¹ˆæ‰¾é¡¹ç›®å‘¢ï¼Ÿæ¯”å¦‚æˆ‘è¦çˆ¬å¾®åšæ•°æ®ï¼Œå»Githubä¸­æœç´¢ä¸‹ï¼Œé¡¹ç›®è¿˜ç®—å°‘å—ï¼Ÿ</p>
<p><img src="https://i.imgur.com/MlMcavz.png" alt=""></p>
<h1 id="è¯­è¨€é€‰æ‹©"><a href="#è¯­è¨€é€‰æ‹©" class="headerlink" title="è¯­è¨€é€‰æ‹©"></a>è¯­è¨€é€‰æ‹©</h1><p>æˆ‘è‡ªå·±å»ºè®®æ˜¯Pythonã€Javaã€Golangæœ€å¥½éƒ½äº†è§£ï¼ŒJavaçˆ¬è™«çš„ä¹Ÿå¾ˆå¤šï¼Œä½†æ˜¯ç½‘ä¸Šæ•™ç¨‹å‡ ä¹éƒ½æ˜¯Pythonçš„ï¼Œæ‚²å“€ã€‚</p>
<p>æœ€åè¯´ä¸‹Golangï¼ŒGolangçœŸçš„å¾ˆç‰›é€¼ï¼Œè¯´ä¸ªæ•°å­—ï¼ŒGolangå¯ä»¥æ¯åˆ†é’Ÿä¸‹è½½ç½‘é¡µæ•°é‡ 2W ï¼ŒPythonå¯ä»¥å—~~</p>
<p><img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=3503054989,264376367&amp;fm=11&amp;gp=0.jpg" alt=""></p>
<p>å®£ä¼ ä¸‹è‡ªå·±çš„åˆ·é¢˜é¡¹ç›® <a href="https://github.com/zhangslob/Leetcode-Solutions" target="_blank" rel="external">Leetcode Solutions By All Language</a></p>
<h1 id="å…³äºåçˆ¬"><a href="#å…³äºåçˆ¬" class="headerlink" title="å…³äºåçˆ¬"></a>å…³äºåçˆ¬</h1><p>å¸¸è§çš„ UAã€Referç­‰éœ€è¦äº†è§£æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œæœ‰äº›éªŒè¯çš„IDå¦‚ä½•äº§ç”Ÿçš„ï¼Œæ˜¯å¦å¿…è¦ï¼›å…³äºIPæ± è¿™å—æˆ‘ä¸äº†è§£ï¼Œä¸å¤šè¯´ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚ä½•è®¾è®¡æ‹‰é»‘æœºåˆ¶ï¼›æ¨¡æ‹Ÿç™»é™†ä¹Ÿæ˜¯å¿…è¦çš„ï¼Œ<a href="https://github.com/xchaoinfo/fuck-login" target="_blank" rel="external">fuck-login</a> å¯ä»¥ç ”ç©¶ä¸‹ä»£ç ï¼Œæˆ–è€…æPRã€‚</p>
<p><img src="https://i.imgur.com/vhXq9Lw.png" alt=""></p>
<blockquote>
<p>æ¨¡æ‹Ÿç™»é™†å…¶å®å°±æ˜¯ä¸€æ­¥æ­¥çš„è¯·æ±‚ï¼Œä¿å­˜cookieä¼šè¯</p>
</blockquote>
<h1 id="å¦‚ä½•åˆ¤æ–­èƒ½åŠ›è¶³å¤Ÿ"><a href="#å¦‚ä½•åˆ¤æ–­èƒ½åŠ›è¶³å¤Ÿ" class="headerlink" title="å¦‚ä½•åˆ¤æ–­èƒ½åŠ›è¶³å¤Ÿ"></a>å¦‚ä½•åˆ¤æ–­èƒ½åŠ›è¶³å¤Ÿ</h1><p>å¾ˆç®€å•ï¼Œç»™ä¸ªä»»åŠ¡ï¼Œçˆ¬å–çŸ¥ä¹ä¸Šæ‰€æœ‰é—®é¢˜ã€‚</p>
<p>ä½ ä¼šå¦‚ä½•æ€è€ƒå¹¶è®¾è®¡è¿™ä¸ªé¡¹ç›®ï¼Ÿ</p>
<p>æ¬¢è¿ç•™è¨€æŒ‡å‡º</p>
<hr>
<blockquote>
<p>ä»¥ä¸Šä»…ä¸ºä¸ªäººçœ‹æ³•ï¼Œè‹¥æœ‰ä¸è¶³ä¹‹å¤„è¯·æŒ‡å‡ºã€‚å¸Œæœ›å¯ä»¥å¸®åŠ©ä½ </p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;è¿™æ˜¯å´”æ–¯ç‰¹çš„ç¬¬äº”åä¸€ç¯‡åŸåˆ›æ–‡ç« 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åˆ†äº«ä¸‹æˆ‘çš„ç»éªŒä¸æ•™è®­  (à¹‘â€¢ . â€¢à¹‘)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://timgsa.baidu.com/timg?image&amp;amp;quality=80&amp;amp;size=b9999_10000&amp;amp;sec=1527615838846&amp;amp;di=6927100e3cb49201774aa07736031e9b&amp;amp;imgtype=0&amp;amp;src=http%3A%2F%2Fwww.btestingsky.com%2Ffiles%2Fcourse%2F2015%2F04-14%2F16211177d887256747.gif%3F4.2.0&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/categories/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="çˆ¬è™«" scheme="https://zhangslob.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
</feed>
